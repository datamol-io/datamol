
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A python library to work with molecules. Built on top of RDKit.">
      
      
      
      
        <link rel="prev" href="datamol.molar.html">
      
      
        <link rel="next" href="datamol.reactions.html">
      
      <link rel="icon" href="../images/logo-black.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.12">
    
    
      
        <title>datamol.mol - datamol</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
      <link rel="stylesheet" href="../assets/css/custom-datamol.css">
    
      <link rel="stylesheet" href="../assets/css/tweak-width.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datamolmol" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="datamol" class="md-header__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            datamol
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datamol.mol
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-io/datamol
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../index.html" class="md-tabs__link">
      Overview
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../usage.html" class="md-tabs__link">
      Usage
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../tutorials/The_Basics.html" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="datamol.align.html" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contribute.html" class="md-tabs__link">
      Contribute
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../license.html" class="md-tabs__link">
      License
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="datamol" class="md-nav__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    datamol
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-io/datamol
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage.html" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/The_Basics.html" class="md-nav__link">
        The Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Preprocessing.html" class="md-nav__link">
        Pre-Processing Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Descriptors.html" class="md-nav__link">
        Descriptors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Reactions.html" class="md-nav__link">
        Chemical Reactions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Scaffolds.html" class="md-nav__link">
        Generate Scaffold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Aligning.html" class="md-nav__link">
        Aligning Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fuzzy_Scaffolds.html" class="md-nav__link">
        Fuzzy Scaffolds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Clustering.html" class="md-nav__link">
        Clustering Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fragment.html" class="md-nav__link">
        Fragmenting Compounds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Conformers.html" class="md-nav__link">
        Generating Conformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Visualization.html" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Filesystem.html" class="md-nav__link">
        Datamol Filesystem Module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.align.html" class="md-nav__link">
        datamol.align
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.cluster.html" class="md-nav__link">
        datamol.cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.conformers.html" class="md-nav__link">
        datamol.conformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.convert.html" class="md-nav__link">
        datamol.convert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.data.html" class="md-nav__link">
        datamol.data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.descriptors.html" class="md-nav__link">
        datamol.descriptors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.fp.html" class="md-nav__link">
        datamol.fp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.fragment.html" class="md-nav__link">
        datamol.fragment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.graph.html" class="md-nav__link">
        datamol.graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.io.html" class="md-nav__link">
        datamol.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.isomers.html" class="md-nav__link">
        datamol.isomers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.log.html" class="md-nav__link">
        datamol.log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.molar.html" class="md-nav__link">
        datamol.molar
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          datamol.mol
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="datamol.mol.html" class="md-nav__link md-nav__link--active">
        datamol.mol
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol.mol" class="md-nav__link">
    mol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.add_hs" class="md-nav__link">
    add_hs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.atom_list_to_bond" class="md-nav__link">
    atom_list_to_bond()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_atom_map_number" class="md-nav__link">
    clear_atom_map_number()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_atom_props" class="md-nav__link">
    clear_atom_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_mol_props" class="md-nav__link">
    clear_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.compute_ring_system" class="md-nav__link">
    compute_ring_system()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.get_atom_positions" class="md-nav__link">
    get_atom_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.hash_mol" class="md-nav__link">
    hash_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.make_scaffold_generic" class="md-nav__link">
    make_scaffold_generic()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.protect_atoms" class="md-nav__link">
    protect_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.remove_hs" class="md-nav__link">
    remove_hs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.same_mol" class="md-nav__link">
    same_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_atom_positions" class="md-nav__link">
    set_atom_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.strip_mol_to_core" class="md-nav__link">
    strip_mol_to_core()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.substructure_matching_bonds" class="md-nav__link">
    substructure_matching_bonds()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_scaffold_murcko" class="md-nav__link">
    to_scaffold_murcko()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.unique_id" class="md-nav__link">
    unique_id()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.reactions.html" class="md-nav__link">
        datamol.reactions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.scaffold.html" class="md-nav__link">
        datamol.scaffold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.similarity.html" class="md-nav__link">
        datamol.similarity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.html" class="md-nav__link">
        datamol.utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.fs.html" class="md-nav__link">
        datamol.utils.fs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.viz.html" class="md-nav__link">
        datamol.viz
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol.mol" class="md-nav__link">
    mol
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.add_hs" class="md-nav__link">
    add_hs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.atom_list_to_bond" class="md-nav__link">
    atom_list_to_bond()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_atom_map_number" class="md-nav__link">
    clear_atom_map_number()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_atom_props" class="md-nav__link">
    clear_atom_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.clear_mol_props" class="md-nav__link">
    clear_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.compute_ring_system" class="md-nav__link">
    compute_ring_system()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.get_atom_positions" class="md-nav__link">
    get_atom_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.hash_mol" class="md-nav__link">
    hash_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.make_scaffold_generic" class="md-nav__link">
    make_scaffold_generic()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.protect_atoms" class="md-nav__link">
    protect_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.remove_hs" class="md-nav__link">
    remove_hs()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.same_mol" class="md-nav__link">
    same_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_atom_positions" class="md-nav__link">
    set_atom_positions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.strip_mol_to_core" class="md-nav__link">
    strip_mol_to_core()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.substructure_matching_bonds" class="md-nav__link">
    substructure_matching_bonds()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.to_scaffold_murcko" class="md-nav__link">
    to_scaffold_murcko()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.mol.unique_id" class="md-nav__link">
    unique_id()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="datamolmol"><code>datamol.mol</code><a class="headerlink" href="#datamolmol" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="datamol.mol"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="datamol.mol.add_hs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">explicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_on_atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_residue_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.add_hs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds hydrogens to the molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>explicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to only add explicit hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>add_coords</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to add 3D coordinates to the hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>only_on_atoms</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td><p>a list of atoms to add hydrogens only on.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>add_residue_info</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to add residue information to the hydrogens.
Useful for PDB files.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_hs</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">explicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_coords</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">only_on_atoms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_residue_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds hydrogens to the molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        explicit_only: whether to only add explicit hydrogens.</span>
<span class="sd">        add_coords: whether to add 3D coordinates to the hydrogens.</span>
<span class="sd">        only_on_atoms: a list of atoms to add hydrogens only on.</span>
<span class="sd">        add_residue_info: whether to add residue information to the hydrogens.</span>
<span class="sd">            Useful for PDB files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">explicitOnly</span><span class="o">=</span><span class="n">explicit_only</span><span class="p">,</span>
        <span class="n">addCoords</span><span class="o">=</span><span class="n">add_coords</span><span class="p">,</span>
        <span class="n">onlyOnAtoms</span><span class="o">=</span><span class="n">only_on_atoms</span><span class="p">,</span>
        <span class="n">addResidueInfo</span><span class="o">=</span><span class="n">add_residue_info</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.adjust_singleton" class="doc doc-heading">
<code class="highlight language-python"><span class="n">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.adjust_singleton" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.
For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C",
but not the ethane fragment.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.</span>
<span class="sd">    For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C&quot;,</span>
<span class="sd">    but not the ethane fragment.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_rem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">rdchem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">to_rem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
    <span class="n">to_rem</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a_idx</span> <span class="ow">in</span> <span class="n">to_rem</span><span class="p">:</span>
        <span class="n">em</span><span class="o">.</span><span class="n">RemoveAtom</span><span class="p">(</span><span class="n">a_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.atom_indices_to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.atom_indices_to_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add the <code>molAtomMapNumber</code> property to each atoms.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add the `molAtomMapNumber` property to each atoms.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">&quot;molAtomMapNumber&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.atom_list_to_bond" class="doc doc-heading">
<code class="highlight language-python"><span class="n">atom_list_to_bond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">,</span> <span class="n">bond_as_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.atom_list_to_bond" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return a list of existing bond indices between a list of
atom indices.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom_indices</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>A list of atom indices.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">atom_list_to_bond</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom_indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">bond_as_idx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of existing bond indices between a list of</span>
<span class="sd">    atom indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        atom_indices: A list of atom indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Build an atom map</span>
    <span class="n">atom_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">submol</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">PathToSubmol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">,</span> <span class="n">useQuery</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">atomMap</span><span class="o">=</span><span class="n">atom_map</span><span class="p">)</span>
    <span class="n">atom_map_reversed</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">atom_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">submol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">()</span>
        <span class="n">ori_a1</span> <span class="o">=</span> <span class="n">atom_map_reversed</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span>
        <span class="n">ori_a2</span> <span class="o">=</span> <span class="n">atom_map_reversed</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ori_a1</span> <span class="ow">in</span> <span class="n">atom_indices</span> <span class="ow">and</span> <span class="n">ori_a2</span> <span class="ow">in</span> <span class="n">atom_indices</span><span class="p">:</span>
            <span class="n">ori_bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">ori_a1</span><span class="p">,</span> <span class="n">ori_a2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bond_as_idx</span><span class="p">:</span>
                <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ori_bond</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ori_bond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bonds</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.clear_atom_map_number" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clear_atom_map_number</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.clear_atom_map_number" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Clear the <code>molAtomMapNumber</code> property of the atom's molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear_atom_map_number</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the `molAtomMapNumber` property of the atom&#39;s molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">clear_atom_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span> <span class="n">property_keys</span><span class="o">=</span><span class="s2">&quot;molAtomMapNumber&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.clear_atom_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clear_atom_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">property_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.clear_atom_props" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Clear atom properties from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>property_keys</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], str]]</code>
          </td>
          <td><p>If set, only the set properties will be cleared.
It not set, all the properties are cleared.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to also clean the private properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to also clean the computed properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear_atom_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">property_keys</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear atom properties from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        property_keys: If set, only the set properties will be cleared.</span>
<span class="sd">            It not set, all the properties are cleared.</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">        include_private: Whether to also clean the private properties.</span>
<span class="sd">        include_computed: Whether to also clean the computed properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">property_keys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">property_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">property_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">property_keys</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">property_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span>
                <span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span> <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span>
            <span class="p">)</span>
            <span class="n">property_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">property_keys</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">ClearProp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.clear_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clear_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">property_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.clear_mol_props" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Clear properties from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>property_keys</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], str]]</code>
          </td>
          <td><p>If set, only the set properties will be cleared.
It not set, all the properties are cleared.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to also clean the private properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to also clean the computed properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear_mol_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">property_keys</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear properties from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        property_keys: If set, only the set properties will be cleared.</span>
<span class="sd">            It not set, all the properties are cleared.</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">        include_private: Whether to also clean the private properties.</span>
<span class="sd">        include_computed: Whether to also clean the computed properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">property_keys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">property_keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">property_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">property_keys</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">property_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span><span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span> <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">)</span>
        <span class="n">property_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">property_keys</span><span class="p">:</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">ClearProp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.compute_ring_system" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_ring_system</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">include_spiro</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.compute_ring_system" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute the list of ring system in a molecule. This is based on RDKit's cookbook:
<a href="https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization">https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization</a></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_spiro</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include spiro rings.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ring_system</code></td>          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Set">Set</span>[int]]</code>
          </td>
          <td><p>list of ring system (atom indices).</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_ring_system</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">include_spiro</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the list of ring system in a molecule. This is based on RDKit&#39;s cookbook:</span>
<span class="sd">    https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule</span>
<span class="sd">        include_spiro: whether to include spiro rings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ring_system: list of ring system (atom indices).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span>
    <span class="n">systems</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">():</span>
        <span class="n">ringAts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
        <span class="n">nSystems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">:</span>
            <span class="n">nInCommon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ringAts</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nInCommon</span> <span class="ow">and</span> <span class="p">(</span><span class="n">include_spiro</span> <span class="ow">or</span> <span class="n">nInCommon</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">ringAts</span> <span class="o">=</span> <span class="n">ringAts</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nSystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
        <span class="n">nSystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ringAts</span><span class="p">)</span>
        <span class="n">systems</span> <span class="o">=</span> <span class="n">nSystems</span>
    <span class="k">return</span> <span class="n">systems</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.copy_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.copy_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Copy a molecule and return a new one.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy a molecule and return a new one.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule to copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.copy_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_mol_props</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.copy_mol_props" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Copy properties from one source molecule to another destination
molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>destination</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include private properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include computed properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol_props</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy properties from one source molecule to another destination</span>
<span class="sd">    molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: a molecule to copy from.</span>
<span class="sd">        destination: a molecule to copy to.</span>
<span class="sd">        include_private: Include private properties.</span>
<span class="sd">        include_computed: Include computed properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span><span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span> <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">)</span>
    <span class="n">set_mol_props</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.decrease_bond" class="doc doc-heading">
<code class="highlight language-python"><span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span></code>

<a href="#datamol.mol.decrease_bond" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove one single bond from the input bond. Note that you should
first kekulize your molecules and remove non-standard bond.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bond</code></td>
          <td>
                <code><span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Bond">Bond</span></code>
          </td>
          <td><p>a bond.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove one single bond from the input bond. Note that you should</span>
<span class="sd">    first kekulize your molecules and remove non-standard bond.</span>

<span class="sd">    Args:</span>
<span class="sd">        bond: a bond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">TRIPLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DOUBLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">DOUBLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SINGLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">SINGLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">bond</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_singleton</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">largest_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fix error in molecule using a greedy approach.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule to fix</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_iter</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of valence fix iteration to apply</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_singleton</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether <code>adjust_singleton</code> should be applied</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>largest_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether only the largest fragment should be kept</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a copy of the mol or perform in place operation</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">remove_singleton</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">largest_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fix error in molecule using a greedy approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule to fix</span>
<span class="sd">        n_iter: Number of valence fix iteration to apply</span>
<span class="sd">        remove_singleton: Whether `adjust_singleton` should be applied</span>
<span class="sd">        largest_only: Whether only the largest fragment should be kept</span>
<span class="sd">        inplace: Whether to return a copy of the mol or perform in place operation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="ow">or</span> <span class="n">mol</span>  <span class="c1"># fail back to mol when the fixer fail</span>

    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">remove_dummies</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">fix_valence</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_singleton</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">adjust_singleton</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">largest_only</span><span class="p">:</span>
            <span class="c1"># m = max(Chem.rdmolops.GetMolFrags(m, asMols=True, sanitizeFrags=False), key=lambda m: m.GetNumAtoms())</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">FragmentParent</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">skipStandardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_valence</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_valence" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Identify and try to fix valence issues by removing any supplemental bond
that should not be in the graph.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule with incorrect valence for some atoms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to modify in place or make a copy</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_ring_break</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether bond removal involving ring is allowed.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed potential valence issue in molecule or original molecule when nothing is broken</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>of if failed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify and try to fix valence issues by removing any supplemental bond</span>
<span class="sd">    that should not be in the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy</span>
<span class="sd">        allow_ring_break: Whether bond removal involving ring is allowed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed potential valence issue in molecule or original molecule when nothing is broken</span>
<span class="sd">        of if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># don&#39;t fix something that is not broken</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">remove_hs</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">implicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">update_explicit_count</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># first pass using explicit false count</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="k">while</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cur_hydrogen</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cur_hydrogen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># atom.SetNumRadicalElectrons(0)</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">em</span> <span class="o">=</span> <span class="n">rdchem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">bond</span>
            <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()),</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a2</span><span class="p">):</span>
                <span class="n">mbond</span> <span class="o">=</span> <span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">allow_ring_break</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mbond</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">bond</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">()):</span>
                    <span class="n">em</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">mbond</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">mbond</span><span class="p">)</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.fix_valence_charge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_valence_charge" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fix valence issues that are due to incorrect charges.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>Input molecule with incorrect valence for some atoms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to modify in place or make a copy.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed molecule via charge correction or original molecule if failed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fix valence issues that are due to incorrect charges.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: Input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule via charge correction or original molecule if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>

    <span class="c1"># Don&#39;t fix something that is not broken</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

        <span class="n">mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="n">n_electron</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span>
                <span class="o">-</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="n">n_electron</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.get_atom_positions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_atom_positions</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">conf_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">reorder_to_atom_map_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.get_atom_positions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return the atom positions of a given molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>conf_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The conformer ID to set the conformer to.</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>reorder_to_atom_map_number</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to reorder the positions to map the
atom map numbers given by the <code>molAtomMapNumber</code> atom property.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_atom_positions</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">conf_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">reorder_to_atom_map_number</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the atom positions of a given molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        conf_id: The conformer ID to set the conformer to.</span>
<span class="sd">        reorder_to_atom_map_number: Whether to reorder the positions to map the</span>
<span class="sd">            atom map numbers given by the `molAtomMapNumber` atom property.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumConformers</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This molecule does not have conformers.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reorder_to_atom_map_number</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;molAtomMapNumber&quot;</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()]</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The atoms of the input molecule does not contain the molAtomMapNumber property.&quot;</span>
            <span class="s2">&quot;Set it before calling this function or set `from_atom_map_numbers` to `False`.&quot;</span>
        <span class="p">)</span>

    <span class="n">conformer</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetConformer</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">conf_id</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">conformer</span><span class="o">.</span><span class="n">GetPositions</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">reorder_to_atom_map_number</span><span class="p">:</span>
        <span class="c1"># Remap the rows order in `positions` so it matches</span>
        <span class="c1"># with the atom map numbers.</span>
        <span class="n">mapped_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">GetAtomMapNum</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()])</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">mapped_indices</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">positions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.hash_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hash_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">hash_scheme</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#datamol.mol.hash_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate a unique hash code for a molecule based on chemistry. If two molecules are
chemically the same, they should have the same hash.</p>
<p>Using molhash adds value beyond using SMILES because it:</p>
<ul>
<li>Ignores SMILES features that are not chemically meaningful (e.g. atom map numbers).</li>
<li>Canonicalizes enhanced stereochemistry groups. For example <code>C[C@H](O)CC |&amp;1:1|</code> and <code>C[C@@H](O)CC |&amp;1:1|</code>
have the same molhash.</li>
<li>Canonicalizes S group data (for example, polymer data).</li>
</ul>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hash_scheme</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>There are three hash schemes:
- "all": most strict hash scheme utilizing all layers.
- "no_stereo": excludes stereo sensitive layers.
- "no_tautomers": excludes tautomer sensitive layers.</p></td>
          <td>
                <code>&#39;all&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td><p>The hash as a 40 chars string.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hash_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">hash_scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a unique hash code for a molecule based on chemistry. If two molecules are</span>
<span class="sd">    chemically the same, they should have the same hash.</span>

<span class="sd">    Using molhash adds value beyond using SMILES because it:</span>

<span class="sd">    - Ignores SMILES features that are not chemically meaningful (e.g. atom map numbers).</span>
<span class="sd">    - Canonicalizes enhanced stereochemistry groups. For example `C[C@H](O)CC |&amp;1:1|` and `C[C@@H](O)CC |&amp;1:1|`</span>
<span class="sd">    have the same molhash.</span>
<span class="sd">    - Canonicalizes S group data (for example, polymer data).</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        hash_scheme: There are three hash schemes:</span>
<span class="sd">            - &quot;all&quot;: most strict hash scheme utilizing all layers.</span>
<span class="sd">            - &quot;no_stereo&quot;: excludes stereo sensitive layers.</span>
<span class="sd">            - &quot;no_tautomers&quot;: excludes tautomer sensitive layers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The hash as a 40 chars string.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_lower_than_current_rdkit_version</span><span class="p">(</span><span class="s2">&quot;2022.09&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;`datamol.hash_mol() is only available with RDKit&gt;=2022.09.&quot;</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">RegistrationHash</span>

    <span class="c1"># Compute the mol layers</span>
    <span class="n">all_layers</span> <span class="o">=</span> <span class="n">RegistrationHash</span><span class="o">.</span><span class="n">GetMolLayers</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># Select the hash scheme</span>
    <span class="k">if</span> <span class="n">hash_scheme</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">hash_scheme_enum</span> <span class="o">=</span> <span class="n">RegistrationHash</span><span class="o">.</span><span class="n">HashScheme</span><span class="o">.</span><span class="n">ALL_LAYERS</span>
    <span class="k">elif</span> <span class="n">hash_scheme</span> <span class="o">==</span> <span class="s2">&quot;no_stereo&quot;</span><span class="p">:</span>
        <span class="n">hash_scheme_enum</span> <span class="o">=</span> <span class="n">RegistrationHash</span><span class="o">.</span><span class="n">HashScheme</span><span class="o">.</span><span class="n">STEREO_INSENSITIVE_LAYERS</span>
    <span class="k">elif</span> <span class="n">hash_scheme</span> <span class="o">==</span> <span class="s2">&quot;no_tautomers&quot;</span><span class="p">:</span>
        <span class="n">hash_scheme_enum</span> <span class="o">=</span> <span class="n">RegistrationHash</span><span class="o">.</span><span class="n">HashScheme</span><span class="o">.</span><span class="n">TAUTOMER_INSENSITIVE_LAYERS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`hash_scheme` is invalid. Please choose from: &#39;all&#39;, &#39;no_stereo&#39; or &#39;no_tautomers&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Generate the hash</span>
    <span class="k">return</span> <span class="n">RegistrationHash</span><span class="o">.</span><span class="n">GetMolHash</span><span class="p">(</span><span class="n">all_layers</span><span class="o">=</span><span class="n">all_layers</span><span class="p">,</span> <span class="n">hash_scheme</span><span class="o">=</span><span class="n">hash_scheme_enum</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.incorrect_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.incorrect_valence" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if an atom connection is not valid or all the atom of a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="datamol.types.Mol">Mol</span>, <span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Atom">Atom</span>]</code>
          </td>
          <td><p>atom or molecule to check for valence issue.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>update</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Update owning molecule property cache first.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the input atom valence is correct.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mol</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">],</span> <span class="n">update</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an atom connection is not valid or all the atom of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        a: atom or molecule to check for valence issue.</span>
<span class="sd">        update: Update owning molecule property cache first.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the input atom valence is correct.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">GetOwningMol</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetValenceList</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()))</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.is_transition_metal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)</span></code>

<a href="#datamol.mol.is_transition_metal" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if atom is a transition metal.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>at</code></td>
          <td>
                <code><span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Atom">Atom</span></code>
          </td>
          <td><p>an atom.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if atom is a transition metal.</span>

<span class="sd">    Args:</span>
<span class="sd">        at: an atom.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">22</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">40</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">47</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">72</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">79</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.keep_largest_fragment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.keep_largest_fragment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Only keep largest fragment of each molecule.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Only keep largest fragment of each molecule.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">rdmolops</span><span class="o">.</span><span class="n">GetMolFrags</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">asMols</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.make_scaffold_generic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_scaffold_generic</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">include_bonds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.make_scaffold_generic" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Make the atom in a scaffold or molecule generic.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule or a scaffold.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_bonds</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether we should also update bond order or keep as is.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_scaffold_generic</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">include_bonds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make the atom in a scaffold or molecule generic.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule or a scaffold.</span>
<span class="sd">        include_bonds: Whether we should also update bond order or keep as is.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">SetAtomicNum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">atom</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetChiralTag</span><span class="p">(</span><span class="n">rdchem</span><span class="o">.</span><span class="n">ChiralType</span><span class="o">.</span><span class="n">CHI_UNSPECIFIED</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetNoImplicit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">include_bonds</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">SetBondType</span><span class="p">(</span><span class="n">UNSPECIFIED_BOND</span><span class="p">)</span>

    <span class="n">mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">GetSymmSSSR</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.protect_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">protect_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">substruct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.protect_atoms" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Protect a list of atoms or substruct in a molecule.</p>
<p>The _protected attributes of a molecule is used by RDKit in several functions, especially for reactions
where "protected" atoms are disallowed from taking part in reactions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule to protect</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>substruct</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>optional substructure query to identify atoms to protect</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>atoms</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[int], int]]</code>
          </td>
          <td><p>optional list of atom indices to protect</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>in_place</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to perform the protection in place or return a copy of the molecule</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">protect_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">substruct</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">atoms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protect a list of atoms or substruct in a molecule.</span>

<span class="sd">    The _protected attributes of a molecule is used by RDKit in several functions, especially for reactions</span>
<span class="sd">    where &quot;protected&quot; atoms are disallowed from taking part in reactions.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule to protect</span>
<span class="sd">        substruct: optional substructure query to identify atoms to protect</span>
<span class="sd">        atoms: optional list of atom indices to protect</span>
<span class="sd">        in_place: whether to perform the protection in place or return a copy of the molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">atoms</span><span class="p">]</span>

    <span class="c1"># do not perform protection in place</span>
    <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
        <span class="n">mol_copy</span> <span class="o">=</span> <span class="n">mol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mol_copy</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">substruct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">mol_copy</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">substruct</span><span class="p">)</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">matches</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">mol_copy</span><span class="o">.</span><span class="n">GetAtomWithIdx</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">&quot;_protected&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol_copy</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.randomize_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.randomize_atoms" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Randomize the position of the atoms in a mol.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomize the position of the atoms in a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()))</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.remove_dummies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span></code>

<a href="#datamol.mol.remove_dummies" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove dummy atoms from molecules.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.&quot;&quot;&quot;</span>

    <span class="n">du</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">to_mol</span><span class="p">(</span><span class="s2">&quot;[H]&quot;</span><span class="p">),</span> <span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">remove_hs</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.remove_hs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">implicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update_explicit_count</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.remove_hs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Removes hydrogens from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>implicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to only remove implicit hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>update_explicit_count</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to update the explicit hydrogen count.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to sanitize the molecule after the hydrogens are removed.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_hs</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">implicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">update_explicit_count</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes hydrogens from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        implicit_only: whether to only remove implicit hydrogens.</span>
<span class="sd">        update_explicit_count: whether to update the explicit hydrogen count.</span>
<span class="sd">        sanitize: whether to sanitize the molecule after the hydrogens are removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">RemoveHs</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">implicitOnly</span><span class="o">=</span><span class="n">implicit_only</span><span class="p">,</span>
        <span class="n">updateExplicitCount</span><span class="o">=</span><span class="n">update_explicit_count</span><span class="p">,</span>
        <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.reorder_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reorder_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">break_ties</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_chirality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_isotopes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.reorder_atoms" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Reorder the atoms in a mol. It ensures a single atom order for the same molecule,
regardless of its original representation.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>break_ties</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Force breaking of ranked ties.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_chirality</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Use chiral information when computing rank.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_isotopes</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Use isotope information when computing rank.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">break_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_chirality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_isotopes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder the atoms in a mol. It ensures a single atom order for the same molecule,</span>
<span class="sd">    regardless of its original representation.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        break_ties: Force breaking of ranked ties.</span>
<span class="sd">        include_chirality: Use chiral information when computing rank.</span>
<span class="sd">        include_isotopes: Use isotope information when computing rank.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">new_order</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">CanonicalRankAtoms</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">breakTies</span><span class="o">=</span><span class="n">break_ties</span><span class="p">,</span>
        <span class="n">includeChirality</span><span class="o">=</span><span class="n">include_chirality</span><span class="p">,</span>
        <span class="n">includeIsotopes</span><span class="o">=</span><span class="n">include_isotopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">new_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_order</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">new_order</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.replace_dummies_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_dummies_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">replace_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.replace_dummies_atoms" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove dummy atoms from molecules.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>molecule with dummies</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>replacement atom, default is carbon</p></td>
          <td>
                <code>&#39;C&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dummy</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>dummy atom representation</p></td>
          <td>
                <code>&#39;*&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>replace_all</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to replace all dummies</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Molecule with dummy replaced</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">replace_dummies_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
    <span class="n">replace_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: molecule with dummies</span>
<span class="sd">        atom: replacement atom, default is carbon</span>
<span class="sd">        dummy: dummy atom representation</span>
<span class="sd">        replace_all: Whether to replace all dummies</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: Molecule with dummy replaced</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">replacement</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="n">replace_all</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.same_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">same_mol</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="n">use_non_standard_inchikey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.same_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check two molecules are the same by comparing their InChiKey.</p>
<p>Invalid molecules (None) are always considered as not the same.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol1</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mol2</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>use_non_standard_inchikey</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to use the standard or non-standard InChiKey.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">same_mol</span><span class="p">(</span>
    <span class="n">mol1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">mol2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">use_non_standard_inchikey</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check two molecules are the same by comparing their InChiKey.</span>

<span class="sd">    Invalid molecules (None) are always considered as not the same.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol1: A molecule.</span>
<span class="sd">        mol2: A molecule.</span>
<span class="sd">        use_non_standard_inchikey: Whether to use the standard or non-standard InChiKey.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mol2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">use_non_standard_inchikey</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">==</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">==</span> <span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_first" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_first" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sanitize a list of molecules and return the first valid molecule seen in the list.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>charge_neutral</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether charge neutralization should be applied.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanifix</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sanitize a list of molecules and return the first valid molecule seen in the list.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="n">charge_neutral</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="n">sanifix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mol</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>An augmented version of RDKit <code>sanitize=True</code>. It uses a
mol-SMILES-mol conversion to catch potential aromaticity errors
and try to fix aromatic nitrogen (using the popular sanifix4 script).
Optionally, it can neutralize the charge of the molecule.</p>
<p>Note #1: Only the first conformer (if present) will be preserved and
a warning will be displayed if more than one conformer is detected.</p>
<p>Note #2: The molecule's properties will be preserved but the atom's
properties will be lost.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>charge_neutral</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether charge neutralization should be applied.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanifix</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether displaying a warning about multiple conformers.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>add_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Add hydrogens to the returned molecule. Useful when the input
molecule already contains hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">add_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An augmented version of RDKit `sanitize=True`. It uses a</span>
<span class="sd">    mol-SMILES-mol conversion to catch potential aromaticity errors</span>
<span class="sd">    and try to fix aromatic nitrogen (using the popular sanifix4 script).</span>
<span class="sd">    Optionally, it can neutralize the charge of the molecule.</span>

<span class="sd">    Note #1: Only the first conformer (if present) will be preserved and</span>
<span class="sd">    a warning will be displayed if more than one conformer is detected.</span>

<span class="sd">    Note #2: The molecule&#39;s properties will be preserved but the atom&#39;s</span>
<span class="sd">    properties will be lost.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>
<span class="sd">        verbose: Whether displaying a warning about multiple conformers.</span>
<span class="sd">        add_hs: Add hydrogens to the returned molecule. Useful when the input</span>
<span class="sd">            molecule already contains hydrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="c1"># Extract properties.</span>
    <span class="n">original_mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">original_mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">charge_neutral</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sanifix</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">_sanifix4</span><span class="o">.</span><span class="n">sanifix</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Detect multiple conformers</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumConformers</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The molecule contains multiple conformers. Only the first one will be preserved.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Try catch to avoid occasional aromaticity errors</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># `cxsmiles` is used here to preserve the first conformer.</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">cxsmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="n">add_hs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Insert back properties.</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.sanitize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_smiles" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Takes SMILES string and returns its sanitized version.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>smiles to be sanitized.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>isomeric</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to include information about stereochemistry in the SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>sanitized smiles.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">isomeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes SMILES string and returns its sanitized version.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: smiles to be sanitized.</span>
<span class="sd">        isomeric: Whether to include information about stereochemistry in the SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sanitized smiles.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mol</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="n">isomeric</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.set_atom_positions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_atom_positions</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">conf_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_atom_map_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_previous_conformers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.set_atom_positions" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add a conformer to a molecule given the atom's positions.</p>
<p>The conformer 3D flag is automatically set if all the z coordinates are 0.</p>
<p><strong>Example:</strong></p>
<p>The below example is common when you want to reconstruct a molecule object
from its SMILES and its held out atomic positions. The position array
is ordered according to the atom number seen in the SMILES. This is a common
data structure when working with Quantum Mechanics dataset.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datamol</span> <span class="k">as</span> <span class="nn">dm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># We start with a SMILES where every atoms is mapped to a specific number</span>
<span class="n">smiles</span> <span class="o">=</span> <span class="s2">&quot;[H:14][c:5]1[c:3]([c:7]([c:4]([c:6]([c:8]1[N:10]([H:18])[C:2](=[N+:11]([H:19])[H:20])[N:9]([H:16])[H:17])[H:15])[H:13])[F:1])[H:12]&quot;</span>

<span class="c1"># Every atom position below is mapped to the atom number in the SMILES above</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.67</span><span class="p">,</span> <span class="mf">3.15</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">4.72</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">3.54</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.64</span><span class="p">,</span> <span class="mf">2.88</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">3.44</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.54</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">7.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.17</span><span class="p">,</span> <span class="mf">2.91</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.85</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">4.15</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">4.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.24</span><span class="p">,</span> <span class="mf">4.55</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.78</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">4.52</span><span class="p">,</span> <span class="mf">1.43</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.48</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">8.68</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.65</span><span class="p">,</span> <span class="mf">7.88</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.21</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.24</span><span class="p">,</span> <span class="mf">3.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.15</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.96</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">2.02</span><span class="p">,</span> <span class="mf">5.59</span><span class="p">,</span> <span class="mf">3.71</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># We build the mol object by setting `remove_hs` to `False`.</span>
<span class="c1"># This is important so the hydrogens and their atom number are preserved.</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># If you plot the molecule with `dm.to_image(mol)`, you&#39;ll notice</span>
<span class="c1"># the atom numbers are added to the drawing.</span>

<span class="c1"># Now we set the atom positions to the newly constructed `mol` object.</span>
<span class="c1"># Here it&#39;s important to set `use_atom_map_numbers` to `True`, so the atom numbers</span>
<span class="c1"># from the SMILES are used to match the input positions array.</span>
<span class="c1"># Under the hood, RDKit has set the `molAtomMapNumber` property to all the atoms in the</span>
<span class="c1"># molecule.</span>
<span class="n">new_mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">set_atom_positions</span><span class="p">(</span>
    <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span>
    <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
    <span class="n">conf_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">use_atom_map_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The newly set conformer now had the correct 3D positions.</span>
<span class="c1"># You can visualize the molecule with `dm.to_image(new_mol)` in 2D</span>
<span class="c1"># or `dm.viz.conformers(new_mol)`.</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>positions</code></td>
          <td>
                <code><span title="numpy.typing">npt</span>.<span title="numpy.typing.ArrayLike">ArrayLike</span></code>
          </td>
          <td><p>An array or a list of atomic positions. Shape of <code>[n_atoms, 3]</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>conf_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The conformer ID to set the conformer to.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_atom_map_numbers</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to input positions are ordered given the atom mapped
numbers set in the <code>molAtomMapNumber</code> atom property keys. If set to False,
the default atom indices order is assumed.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_previous_conformers</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to remove the previous conformers if any in the input molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_atom_positions</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">positions</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">conf_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_atom_map_numbers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_previous_conformers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a conformer to a molecule given the atom&#39;s positions.</span>

<span class="sd">    The conformer 3D flag is automatically set if all the z coordinates are 0.</span>

<span class="sd">    **Example:**</span>

<span class="sd">    The below example is common when you want to reconstruct a molecule object</span>
<span class="sd">    from its SMILES and its held out atomic positions. The position array</span>
<span class="sd">    is ordered according to the atom number seen in the SMILES. This is a common</span>
<span class="sd">    data structure when working with Quantum Mechanics dataset.</span>

<span class="sd">    ```python</span>

<span class="sd">    import datamol as dm</span>
<span class="sd">    import numpy as np</span>

<span class="sd">    # We start with a SMILES where every atoms is mapped to a specific number</span>
<span class="sd">    smiles = &quot;[H:14][c:5]1[c:3]([c:7]([c:4]([c:6]([c:8]1[N:10]([H:18])[C:2](=[N+:11]([H:19])[H:20])[N:9]([H:16])[H:17])[H:15])[H:13])[F:1])[H:12]&quot;</span>

<span class="sd">    # Every atom position below is mapped to the atom number in the SMILES above</span>
<span class="sd">    positions = [</span>
<span class="sd">        [1.7, -6.67, 3.15],</span>
<span class="sd">        [0.2, 4.72, 0.78],</span>
<span class="sd">        [3.54, -2.64, 2.88],</span>
<span class="sd">        [0.43, -3.87, -0.09],</span>
<span class="sd">        [3.44, -0.2, 1.8],</span>
<span class="sd">        [0.02, -1.5, -1.0],</span>
<span class="sd">        [2.12, -4.54, 1.9],</span>
<span class="sd">        [1.5, 0.48, 0.02],</span>
<span class="sd">        [0.53, 7.24, 0.25],</span>
<span class="sd">        [1.17, 2.91, -0.85],</span>
<span class="sd">        [-1.22, 4.15, 2.71],</span>
<span class="sd">        [4.64, -3.24, 4.55],</span>
<span class="sd">        [-0.89, -5.43, -0.78],</span>
<span class="sd">        [4.52, 1.43, 2.45],</span>
<span class="sd">        [-1.45, -1.02, -2.48],</span>
<span class="sd">        [-0.15, 8.68, 1.38],</span>
<span class="sd">        [1.65, 7.88, -1.21],</span>
<span class="sd">        [2.24, 3.64, -2.15],</span>
<span class="sd">        [-1.96, 2.4, 3.0],</span>
<span class="sd">        [-2.02, 5.59, 3.71],</span>
<span class="sd">    ]</span>

<span class="sd">    # We build the mol object by setting `remove_hs` to `False`.</span>
<span class="sd">    # This is important so the hydrogens and their atom number are preserved.</span>
<span class="sd">    mol = dm.to_mol(smiles, remove_hs=False)</span>

<span class="sd">    # If you plot the molecule with `dm.to_image(mol)`, you&#39;ll notice</span>
<span class="sd">    # the atom numbers are added to the drawing.</span>

<span class="sd">    # Now we set the atom positions to the newly constructed `mol` object.</span>
<span class="sd">    # Here it&#39;s important to set `use_atom_map_numbers` to `True`, so the atom numbers</span>
<span class="sd">    # from the SMILES are used to match the input positions array.</span>
<span class="sd">    # Under the hood, RDKit has set the `molAtomMapNumber` property to all the atoms in the</span>
<span class="sd">    # molecule.</span>
<span class="sd">    new_mol = dm.set_atom_positions(</span>
<span class="sd">        mol=mol,</span>
<span class="sd">        positions=positions,</span>
<span class="sd">        conf_id=0,</span>
<span class="sd">        use_atom_map_numbers=True,</span>
<span class="sd">    )</span>

<span class="sd">    # The newly set conformer now had the correct 3D positions.</span>
<span class="sd">    # You can visualize the molecule with `dm.to_image(new_mol)` in 2D</span>
<span class="sd">    # or `dm.viz.conformers(new_mol)`.</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        positions: An array or a list of atomic positions. Shape of `[n_atoms, 3]`.</span>
<span class="sd">        conf_id: The conformer ID to set the conformer to.</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">        use_atom_map_numbers: Whether to input positions are ordered given the atom mapped</span>
<span class="sd">            numbers set in the `molAtomMapNumber` atom property keys. If set to False,</span>
<span class="sd">            the default atom indices order is assumed.</span>
<span class="sd">        remove_previous_conformers: Whether to remove the previous conformers if any in the input molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># Convert to an array</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>

    <span class="c1"># Perform a few sanity checks</span>

    <span class="k">if</span> <span class="n">positions</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The positions array is not of dimension 2. Found: </span><span class="si">{</span><span class="n">positions</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">excpected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">positions</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">excpected_shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The shape of `positions` is </span><span class="si">{</span><span class="n">positions</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> instead of </span><span class="si">{</span><span class="n">excpected_shape</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">use_atom_map_numbers</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;molAtomMapNumber&quot;</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()]</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The atoms of the input molecule does not contain the molAtomMapNumber property.&quot;</span>
            <span class="s2">&quot;Set it before calling this function or set `from_atom_map_numbers` to `False`.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Remove previous conformers</span>
    <span class="k">if</span> <span class="n">remove_previous_conformers</span><span class="p">:</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">RemoveAllConformers</span><span class="p">()</span>

    <span class="c1"># Remap the rows order in `positions` so it matches</span>
    <span class="c1"># with the atom map numbers.</span>
    <span class="k">if</span> <span class="n">use_atom_map_numbers</span><span class="p">:</span>
        <span class="n">mapped_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">GetAtomMapNum</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()])</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">mapped_indices</span><span class="p">,</span> <span class="p">:]</span>

    <span class="c1"># Check if it&#39;s 3D or 2D coords</span>
    <span class="n">is_3d</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Create the conformer object</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">rdchem</span><span class="o">.</span><span class="n">Conformer</span><span class="p">()</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">Set3D</span><span class="p">(</span><span class="n">is_3d</span><span class="p">)</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">SetId</span><span class="p">(</span><span class="n">conf_id</span><span class="p">)</span>

    <span class="c1"># Set the positions</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xyz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">SetAtomPosition</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rdGeometry</span><span class="o">.</span><span class="n">Point3D</span><span class="p">(</span><span class="o">*</span><span class="n">xyz</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

    <span class="c1"># Add the conformer to the molecule</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">AddConformer</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.set_dative_bonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_dative_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>

<a href="#datamol.mol.set_dative_bonds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms
with dative bonds. The replacement is only done if the atom has "too many" bonds.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>molecule with bond to modify</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>from_atoms</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td><p>List of atoms  (symbol or atomic number) to consider for bond replacement.
By default, only Nitrogen (7) and Oxygen (8) are considered.</p></td>
          <td>
                <code>(7, 8)</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>The modified molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_dative_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms</span>
<span class="sd">    with dative bonds. The replacement is only done if the atom has &quot;too many&quot; bonds.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: molecule with bond to modify</span>
<span class="sd">        from_atoms: List of atoms  (symbol or atomic number) to consider for bond replacement.</span>
<span class="sd">            By default, only Nitrogen (7) and Oxygen (8) are considered.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The modified molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rwmol</span> <span class="o">=</span> <span class="n">rdchem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">rwmol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">at</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">metal</span> <span class="ow">in</span> <span class="n">metals</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span> <span class="ow">or</span> <span class="n">nbr</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">nbr</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">())</span>
                <span class="ow">and</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">SINGLE_BOND</span>
            <span class="p">):</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">DATIVE_BOND</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rwmol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.set_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.set_mol_props" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set properties to a mol from a dict.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>the mol where to copy the props.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>props</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>the props to copy.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to copy the provided mol</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_mol_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set properties to a mol from a dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: the mol where to copy the props.</span>
<span class="sd">        props: the props to copy.</span>
<span class="sd">        copy: whether to copy the provided mol</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetBoolProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># NOTE(hadim): A Python integer is 32 bits and RDKit seems</span>
            <span class="c1"># to overflow before that. Here we catch the error</span>
            <span class="c1"># and instead uses silently `SetDoubleProp` instead.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mol</span><span class="o">.</span><span class="n">SetIntProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
                <span class="n">mol</span><span class="o">.</span><span class="n">SetDoubleProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetDoubleProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.standardize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">standardize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">disconnect_metals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reionize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uncharge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.standardize_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>This function returns a standardized version the given molecule. It relies on the
RDKit <a href="https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html"><code>rdMolStandardize</code> module</a>
which is largely inspired from <a href="https://github.com/mcs07/MolVS">MolVS</a>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule to standardize.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>disconnect_metals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Disconnect metals that are defined as covalently bonded to non-metal.
Depending on the source of the database, some compounds may be reported in salt form
or associated to metallic ions (e.g. the sodium salt of a carboxylic compound).
In most cases, these counter-ions are not relevant so the use of this function is required
before further utilization of the dataset. In summary the process is the following:</p>
<ul>
<li>Break covalent bonds between metals and organic atoms under certain conditions.</li>
<li>First, disconnect N, O, F from any metal. Then disconnect other non-metals from transition metals (with exceptions).</li>
<li>For every bond broken, adjust the charges of the begin and end atoms accordingly.</li>
</ul></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>normalize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Applies a series of standard transformations to correct functional groups and recombine charges.
It corrects drawing errors and standardizes functional groups in the molecule as well as ensuring the
overall proper charge of the compound. It includes:</p>
<ul>
<li>Uncharge-separate sulfones</li>
<li>Charge-separate nitro groups</li>
<li>Charge-separate pyridine oxide</li>
<li>Charge-separate azide</li>
<li>Charge-separate diazo and azo groups</li>
<li>Charge-separate sulfoxides</li>
<li>Hydrazine-diazonium system</li>
</ul></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>reionize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If one or more acidic functionalities are present in the molecule, this option ensures the correct
neutral/ionized state for such functional groups. Molecules are uncharged by adding and/or removing hydrogens.
For zwitterions, hydrogens are moved to eliminate charges where possible. However, in cases where there is a
positive charge that is not neutralizable, an attempt is made to also preserve the corresponding negative charge
The algorithm works as follows:</p>
<ul>
<li>Use SMARTS to find the strongest protonated acid and the weakest ionized acid.</li>
<li>If the ionized acid is weaker than the protonated acid, swap proton and repeat.</li>
</ul></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>uncharge</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>This option neutralize the molecule by reversing the protonation state of protonated and deprotonated groups,
if present (e.g. a carboxylate is re-protonated to the corresponding carboxylic acid).
In cases where there is a positive charge that is not neutralizable, an attempt is made to also preserve the
corresponding negative charge to ensure a net zero charge.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>stereo</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Stereochemical information is corrected and/or added if missing using built-in RDKit functionality to force a clean recalculation of stereochemistry (<code>AssignStereochemistry</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A standardized molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">disconnect_metals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reionize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">uncharge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stereo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns a standardized version the given molecule. It relies on the</span>
<span class="sd">    RDKit [`rdMolStandardize` module](https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html)</span>
<span class="sd">    which is largely inspired from [MolVS](https://github.com/mcs07/MolVS).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: A molecule to standardize.</span>

<span class="sd">        disconnect_metals: Disconnect metals that are defined as covalently bonded to non-metal.</span>
<span class="sd">            Depending on the source of the database, some compounds may be reported in salt form</span>
<span class="sd">            or associated to metallic ions (e.g. the sodium salt of a carboxylic compound).</span>
<span class="sd">            In most cases, these counter-ions are not relevant so the use of this function is required</span>
<span class="sd">            before further utilization of the dataset. In summary the process is the following:</span>

<span class="sd">            - Break covalent bonds between metals and organic atoms under certain conditions.</span>
<span class="sd">            - First, disconnect N, O, F from any metal. Then disconnect other non-metals from transition metals (with exceptions).</span>
<span class="sd">            - For every bond broken, adjust the charges of the begin and end atoms accordingly.</span>

<span class="sd">        normalize: Applies a series of standard transformations to correct functional groups and recombine charges.</span>
<span class="sd">            It corrects drawing errors and standardizes functional groups in the molecule as well as ensuring the</span>
<span class="sd">            overall proper charge of the compound. It includes:</span>

<span class="sd">            - Uncharge-separate sulfones</span>
<span class="sd">            - Charge-separate nitro groups</span>
<span class="sd">            - Charge-separate pyridine oxide</span>
<span class="sd">            - Charge-separate azide</span>
<span class="sd">            - Charge-separate diazo and azo groups</span>
<span class="sd">            - Charge-separate sulfoxides</span>
<span class="sd">            - Hydrazine-diazonium system</span>

<span class="sd">        reionize: If one or more acidic functionalities are present in the molecule, this option ensures the correct</span>
<span class="sd">            neutral/ionized state for such functional groups. Molecules are uncharged by adding and/or removing hydrogens.</span>
<span class="sd">            For zwitterions, hydrogens are moved to eliminate charges where possible. However, in cases where there is a</span>
<span class="sd">            positive charge that is not neutralizable, an attempt is made to also preserve the corresponding negative charge</span>
<span class="sd">            The algorithm works as follows:</span>

<span class="sd">            - Use SMARTS to find the strongest protonated acid and the weakest ionized acid.</span>
<span class="sd">            - If the ionized acid is weaker than the protonated acid, swap proton and repeat.</span>

<span class="sd">        uncharge: This option neutralize the molecule by reversing the protonation state of protonated and deprotonated groups,</span>
<span class="sd">            if present (e.g. a carboxylate is re-protonated to the corresponding carboxylic acid).</span>
<span class="sd">            In cases where there is a positive charge that is not neutralizable, an attempt is made to also preserve the</span>
<span class="sd">            corresponding negative charge to ensure a net zero charge.</span>

<span class="sd">        stereo: Stereochemical information is corrected and/or added if missing using built-in RDKit functionality to force a clean recalculation of stereochemistry (`AssignStereochemistry`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: A standardized molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">disconnect_metals</span><span class="p">:</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">MetalDisconnector</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reionize</span><span class="p">:</span>
        <span class="n">reionizer</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Reionizer</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">reionizer</span><span class="o">.</span><span class="n">reionize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">uncharge</span><span class="p">:</span>
        <span class="n">uncharger</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Uncharger</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">uncharger</span><span class="o">.</span><span class="n">uncharge</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">stereo</span><span class="p">:</span>
        <span class="n">rdmolops</span><span class="o">.</span><span class="n">AssignStereochemistry</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.standardize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">tautomer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.standardize_smiles" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit
smiles standardizer and tautomeric canonicalization.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Smiles to standardize</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tautomer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to canonicalize tautomers</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>standard_smiles</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>the standardized smiles</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tautomer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit</span>
<span class="sd">    smiles standardizer and tautomeric canonicalization.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: Smiles to standardize</span>
<span class="sd">        tautomer: Whether to canonicalize tautomers</span>

<span class="sd">    Returns:</span>
<span class="sd">        standard_smiles: the standardized smiles</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">StandardizeSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tautomer</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">canonicalize_tautomer_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.strip_mol_to_core" class="doc doc-heading">
<code class="highlight language-python"><span class="n">strip_mol_to_core</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">bond_cutter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.mol.strip_mol_to_core" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Strip a molecule to its core, i.e. remove all atoms not in the core.
This method 'guess' the molecular core, by finding the ring system.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bond_cutter</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule used to cut the bonds.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">strip_mol_to_core</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">bond_cutter</span><span class="p">:</span> <span class="n">Mol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip a molecule to its core, i.e. remove all atoms not in the core.</span>
<span class="sd">    This method &#39;guess&#39; the molecular core, by finding the ring system.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        bond_cutter: A molecule used to cut the bonds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">bond_cutter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bond_cutter</span> <span class="o">=</span> <span class="n">from_smarts</span><span class="p">(</span><span class="s2">&quot;[R;!$(*=,#[!#6])]!@!=!#[*;$([A;!R][A;!R])]&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">without_rdkit_log</span><span class="p">():</span>
        <span class="n">scaffold</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">bond_cutter</span><span class="p">)</span>
        <span class="n">bond_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bond_inds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">FragmentOnBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">bond_inds</span><span class="p">)</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">remove_dummies</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">to_scaffold_murcko</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>
            <span class="n">scaffold</span> <span class="o">=</span> <span class="n">keep_largest_fragment</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scaffold</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.substructure_matching_bonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substructure_matching_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#datamol.mol.substructure_matching_bonds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Perform a substructure match using <code>GetSubstructMatches</code> but instead
of returning only the atom indices also return the bond indices.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>query</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule used as a query to match against.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Any other arguments to pass to <code>mol.GetSubstructMatches()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>atom_matches</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>A list of lists of atom indices.</p></td>
        </tr>
        <tr>
<td><code>bond_matches</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>A list of lists of bond indices.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">substructure_matching_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a substructure match using `GetSubstructMatches` but instead</span>
<span class="sd">    of returning only the atom indices also return the bond indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        query: A molecule used as a query to match against.</span>
<span class="sd">        **kwargs: Any other arguments to pass to `mol.GetSubstructMatches()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        atom_matches: A list of lists of atom indices.</span>
<span class="sd">        bond_matches: A list of lists of bond indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># NOTE(hadim): If more substructure functions are added here, consider moving it to</span>
    <span class="c1"># a dedicated `substructure` module.</span>

    <span class="c1"># Set default arguments</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;uniquify&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get the matching atom indices</span>
    <span class="n">atom_matches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="c1"># Get the bond to highligh from the query</span>
    <span class="n">query_bond_indices</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">())</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="c1"># Retrieve the atom indices</span>
    <span class="n">query_atom_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">())]</span>

    <span class="n">bond_matches</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">atom_matches</span><span class="p">:</span>
        <span class="c1"># Map the atom of the query to the atom of the mol matching the query</span>
        <span class="n">atom_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">query_atom_indices</span><span class="p">,</span> <span class="n">match</span><span class="p">))</span>

        <span class="c1"># For this match atoms we now, we use the map to retrieve the matching bonds</span>
        <span class="c1"># in the mol.</span>
        <span class="n">mol_bond_indices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">atom_map</span><span class="p">[</span><span class="n">a1</span><span class="p">],</span> <span class="n">atom_map</span><span class="p">[</span><span class="n">a2</span><span class="p">])</span> <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">query_bond_indices</span><span class="p">]</span>

        <span class="c1"># Convert the bond atom indices to bond indices</span>
        <span class="n">mol_bond_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">mol_bond_indices</span><span class="p">]</span>

        <span class="n">bond_matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mol_bond_indices</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">atom_matches</span><span class="p">,</span> <span class="n">bond_matches</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kekulize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_cxsmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parse_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strict_cxsmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.to_mol" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert an input molecule (smiles representation) into a <code>Mol</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A SMILES or a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>add_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether hydrogens should be added the molecule after the SMILES has been parsed.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>explicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to only add explicit hydrogen or both
(implicit and explicit). when <code>add_hs</code> is set to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the atom should be ordered. This option is
important if you want to ensure that the features returned will always maintain
a single atom order for the same molecule, regardless of its original SMILES representation.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kekulize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to perform kekulization of the input molecules.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to apply rdkit sanitization when input is a SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_cxsmiles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Recognize and parse CXSMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>parse_name</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Parse (and set) the molecule name as well.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Wether to remove the hydrogens from the input SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>strict_cxsmiles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Throw an exception if the CXSMILES parsing fails.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>the molecule if some conversion have been made. If the conversion fails</p></td>
        </tr>
        <tr>
<td></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>None is returned so make sure that you handle this case on your own.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">],</span>
    <span class="n">add_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kekulize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">allow_cxsmiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">parse_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">strict_cxsmiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an input molecule (smiles representation) into a `Mol`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A SMILES or a molecule.</span>
<span class="sd">        add_hs: Whether hydrogens should be added the molecule after the SMILES has been parsed.</span>
<span class="sd">        explicit_only: Whether to only add explicit hydrogen or both</span>
<span class="sd">            (implicit and explicit). when `add_hs` is set to True.</span>
<span class="sd">        ordered: Whether the atom should be ordered. This option is</span>
<span class="sd">            important if you want to ensure that the features returned will always maintain</span>
<span class="sd">            a single atom order for the same molecule, regardless of its original SMILES representation.</span>
<span class="sd">        kekulize: Whether to perform kekulization of the input molecules.</span>
<span class="sd">        sanitize: Whether to apply rdkit sanitization when input is a SMILES.</span>
<span class="sd">        allow_cxsmiles: Recognize and parse CXSMILES.</span>
<span class="sd">        parse_name: Parse (and set) the molecule name as well.</span>
<span class="sd">        remove_hs: Wether to remove the hydrogens from the input SMILES.</span>
<span class="sd">        strict_cxsmiles: Throw an exception if the CXSMILES parsing fails.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: the molecule if some conversion have been made. If the conversion fails</span>
<span class="sd">        None is returned so make sure that you handle this case on your own.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input should be a Mol or a string instead of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">smiles_params</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SmilesParserParams</span><span class="p">()</span>
        <span class="n">smiles_params</span><span class="o">.</span><span class="n">sanitize</span> <span class="o">=</span> <span class="n">sanitize</span>
        <span class="n">smiles_params</span><span class="o">.</span><span class="n">allowCXSMILES</span> <span class="o">=</span> <span class="n">allow_cxsmiles</span>
        <span class="n">smiles_params</span><span class="o">.</span><span class="n">parseName</span> <span class="o">=</span> <span class="n">parse_name</span>
        <span class="n">smiles_params</span><span class="o">.</span><span class="n">removeHs</span> <span class="o">=</span> <span class="n">remove_hs</span>
        <span class="n">smiles_params</span><span class="o">.</span><span class="n">strictCXSMILES</span> <span class="o">=</span> <span class="n">strict_cxsmiles</span>

        <span class="n">_mol</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">smiles_params</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sanitize</span> <span class="ow">and</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="c1"># Add hydrogens</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">add_hs</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">explicitOnly</span><span class="o">=</span><span class="n">explicit_only</span><span class="p">,</span> <span class="n">addCoords</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Reorder atoms</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ordered</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">reorder_atoms</span><span class="p">(</span><span class="n">_mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">kekulize</span><span class="p">:</span>
        <span class="n">rdmolops</span><span class="o">.</span><span class="n">Kekulize</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">clearAromaticFlags</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.to_neutral" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.to_neutral" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Neutralize the charge of a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Neutralize the charge of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">):</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.to_scaffold_murcko" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_scaffold_murcko</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">make_generic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.to_scaffold_murcko" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extract the Murcko scaffold from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>make_generic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to make the scaffold generic.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_scaffold_murcko</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">make_generic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the Murcko scaffold from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        make_generic: Whether to make the scaffold generic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scf</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># NOTE(hadim): this is already done in `GetScaffoldForMol`</span>
    <span class="c1"># Note sure we need it here.</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">GetSymmSSSR</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">make_generic</span><span class="p">:</span>
        <span class="n">scf</span> <span class="o">=</span> <span class="n">make_scaffold_generic</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>
        <span class="n">scf</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="datamol.mol.unique_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unique_id</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.unique_id" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>A datamol unique molecule ID.</p>
<p>The ID is an MD5 hash of the non-standard InChiKey provided
by <code>dm.to_inchikey_non_standard()</code>. It guarantees uniqueness for
different tautomeric forms of the same molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unique_id</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A datamol unique molecule ID.</span>

<span class="sd">    The ID is an MD5 hash of the non-standard InChiKey provided</span>
<span class="sd">    by `dm.to_inchikey_non_standard()`. It guarantees uniqueness for</span>
<span class="sd">    different tautomeric forms of the same molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ik</span> <span class="o">=</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ik</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">ik</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c2be25ad.min.js"></script>
      
        <script src="../assets/js/google-analytics.js"></script>
      
    
  </body>
</html>