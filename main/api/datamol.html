
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A python library to work with molecules. Built on top of RDKit.">
      
      
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.4.3">
    
    
      
        <title>datamol - datamol</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6b80c2a2.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
      <link rel="stylesheet" href="../assets/css/custom-datamol.css">
    
      <link rel="stylesheet" href="../assets/css/tweak-width.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datamol" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="datamol" class="md-header__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            datamol
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datamol
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-org/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-org/datamol
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="datamol" class="md-nav__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    datamol
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-org/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-org/datamol
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usage.html" class="md-nav__link">
        Usage
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/The_Basics.html" class="md-nav__link">
        The Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Preprocessing.html" class="md-nav__link">
        Pre-Processing Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Descriptors.html" class="md-nav__link">
        Descriptors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Scaffolds.html" class="md-nav__link">
        Generate Scaffold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Aligning.html" class="md-nav__link">
        Aligning Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fuzzy_Scaffolds.html" class="md-nav__link">
        Fuzzy Scaffolds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Clustering.html" class="md-nav__link">
        Clustering Molecules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fragment.html" class="md-nav__link">
        Fragmenting Compounds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Conformers.html" class="md-nav__link">
        Generating Conformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Visualization.html" class="md-nav__link">
        Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Filesystem.html" class="md-nav__link">
        Datamol Filesystem Module
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          datamol
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="datamol.html" class="md-nav__link md-nav__link--active">
        datamol
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#module-mol" class="md-nav__link">
    Module mol
  </a>
  
    <nav class="md-nav" aria-label="Module mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol" class="md-nav__link">
    mol
  </a>
  
    <nav class="md-nav" aria-label="mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol.add_hs" class="md-nav__link">
    add_hs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_list_to_bond" class="md-nav__link">
    atom_list_to_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.clear_mol_props" class="md-nav__link">
    clear_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.compute_ring_system" class="md-nav__link">
    compute_ring_system()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.make_scaffold_generic" class="md-nav__link">
    make_scaffold_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.protect_atoms" class="md-nav__link">
    protect_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_hs" class="md-nav__link">
    remove_hs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.same_mol" class="md-nav__link">
    same_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.strip_mol_to_core" class="md-nav__link">
    strip_mol_to_core()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.substructure_matching_bonds" class="md-nav__link">
    substructure_matching_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_scaffold_murcko" class="md-nav__link">
    to_scaffold_murcko()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.unique_id" class="md-nav__link">
    unique_id()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-io" class="md-nav__link">
    Module io
  </a>
  
    <nav class="md-nav" aria-label="Module io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io" class="md-nav__link">
    io
  </a>
  
    <nav class="md-nav" aria-label="io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_csv" class="md-nav__link">
    read_csv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_excel" class="md-nav__link">
    read_excel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_molblock" class="md-nav__link">
    read_molblock()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_sdf" class="md-nav__link">
    read_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_smi" class="md-nav__link">
    read_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_molblock" class="md-nav__link">
    to_molblock()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_sdf" class="md-nav__link">
    to_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_smi" class="md-nav__link">
    to_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_xlsx" class="md-nav__link">
    to_xlsx()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-convert" class="md-nav__link">
    Module convert
  </a>
  
    <nav class="md-nav" aria-label="Module convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert" class="md-nav__link">
    convert
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_df" class="md-nav__link">
    from_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_inchi" class="md-nav__link">
    from_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_selfies" class="md-nav__link">
    from_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_smarts" class="md-nav__link">
    from_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.render_mol_df" class="md-nav__link">
    render_mol_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.smiles_as_smarts" class="md-nav__link">
    smiles_as_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_df" class="md-nav__link">
    to_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi" class="md-nav__link">
    to_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi_non_standard" class="md-nav__link">
    to_inchi_non_standard()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey" class="md-nav__link">
    to_inchikey()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey_non_standard" class="md-nav__link">
    to_inchikey_non_standard()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_selfies" class="md-nav__link">
    to_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smarts" class="md-nav__link">
    to_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smiles" class="md-nav__link">
    to_smiles()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-cluster" class="md-nav__link">
    Module cluster
  </a>
  
    <nav class="md-nav" aria-label="Module cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster" class="md-nav__link">
    cluster
  </a>
  
    <nav class="md-nav" aria-label="cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.assign_to_centroids" class="md-nav__link">
    assign_to_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.cluster_mols" class="md-nav__link">
    cluster_mols()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_centroids" class="md-nav__link">
    pick_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_diverse" class="md-nav__link">
    pick_diverse()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-fp" class="md-nav__link">
    Module fp
  </a>
  
    <nav class="md-nav" aria-label="Module fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp" class="md-nav__link">
    fp
  </a>
  
    <nav class="md-nav" aria-label="fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fold_count_fp" class="md-nav__link">
    fold_count_fp()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fp_to_array" class="md-nav__link">
    fp_to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.list_supported_fingerprints" class="md-nav__link">
    list_supported_fingerprints()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.to_fp" class="md-nav__link">
    to_fp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-similarity" class="md-nav__link">
    Module similarity
  </a>
  
    <nav class="md-nav" aria-label="Module similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity" class="md-nav__link">
    similarity
  </a>
  
    <nav class="md-nav" aria-label="similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.cdist" class="md-nav__link">
    cdist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.pdist" class="md-nav__link">
    pdist()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-isomers" class="md-nav__link">
    Module isomers
  </a>
  
    <nav class="md-nav" aria-label="Module isomers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.isomers" class="md-nav__link">
    isomers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-data" class="md-nav__link">
    Module data
  </a>
  
    <nav class="md-nav" aria-label="Module data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data.cdk2" class="md-nav__link">
    cdk2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.data.freesolv" class="md-nav__link">
    freesolv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.data.solubility" class="md-nav__link">
    solubility()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-log" class="md-nav__link">
    Module log
  </a>
  
    <nav class="md-nav" aria-label="Module log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log" class="md-nav__link">
    log
  </a>
  
    <nav class="md-nav" aria-label="log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log.without_rdkit_log" class="md-nav__link">
    without_rdkit_log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.disable_rdkit_log" class="md-nav__link">
    disable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.enable_rdkit_log" class="md-nav__link">
    enable_rdkit_log()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-graph" class="md-nav__link">
    Module graph
  </a>
  
    <nav class="md-nav" aria-label="Module graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph" class="md-nav__link">
    graph
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph.get_all_path_between" class="md-nav__link">
    get_all_path_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.match_molecular_graphs" class="md-nav__link">
    match_molecular_graphs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.reorder_mol_from_template" class="md-nav__link">
    reorder_mol_from_template()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.to_graph" class="md-nav__link">
    to_graph()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.descriptors.html" class="md-nav__link">
        datamol.descriptors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.conformers.html" class="md-nav__link">
        datamol.conformers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.viz.html" class="md-nav__link">
        datamol.viz
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.fragment.html" class="md-nav__link">
        datamol.fragment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.scaffold.html" class="md-nav__link">
        datamol.scaffold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.molar.html" class="md-nav__link">
        datamol.molar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.align.html" class="md-nav__link">
        datamol.align
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.html" class="md-nav__link">
        datamol.utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#module-mol" class="md-nav__link">
    Module mol
  </a>
  
    <nav class="md-nav" aria-label="Module mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol" class="md-nav__link">
    mol
  </a>
  
    <nav class="md-nav" aria-label="mol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.mol.add_hs" class="md-nav__link">
    add_hs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.adjust_singleton" class="md-nav__link">
    adjust_singleton()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_indices_to_mol" class="md-nav__link">
    atom_indices_to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.atom_list_to_bond" class="md-nav__link">
    atom_list_to_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.clear_mol_props" class="md-nav__link">
    clear_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.compute_ring_system" class="md-nav__link">
    compute_ring_system()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol" class="md-nav__link">
    copy_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.copy_mol_props" class="md-nav__link">
    copy_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.decrease_bond" class="md-nav__link">
    decrease_bond()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_mol" class="md-nav__link">
    fix_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence" class="md-nav__link">
    fix_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.fix_valence_charge" class="md-nav__link">
    fix_valence_charge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.incorrect_valence" class="md-nav__link">
    incorrect_valence()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.is_transition_metal" class="md-nav__link">
    is_transition_metal()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.keep_largest_fragment" class="md-nav__link">
    keep_largest_fragment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.make_scaffold_generic" class="md-nav__link">
    make_scaffold_generic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.protect_atoms" class="md-nav__link">
    protect_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.randomize_atoms" class="md-nav__link">
    randomize_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_dummies" class="md-nav__link">
    remove_dummies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.remove_hs" class="md-nav__link">
    remove_hs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.reorder_atoms" class="md-nav__link">
    reorder_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.replace_dummies_atoms" class="md-nav__link">
    replace_dummies_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.same_mol" class="md-nav__link">
    same_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_first" class="md-nav__link">
    sanitize_first()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_mol" class="md-nav__link">
    sanitize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.sanitize_smiles" class="md-nav__link">
    sanitize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_dative_bonds" class="md-nav__link">
    set_dative_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.set_mol_props" class="md-nav__link">
    set_mol_props()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_mol" class="md-nav__link">
    standardize_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.standardize_smiles" class="md-nav__link">
    standardize_smiles()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.strip_mol_to_core" class="md-nav__link">
    strip_mol_to_core()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.substructure_matching_bonds" class="md-nav__link">
    substructure_matching_bonds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_mol" class="md-nav__link">
    to_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_neutral" class="md-nav__link">
    to_neutral()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.to_scaffold_murcko" class="md-nav__link">
    to_scaffold_murcko()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.mol.unique_id" class="md-nav__link">
    unique_id()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-io" class="md-nav__link">
    Module io
  </a>
  
    <nav class="md-nav" aria-label="Module io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io" class="md-nav__link">
    io
  </a>
  
    <nav class="md-nav" aria-label="io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_csv" class="md-nav__link">
    read_csv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_excel" class="md-nav__link">
    read_excel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_molblock" class="md-nav__link">
    read_molblock()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_sdf" class="md-nav__link">
    read_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.read_smi" class="md-nav__link">
    read_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_molblock" class="md-nav__link">
    to_molblock()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_sdf" class="md-nav__link">
    to_sdf()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_smi" class="md-nav__link">
    to_smi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.io.to_xlsx" class="md-nav__link">
    to_xlsx()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-convert" class="md-nav__link">
    Module convert
  </a>
  
    <nav class="md-nav" aria-label="Module convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert" class="md-nav__link">
    convert
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_df" class="md-nav__link">
    from_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_inchi" class="md-nav__link">
    from_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_selfies" class="md-nav__link">
    from_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.from_smarts" class="md-nav__link">
    from_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.render_mol_df" class="md-nav__link">
    render_mol_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.smiles_as_smarts" class="md-nav__link">
    smiles_as_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_df" class="md-nav__link">
    to_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi" class="md-nav__link">
    to_inchi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchi_non_standard" class="md-nav__link">
    to_inchi_non_standard()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey" class="md-nav__link">
    to_inchikey()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_inchikey_non_standard" class="md-nav__link">
    to_inchikey_non_standard()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_selfies" class="md-nav__link">
    to_selfies()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smarts" class="md-nav__link">
    to_smarts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.convert.to_smiles" class="md-nav__link">
    to_smiles()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-cluster" class="md-nav__link">
    Module cluster
  </a>
  
    <nav class="md-nav" aria-label="Module cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster" class="md-nav__link">
    cluster
  </a>
  
    <nav class="md-nav" aria-label="cluster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.assign_to_centroids" class="md-nav__link">
    assign_to_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.cluster_mols" class="md-nav__link">
    cluster_mols()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_centroids" class="md-nav__link">
    pick_centroids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.cluster.pick_diverse" class="md-nav__link">
    pick_diverse()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-fp" class="md-nav__link">
    Module fp
  </a>
  
    <nav class="md-nav" aria-label="Module fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp" class="md-nav__link">
    fp
  </a>
  
    <nav class="md-nav" aria-label="fp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fold_count_fp" class="md-nav__link">
    fold_count_fp()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.fp_to_array" class="md-nav__link">
    fp_to_array()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.list_supported_fingerprints" class="md-nav__link">
    list_supported_fingerprints()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.fp.to_fp" class="md-nav__link">
    to_fp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-similarity" class="md-nav__link">
    Module similarity
  </a>
  
    <nav class="md-nav" aria-label="Module similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity" class="md-nav__link">
    similarity
  </a>
  
    <nav class="md-nav" aria-label="similarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.cdist" class="md-nav__link">
    cdist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.similarity.pdist" class="md-nav__link">
    pdist()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-isomers" class="md-nav__link">
    Module isomers
  </a>
  
    <nav class="md-nav" aria-label="Module isomers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.isomers" class="md-nav__link">
    isomers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-data" class="md-nav__link">
    Module data
  </a>
  
    <nav class="md-nav" aria-label="Module data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data" class="md-nav__link">
    data
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.data.cdk2" class="md-nav__link">
    cdk2()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.data.freesolv" class="md-nav__link">
    freesolv()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.data.solubility" class="md-nav__link">
    solubility()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-log" class="md-nav__link">
    Module log
  </a>
  
    <nav class="md-nav" aria-label="Module log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log" class="md-nav__link">
    log
  </a>
  
    <nav class="md-nav" aria-label="log">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.log.without_rdkit_log" class="md-nav__link">
    without_rdkit_log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.disable_rdkit_log" class="md-nav__link">
    disable_rdkit_log()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.log.enable_rdkit_log" class="md-nav__link">
    enable_rdkit_log()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-graph" class="md-nav__link">
    Module graph
  </a>
  
    <nav class="md-nav" aria-label="Module graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph" class="md-nav__link">
    graph
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datamol.graph.get_all_path_between" class="md-nav__link">
    get_all_path_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.match_molecular_graphs" class="md-nav__link">
    match_molecular_graphs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.reorder_mol_from_template" class="md-nav__link">
    reorder_mol_from_template()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datamol.graph.to_graph" class="md-nav__link">
    to_graph()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <a href="https://github.com/datamol-org/datamol/edit/master/docs/api/datamol.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="datamol"><code>datamol</code><a class="headerlink" href="#datamol" title="Permanent link">&para;</a></h1>
<h2 id="module-mol">Module <code>mol</code><a class="headerlink" href="#module-mol" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.mol" class="doc doc-heading">
          <code>mol</code>


<a href="#datamol.mol" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.mol.add_hs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">explicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_on_atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_residue_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.add_hs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Adds hydrogens to the molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>explicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to only add explicit hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>add_coords</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to add 3D coordinates to the hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>only_on_atoms</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td><p>a list of atoms to add hydrogens only on.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>add_residue_info</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to add residue information to the hydrogens.
Useful for PDB files.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_hs</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">explicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_coords</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">only_on_atoms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_residue_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds hydrogens to the molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        explicit_only: whether to only add explicit hydrogens.</span>
<span class="sd">        add_coords: whether to add 3D coordinates to the hydrogens.</span>
<span class="sd">        only_on_atoms: a list of atoms to add hydrogens only on.</span>
<span class="sd">        add_residue_info: whether to add residue information to the hydrogens.</span>
<span class="sd">            Useful for PDB files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">AddHs</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">explicitOnly</span><span class="o">=</span><span class="n">explicit_only</span><span class="p">,</span>
        <span class="n">addCoords</span><span class="o">=</span><span class="n">add_coords</span><span class="p">,</span>
        <span class="n">onlyOnAtoms</span><span class="o">=</span><span class="n">only_on_atoms</span><span class="p">,</span>
        <span class="n">addResidueInfo</span><span class="o">=</span><span class="n">add_residue_info</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.adjust_singleton" class="doc doc-heading">
<code class="highlight language-python"><span class="n">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.adjust_singleton" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.
For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C",
but not the ethane fragment.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">adjust_singleton</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove all atoms that are essentially disconnected singleton nodes in the molecular graph.</span>
<span class="sd">    For example, the chlorine atom and methane fragment will be removed in Cl.[N:1]1=CC(O)=CC2CCCCC12.CC.C&quot;,</span>
<span class="sd">    but not the ethane fragment.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_rem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">em</span> <span class="o">=</span> <span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">to_rem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
    <span class="n">to_rem</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a_idx</span> <span class="ow">in</span> <span class="n">to_rem</span><span class="p">:</span>
        <span class="n">em</span><span class="o">.</span><span class="n">RemoveAtom</span><span class="p">(</span><span class="n">a_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.atom_indices_to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.atom_indices_to_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Add the <code>molAtomMapNumber</code> property to each atoms.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">atom_indices_to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add the `molAtomMapNumber` property to each atoms.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">&quot;molAtomMapNumber&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.atom_list_to_bond" class="doc doc-heading">
<code class="highlight language-python"><span class="n">atom_list_to_bond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">,</span> <span class="n">bond_as_idx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.atom_list_to_bond" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return a list of existing bond indices between a list of
atom indices.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom_indices</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>A list of atom indices.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">atom_list_to_bond</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom_indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">bond_as_idx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of existing bond indices between a list of</span>
<span class="sd">    atom indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        atom_indices: A list of atom indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Build an atom map</span>
    <span class="n">atom_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">submol</span> <span class="o">=</span> <span class="n">PathToSubmol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">,</span> <span class="n">useQuery</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">atomMap</span><span class="o">=</span><span class="n">atom_map</span><span class="p">)</span>
    <span class="n">atom_map_reversed</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">atom_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">submol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
        <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">()</span>
        <span class="n">ori_a1</span> <span class="o">=</span> <span class="n">atom_map_reversed</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span>
        <span class="n">ori_a2</span> <span class="o">=</span> <span class="n">atom_map_reversed</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ori_a1</span> <span class="ow">in</span> <span class="n">atom_indices</span> <span class="ow">and</span> <span class="n">ori_a2</span> <span class="ow">in</span> <span class="n">atom_indices</span><span class="p">:</span>
            <span class="n">ori_bond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">ori_a1</span><span class="p">,</span> <span class="n">ori_a2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bond_as_idx</span><span class="p">:</span>
                <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ori_bond</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ori_bond</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bonds</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.clear_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">clear_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.clear_mol_props" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Clear all properties from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clear_mol_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clear all properties from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        copy: Whether to copy the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span><span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span> <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">ClearProp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.compute_ring_system" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compute_ring_system</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">include_spiro</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.compute_ring_system" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the list of ring system in a molecule. This is based on RDKit's cookbook:
<a href="https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization">https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization</a></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_spiro</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include spiro rings.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ring_system</code></td>          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Set">Set</span>[int]]</code>
          </td>
          <td><p>list of ring system (atom indices).</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_ring_system</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">include_spiro</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Compute the list of ring system in a molecule. This is based on RDKit&#39;s cookbook:</span>
<span class="sd">    https://www.rdkit.org/docs/Cookbook.html#rings-aromaticity-and-kekulization</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule</span>
<span class="sd">        include_spiro: whether to include spiro rings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ring_system: list of ring system (atom indices).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span>
    <span class="n">systems</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">():</span>
        <span class="n">ringAts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
        <span class="n">nSystems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">:</span>
            <span class="n">nInCommon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ringAts</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nInCommon</span> <span class="ow">and</span> <span class="p">(</span><span class="n">include_spiro</span> <span class="ow">or</span> <span class="n">nInCommon</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">ringAts</span> <span class="o">=</span> <span class="n">ringAts</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nSystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
        <span class="n">nSystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ringAts</span><span class="p">)</span>
        <span class="n">systems</span> <span class="o">=</span> <span class="n">nSystems</span>
    <span class="k">return</span> <span class="n">systems</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.copy_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.copy_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Copy a molecule and return a new one.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Copy a molecule and return a new one.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule to copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.copy_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_mol_props</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.copy_mol_props" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Copy properties from one source molecule to another destination
molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>source</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>destination</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule to copy to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include private properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include computed properties.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_mol_props</span><span class="p">(</span>
    <span class="n">source</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">destination</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy properties from one source molecule to another destination</span>
<span class="sd">    molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        source: a molecule to copy from.</span>
<span class="sd">        destination: a molecule to copy to.</span>
<span class="sd">        include_private: Include private properties.</span>
<span class="sd">        include_computed: Include computed properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">props</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span><span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span> <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">)</span>
    <span class="n">set_mol_props</span><span class="p">(</span><span class="n">destination</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.decrease_bond" class="doc doc-heading">
<code class="highlight language-python"><span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span></code>

<a href="#datamol.mol.decrease_bond" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove one single bond from the input bond. Note that you should
first kekulize your molecules and remove non-standard bond.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bond</code></td>
          <td>
                <code><span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Bond">Bond</span></code>
          </td>
          <td><p>a bond.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Bond</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Remove one single bond from the input bond. Note that you should</span>
<span class="sd">    first kekulize your molecules and remove non-standard bond.</span>

<span class="sd">    Args:</span>
<span class="sd">        bond: a bond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">TRIPLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DOUBLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">DOUBLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SINGLE_BOND</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">SINGLE_BOND</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">bond</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.fix_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">remove_singleton</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">largest_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fix error in molecule using a greedy approach.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule to fix</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_iter</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of valence fix iteration to apply</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_singleton</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether <code>adjust_singleton</code> should be applied</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>largest_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether only the largest fragment should be kept</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a copy of the mol or perform in place operation</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">remove_singleton</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">largest_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Fix error in molecule using a greedy approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule to fix</span>
<span class="sd">        n_iter: Number of valence fix iteration to apply</span>
<span class="sd">        remove_singleton: Whether `adjust_singleton` should be applied</span>
<span class="sd">        largest_only: Whether only the largest fragment should be kept</span>
<span class="sd">        inplace: Whether to return a copy of the mol or perform in place operation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="ow">or</span> <span class="n">mol</span>  <span class="c1"># fail back to mol when the fixer fail</span>

    <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">remove_dummies</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">fix_valence</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_singleton</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">adjust_singleton</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">largest_only</span><span class="p">:</span>
            <span class="c1"># m = max(Chem.rdmolops.GetMolFrags(m, asMols=True, sanitizeFrags=False), key=lambda m: m.GetNumAtoms())</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">FragmentParent</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">skipStandardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.fix_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_valence</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_valence" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Identify and try to fix valence issues by removing any supplemental bond
that should not be in the graph.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule with incorrect valence for some atoms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to modify in place or make a copy</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_ring_break</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether bond removal involving ring is allowed.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed potential valence issue in molecule or original molecule when nothing is broken</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>of if failed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">allow_ring_break</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Identify and try to fix valence issues by removing any supplemental bond</span>
<span class="sd">    that should not be in the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy</span>
<span class="sd">        allow_ring_break: Whether bond removal involving ring is allowed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed potential valence issue in molecule or original molecule when nothing is broken</span>
<span class="sd">        of if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># don&#39;t fix something that is not broken</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">remove_hs</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">implicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">update_explicit_count</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># first pass using explicit false count</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="k">while</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cur_hydrogen</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cur_hydrogen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># atom.SetNumRadicalElectrons(0)</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">em</span> <span class="o">=</span> <span class="n">RWMol</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">bond</span>
            <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()),</span>
                    <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a2</span><span class="p">):</span>
                <span class="n">mbond</span> <span class="o">=</span> <span class="n">decrease_bond</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">allow_ring_break</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mbond</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">bond</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">()):</span>
                    <span class="n">em</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">mbond</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">em</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">a2</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">mbond</span><span class="p">)</span>
            <span class="n">a1</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">a2</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">GetMol</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.fix_valence_charge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.fix_valence_charge" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fix valence issues that are due to incorrect charges.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>Input molecule with incorrect valence for some atoms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inplace</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to modify in place or make a copy.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Fixed molecule via charge correction or original molecule if failed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fix_valence_charge</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Fix valence issues that are due to incorrect charges.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: Input molecule with incorrect valence for some atoms</span>
<span class="sd">        inplace: Whether to modify in place or make a copy.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fixed molecule via charge correction or original molecule if failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>

    <span class="c1"># Don&#39;t fix something that is not broken</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

        <span class="n">mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
            <span class="n">n_electron</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span>
                <span class="o">-</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="n">n_electron</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.incorrect_valence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.incorrect_valence" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Check if an atom connection is not valid or all the atom of a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>a</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="datamol.types.Mol">Mol</span>, <span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Atom">Atom</span>]</code>
          </td>
          <td><p>atom or molecule to check for valence issue.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>update</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Update owning molecule property cache first.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the input atom valence is correct.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">incorrect_valence</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mol</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">],</span> <span class="n">update</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if an atom connection is not valid or all the atom of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        a: atom or molecule to check for valence issue.</span>
<span class="sd">        update: Update owning molecule property cache first.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the input atom valence is correct.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vm</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">RDKitValidation</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">GetOwningMol</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetValenceList</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()))</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.is_transition_metal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)</span></code>

<a href="#datamol.mol.is_transition_metal" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Check if atom is a transition metal.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>at</code></td>
          <td>
                <code><span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Atom">Atom</span></code>
          </td>
          <td><p>an atom.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Atom</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if atom is a transition metal.</span>

<span class="sd">    Args:</span>
<span class="sd">        at: an atom.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">22</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">40</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">47</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">72</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">79</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.keep_largest_fragment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.keep_largest_fragment" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Only keep largest fragment of each molecule.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">keep_largest_fragment</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Only keep largest fragment of each molecule.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">GetMolFrags</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">asMols</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="n">mol</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.make_scaffold_generic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_scaffold_generic</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">include_bonds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.make_scaffold_generic" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Make the atom in a scaffold or molecule generic.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule or a scaffold.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_bonds</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether we should also update bond order or keep as is.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_scaffold_generic</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">include_bonds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make the atom in a scaffold or molecule generic.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule or a scaffold.</span>
<span class="sd">        include_bonds: Whether we should also update bond order or keep as is.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">SetAtomicNum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">atom</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetChiralTag</span><span class="p">(</span><span class="n">rdchem</span><span class="o">.</span><span class="n">ChiralType</span><span class="o">.</span><span class="n">CHI_UNSPECIFIED</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetNoImplicit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">include_bonds</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">SetBondType</span><span class="p">(</span><span class="n">UNSPECIFIED_BOND</span><span class="p">)</span>

    <span class="n">mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">GetSymmSSSR</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.protect_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">protect_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">substruct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.protect_atoms" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Protect a list of atoms or substruct in a molecule.</p>
<p>The _protected attributes of a molecule is used by RDKit in several functions, especially for reactions
where "protected" atoms are disallowed from taking part in reactions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>input molecule to protect</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>substruct</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>optional substructure query to identify atoms to protect</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>atoms</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[int], int]]</code>
          </td>
          <td><p>optional list of atom indices to protect</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>in_place</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to perform the protection in place or return a copy of the molecule</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">protect_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">substruct</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">atoms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Protect a list of atoms or substruct in a molecule.</span>

<span class="sd">    The _protected attributes of a molecule is used by RDKit in several functions, especially for reactions</span>
<span class="sd">    where &quot;protected&quot; atoms are disallowed from taking part in reactions.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: input molecule to protect</span>
<span class="sd">        substruct: optional substructure query to identify atoms to protect</span>
<span class="sd">        atoms: optional list of atom indices to protect</span>
<span class="sd">        in_place: whether to perform the protection in place or return a copy of the molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">atoms</span><span class="p">]</span>

    <span class="c1"># do not perform protection in place</span>
    <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
        <span class="n">mol_copy</span> <span class="o">=</span> <span class="n">mol</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mol_copy</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">substruct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">mol_copy</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">substruct</span><span class="p">)</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">matches</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">mol_copy</span><span class="o">.</span><span class="n">GetAtomWithIdx</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="s2">&quot;_protected&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol_copy</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.randomize_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.randomize_atoms" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Randomize the position of the atoms in a mol.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Randomize the position of the atoms in a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()))</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.remove_dummies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span></code>

<a href="#datamol.mol.remove_dummies" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove dummy atoms from molecules.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_dummies</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.&quot;&quot;&quot;</span>

    <span class="n">du</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">to_mol</span><span class="p">(</span><span class="s2">&quot;[H]&quot;</span><span class="p">),</span> <span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">remove_hs</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.remove_hs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">implicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">update_explicit_count</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.remove_hs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Removes hydrogens from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>implicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to only remove implicit hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>update_explicit_count</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to update the explicit hydrogen count.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to sanitize the molecule after the hydrogens are removed.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_hs</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">implicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">update_explicit_count</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Removes hydrogens from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        implicit_only: whether to only remove implicit hydrogens.</span>
<span class="sd">        update_explicit_count: whether to update the explicit hydrogen count.</span>
<span class="sd">        sanitize: whether to sanitize the molecule after the hydrogens are removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">RemoveHs</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">implicitOnly</span><span class="o">=</span><span class="n">implicit_only</span><span class="p">,</span>
        <span class="n">updateExplicitCount</span><span class="o">=</span><span class="n">update_explicit_count</span><span class="p">,</span>
        <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.reorder_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reorder_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">break_ties</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_chirality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_isotopes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.reorder_atoms" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Reorder the atoms in a mol. It ensures a single atom order for the same molecule,
regardless of its original representation.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>break_ties</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Force breaking of ranked ties.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_chirality</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Use chiral information when computing rank.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_isotopes</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Use isotope information when computing rank.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">break_ties</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_chirality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">include_isotopes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Reorder the atoms in a mol. It ensures a single atom order for the same molecule,</span>
<span class="sd">    regardless of its original representation.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        break_ties: Force breaking of ranked ties.</span>
<span class="sd">        include_chirality: Use chiral information when computing rank.</span>
<span class="sd">        include_isotopes: Use isotope information when computing rank.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">new_order</span> <span class="o">=</span> <span class="n">CanonicalRankAtoms</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">breakTies</span><span class="o">=</span><span class="n">break_ties</span><span class="p">,</span>
        <span class="n">includeChirality</span><span class="o">=</span><span class="n">include_chirality</span><span class="p">,</span>
        <span class="n">includeIsotopes</span><span class="o">=</span><span class="n">include_isotopes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">new_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_order</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">new_order</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.replace_dummies_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_dummies_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">dummy</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">replace_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.replace_dummies_atoms" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Remove dummy atoms from molecules.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>molecule with dummies</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>replacement atom, default is carbon</p></td>
          <td>
                <code>&#39;C&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dummy</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>dummy atom representation</p></td>
          <td>
                <code>&#39;*&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>replace_all</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to replace all dummies</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>Molecule with dummy replaced</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">replace_dummies_atoms</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">dummy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
    <span class="n">replace_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Remove dummy atoms from molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: molecule with dummies</span>
<span class="sd">        atom: replacement atom, default is carbon</span>
<span class="sd">        dummy: dummy atom representation</span>
<span class="sd">        replace_all: Whether to replace all dummies</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: Molecule with dummy replaced</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
    <span class="n">replacement</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">ReplaceSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">replaceAll</span><span class="o">=</span><span class="n">replace_all</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.same_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">same_mol</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="n">use_non_standard_inchikey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.same_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Check two molecules are the same by comparing their InChiKey.</p>
<p>Invalid molecules (None) are always considered as not the same.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol1</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mol2</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>use_non_standard_inchikey</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to use the standard or non-standard InChiKey.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">same_mol</span><span class="p">(</span>
    <span class="n">mol1</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">mol2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">use_non_standard_inchikey</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check two molecules are the same by comparing their InChiKey.</span>

<span class="sd">    Invalid molecules (None) are always considered as not the same.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol1: A molecule.</span>
<span class="sd">        mol2: A molecule.</span>
<span class="sd">        use_non_standard_inchikey: Whether to use the standard or non-standard InChiKey.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mol2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">use_non_standard_inchikey</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">==</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span> <span class="o">==</span> <span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.sanitize_first" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_first" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Sanitize a list of molecules and return the first valid molecule seen in the list.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>charge_neutral</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether charge neutralization should be applied.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanifix</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_first</span><span class="p">(</span><span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Sanitize a list of molecules and return the first valid molecule seen in the list.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="n">charge_neutral</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="n">sanifix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mol</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.sanitize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">charge_neutral</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanifix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>An augmented version of RDKit <code>sanitize=True</code>. It uses a
mol-SMILES-mol conversion to catch potential aromaticity errors
and try to fix aromatic nitrogen (using the popular sanifix4 script).
Optionally, it can neutralize the charge of the molecule.</p>
<p>Note #1: Only the first conformer (if present) will be preserved and
a warning will be displayed if more than one conformer is detected.</p>
<p>Note #2: The molecule's properties will be preserved but the atom's
properties will be lost.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>charge_neutral</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether charge neutralization should be applied.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanifix</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to run the sanifix from James Davidson
(sanifix4.py) that try to adjust aromatic nitrogens.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether displaying a warning about multiple conformers.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>add_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Add hydrogens to the returned molecule. Useful when the input
molecule already contains hydrogens.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">charge_neutral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanifix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">add_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;An augmented version of RDKit `sanitize=True`. It uses a</span>
<span class="sd">    mol-SMILES-mol conversion to catch potential aromaticity errors</span>
<span class="sd">    and try to fix aromatic nitrogen (using the popular sanifix4 script).</span>
<span class="sd">    Optionally, it can neutralize the charge of the molecule.</span>

<span class="sd">    Note #1: Only the first conformer (if present) will be preserved and</span>
<span class="sd">    a warning will be displayed if more than one conformer is detected.</span>

<span class="sd">    Note #2: The molecule&#39;s properties will be preserved but the atom&#39;s</span>
<span class="sd">    properties will be lost.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        charge_neutral: whether charge neutralization should be applied.</span>
<span class="sd">        sanifix: whether to run the sanifix from James Davidson</span>
<span class="sd">            (sanifix4.py) that try to adjust aromatic nitrogens.</span>
<span class="sd">        verbose: Whether displaying a warning about multiple conformers.</span>
<span class="sd">        add_hs: Add hydrogens to the returned molecule. Useful when the input</span>
<span class="sd">            molecule already contains hydrogens.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="c1"># Extract properties.</span>
    <span class="n">original_mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="n">original_mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">charge_neutral</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sanifix</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">_sanifix4</span><span class="o">.</span><span class="n">sanifix</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># Detect multiple conformers</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumConformers</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The molecule contains multiple conformers. Only the first one will be preserved.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Try catch to avoid occasional aromaticity errors</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># `cxsmiles` is used here to preserve the first conformer.</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">cxsmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="n">add_hs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Insert back properties.</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.sanitize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.sanitize_smiles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Takes SMILES string and returns its sanitized version.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>smiles to be sanitized.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>isomeric</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to include information about stereochemistry in the SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>sanitized smiles.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sanitize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">isomeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Takes SMILES string and returns its sanitized version.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: smiles to be sanitized.</span>
<span class="sd">        isomeric: Whether to include information about stereochemistry in the SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        sanitized smiles.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mol</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">sanitize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="n">isomeric</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.set_dative_bonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_dative_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>

<a href="#datamol.mol.set_dative_bonds" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms
with dative bonds. The replacement is only done if the atom has "too many" bonds.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>molecule with bond to modify</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>from_atoms</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td><p>List of atoms  (symbol or atomic number) to consider for bond replacement.
By default, only Nitrogen (7) and Oxygen (8) are considered.</p></td>
          <td>
                <code>(7, 8)</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>The modified molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_dative_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">from_atoms</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Replaces some single bonds between metals and atoms with atomic numbers in fromAtoms</span>
<span class="sd">    with dative bonds. The replacement is only done if the atom has &quot;too many&quot; bonds.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: molecule with bond to modify</span>
<span class="sd">        from_atoms: List of atoms  (symbol or atomic number) to consider for bond replacement.</span>
<span class="sd">            By default, only Nitrogen (7) and Oxygen (8) are considered.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The modified molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rwmol</span> <span class="o">=</span> <span class="n">RWMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">rwmol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">metals</span> <span class="o">=</span> <span class="p">[</span><span class="n">at</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_transition_metal</span><span class="p">(</span><span class="n">at</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">metal</span> <span class="ow">in</span> <span class="n">metals</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span> <span class="ow">or</span> <span class="n">nbr</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()</span> <span class="ow">in</span> <span class="n">from_atoms</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">nbr</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">())</span>
                <span class="ow">and</span> <span class="n">rwmol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">SINGLE_BOND</span>
            <span class="p">):</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">())</span>
                <span class="n">rwmol</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="n">nbr</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">metal</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span> <span class="n">DATIVE_BOND</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rwmol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.set_mol_props" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.set_mol_props" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Set properties to a mol from a dict.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>the mol where to copy the props.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>props</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>the props to copy.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>copy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to copy the provided mol</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_mol_props</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">props</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Set properties to a mol from a dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: the mol where to copy the props.</span>
<span class="sd">        props: the props to copy.</span>
<span class="sd">        copy: whether to copy the provided mol</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetBoolProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># NOTE(hadim): A Python integer is 32 bits and RDKit seems</span>
            <span class="c1"># to overflow before that. Here we catch the error</span>
            <span class="c1"># and instead uses silently `SetDoubleProp` instead.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mol</span><span class="o">.</span><span class="n">SetIntProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
                <span class="n">mol</span><span class="o">.</span><span class="n">SetDoubleProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetDoubleProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mol</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.standardize_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">standardize_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">disconnect_metals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reionize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">uncharge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.standardize_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>This function returns a standardized version the given molecule. It relies on the
RDKit <a href="https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html"><code>rdMolStandardize</code> module</a>
which is largely inspired from <a href="https://github.com/mcs07/MolVS">MolVS</a>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule to standardize.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>disconnect_metals</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Disconnect metals that are defined as covalently bonded to non-metal.
Depending on the source of the database, some compounds may be reported in salt form
or associated to metallic ions (e.g. the sodium salt of a carboxylic compound).
In most cases, these counter-ions are not relevant so the use of this function is required
before further utilization of the dataset. In summary the process is the following:</p>
<ul>
<li>Break covalent bonds between metals and organic atoms under certain conditions.</li>
<li>First, disconnect N, O, F from any metal. Then disconnect other non-metals from transition metals (with exceptions).</li>
<li>For every bond broken, adjust the charges of the begin and end atoms accordingly.</li>
</ul></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>normalize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Applies a series of standard transformations to correct functional groups and recombine charges.
It corrects drawing errors and standardizes functional groups in the molecule as well as ensuring the
overall proper charge of the compound. It includes:</p>
<ul>
<li>Uncharge-separate sulfones</li>
<li>Charge-separate nitro groups</li>
<li>Charge-separate pyridine oxide</li>
<li>Charge-separate azide</li>
<li>Charge-separate diazo and azo groups</li>
<li>Charge-separate sulfoxides</li>
<li>Hydrazine-diazonium system</li>
</ul></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>reionize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If one or more acidic functionalities are present in the molecule, this option ensures the correct
neutral/ionized state for such functional groups. Molecules are uncharged by adding and/or removing hydrogens.
For zwitterions, hydrogens are moved to eliminate charges where possible. However, in cases where there is a
positive charge that is not neutralizable, an attempt is made to also preserve the corresponding negative charge
The algorithm works as follows:</p>
<ul>
<li>Use SMARTS to find the strongest protonated acid and the weakest ionized acid.</li>
<li>If the ionized acid is weaker than the protonated acid, swap proton and repeat.</li>
</ul></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>uncharge</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>This option neutralize the molecule by reversing the protonation state of protonated and deprotonated groups,
if present (e.g. a carboxylate is re-protonated to the corresponding carboxylic acid).
In cases where there is a positive charge that is not neutralizable, an attempt is made to also preserve the
corresponding negative charge to ensure a net zero charge.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>stereo</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Stereochemical information is corrected and/or added if missing using built-in RDKit functionality to force a clean recalculation of stereochemistry (<code>AssignStereochemistry</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A standardized molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">disconnect_metals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reionize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">uncharge</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stereo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mol</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns a standardized version the given molecule. It relies on the</span>
<span class="sd">    RDKit [`rdMolStandardize` module](https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html)</span>
<span class="sd">    which is largely inspired from [MolVS](https://github.com/mcs07/MolVS).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        mol: A molecule to standardize.</span>

<span class="sd">        disconnect_metals: Disconnect metals that are defined as covalently bonded to non-metal.</span>
<span class="sd">            Depending on the source of the database, some compounds may be reported in salt form</span>
<span class="sd">            or associated to metallic ions (e.g. the sodium salt of a carboxylic compound).</span>
<span class="sd">            In most cases, these counter-ions are not relevant so the use of this function is required</span>
<span class="sd">            before further utilization of the dataset. In summary the process is the following:</span>

<span class="sd">            - Break covalent bonds between metals and organic atoms under certain conditions.</span>
<span class="sd">            - First, disconnect N, O, F from any metal. Then disconnect other non-metals from transition metals (with exceptions).</span>
<span class="sd">            - For every bond broken, adjust the charges of the begin and end atoms accordingly.</span>

<span class="sd">        normalize: Applies a series of standard transformations to correct functional groups and recombine charges.</span>
<span class="sd">            It corrects drawing errors and standardizes functional groups in the molecule as well as ensuring the</span>
<span class="sd">            overall proper charge of the compound. It includes:</span>

<span class="sd">            - Uncharge-separate sulfones</span>
<span class="sd">            - Charge-separate nitro groups</span>
<span class="sd">            - Charge-separate pyridine oxide</span>
<span class="sd">            - Charge-separate azide</span>
<span class="sd">            - Charge-separate diazo and azo groups</span>
<span class="sd">            - Charge-separate sulfoxides</span>
<span class="sd">            - Hydrazine-diazonium system</span>

<span class="sd">        reionize: If one or more acidic functionalities are present in the molecule, this option ensures the correct</span>
<span class="sd">            neutral/ionized state for such functional groups. Molecules are uncharged by adding and/or removing hydrogens.</span>
<span class="sd">            For zwitterions, hydrogens are moved to eliminate charges where possible. However, in cases where there is a</span>
<span class="sd">            positive charge that is not neutralizable, an attempt is made to also preserve the corresponding negative charge</span>
<span class="sd">            The algorithm works as follows:</span>

<span class="sd">            - Use SMARTS to find the strongest protonated acid and the weakest ionized acid.</span>
<span class="sd">            - If the ionized acid is weaker than the protonated acid, swap proton and repeat.</span>

<span class="sd">        uncharge: This option neutralize the molecule by reversing the protonation state of protonated and deprotonated groups,</span>
<span class="sd">            if present (e.g. a carboxylate is re-protonated to the corresponding carboxylic acid).</span>
<span class="sd">            In cases where there is a positive charge that is not neutralizable, an attempt is made to also preserve the</span>
<span class="sd">            corresponding negative charge to ensure a net zero charge.</span>

<span class="sd">        stereo: Stereochemical information is corrected and/or added if missing using built-in RDKit functionality to force a clean recalculation of stereochemistry (`AssignStereochemistry`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: A standardized molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">copy_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">disconnect_metals</span><span class="p">:</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">MetalDisconnector</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">Disconnect</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reionize</span><span class="p">:</span>
        <span class="n">reionizer</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Reionizer</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">reionizer</span><span class="o">.</span><span class="n">reionize</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">uncharge</span><span class="p">:</span>
        <span class="n">uncharger</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">Uncharger</span><span class="p">()</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">uncharger</span><span class="o">.</span><span class="n">uncharge</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">stereo</span><span class="p">:</span>
        <span class="n">AssignStereochemistry</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cleanIt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.standardize_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">tautomer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.standardize_smiles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit
smiles standardizer and tautomeric canonicalization.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Smiles to standardize</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tautomer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to canonicalize tautomers</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>standard_smiles</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>the standardized smiles</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">standardize_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tautomer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply smile standardization procedure. This is a convenient function wrapped arrounf RDKit</span>
<span class="sd">    smiles standardizer and tautomeric canonicalization.</span>

<span class="sd">    Args:</span>
<span class="sd">        smiles: Smiles to standardize</span>
<span class="sd">        tautomer: Whether to canonicalize tautomers</span>

<span class="sd">    Returns:</span>
<span class="sd">        standard_smiles: the standardized smiles</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">rdMolStandardize</span><span class="o">.</span><span class="n">StandardizeSmiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tautomer</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="n">canonicalize_tautomer_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.strip_mol_to_core" class="doc doc-heading">
<code class="highlight language-python"><span class="n">strip_mol_to_core</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">bond_cutter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.mol.strip_mol_to_core" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Strip a molecule to its core, i.e. remove all atoms not in the core.
This method 'guess' the molecular core, by finding the ring system.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bond_cutter</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule used to cut the bonds.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">strip_mol_to_core</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">bond_cutter</span><span class="p">:</span> <span class="n">Mol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Strip a molecule to its core, i.e. remove all atoms not in the core.</span>
<span class="sd">    This method &#39;guess&#39; the molecular core, by finding the ring system.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        bond_cutter: A molecule used to cut the bonds.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">bond_cutter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bond_cutter</span> <span class="o">=</span> <span class="n">from_smarts</span><span class="p">(</span><span class="s2">&quot;[R;!$(*=,#[!#6])]!@!=!#[*;$([A;!R][A;!R])]&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">without_rdkit_log</span><span class="p">():</span>

        <span class="n">scaffold</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">bond_cutter</span><span class="p">)</span>
        <span class="n">bond_inds</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bond_inds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">rdmolops</span><span class="o">.</span><span class="n">FragmentOnBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">bond_inds</span><span class="p">)</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">remove_dummies</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>
            <span class="n">fragmented</span> <span class="o">=</span> <span class="n">to_scaffold_murcko</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>
            <span class="n">scaffold</span> <span class="o">=</span> <span class="n">keep_largest_fragment</span><span class="p">(</span><span class="n">fragmented</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scaffold</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.substructure_matching_bonds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substructure_matching_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#datamol.mol.substructure_matching_bonds" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Perform a substructure match using <code>GetSubstructMatches</code> but instead
of returning only the atom indices also return the bond indices.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>query</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule used as a query to match against.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Any other arguments to pass to <code>mol.GetSubstructMatches()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>atom_matches</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>A list of lists of atom indices.</p></td>
        </tr>
        <tr>
<td><code>bond_matches</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>A list of lists of bond indices.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">substructure_matching_bonds</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Perform a substructure match using `GetSubstructMatches` but instead</span>
<span class="sd">    of returning only the atom indices also return the bond indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        query: A molecule used as a query to match against.</span>
<span class="sd">        **kwargs: Any other arguments to pass to `mol.GetSubstructMatches()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        atom_matches: A list of lists of atom indices.</span>
<span class="sd">        bond_matches: A list of lists of bond indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># NOTE(hadim): If more substructure functions are added here, consider moving it to</span>
    <span class="c1"># a dedicated `substructure` module.</span>

    <span class="c1"># Set default arguments</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;uniquify&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Get the matching atom indices</span>
    <span class="n">atom_matches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="c1"># Get the bond to highligh from the query</span>
    <span class="n">query_bond_indices</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">())</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="c1"># Retrieve the atom indices</span>
    <span class="n">query_atom_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">())]</span>

    <span class="n">bond_matches</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">atom_matches</span><span class="p">:</span>

        <span class="c1"># Map the atom of the query to the atom of the mol matching the query</span>
        <span class="n">atom_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">query_atom_indices</span><span class="p">,</span> <span class="n">match</span><span class="p">))</span>

        <span class="c1"># For this match atoms we now, we use the map to retrieve the matching bonds</span>
        <span class="c1"># in the mol.</span>
        <span class="n">mol_bond_indices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">atom_map</span><span class="p">[</span><span class="n">a1</span><span class="p">],</span> <span class="n">atom_map</span><span class="p">[</span><span class="n">a2</span><span class="p">])</span> <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">query_bond_indices</span><span class="p">]</span>

        <span class="c1"># Convert the bond atom indices to bond indices</span>
        <span class="n">mol_bond_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">()</span> <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">mol_bond_indices</span><span class="p">]</span>

        <span class="n">bond_matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mol_bond_indices</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">atom_matches</span><span class="p">,</span> <span class="n">bond_matches</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.to_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">add_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">kekulize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.mol.to_mol" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert an input molecule (smiles representation) into a <code>Mol</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>A SMILES or a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>add_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether hydrogens should be added the molecule.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>explicit_only</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to only add explicit hydrogen or both
(implicit and explicit). when <code>add_hs</code> is set to True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the atom should be ordered. This option is
important if you want to ensure that the features returned will always maintain
a single atom order for the same molecule, regardless of its original SMILES representation.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kekulize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to perform kekulization of the input molecules.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to apply rdkit sanitization when input is a SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>the molecule if some conversion have been made. If the conversion fails</p></td>
        </tr>
        <tr>
<td></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>None is returned so make sure that you handle this case on your own.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">],</span>
    <span class="n">add_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kekulize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert an input molecule (smiles representation) into a `Mol`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A SMILES or a molecule.</span>
<span class="sd">        add_hs: Whether hydrogens should be added the molecule.</span>
<span class="sd">        explicit_only: Whether to only add explicit hydrogen or both</span>
<span class="sd">            (implicit and explicit). when `add_hs` is set to True.</span>
<span class="sd">        ordered: Whether the atom should be ordered. This option is</span>
<span class="sd">            important if you want to ensure that the features returned will always maintain</span>
<span class="sd">            a single atom order for the same molecule, regardless of its original SMILES representation.</span>
<span class="sd">        kekulize: Whether to perform kekulization of the input molecules.</span>
<span class="sd">        sanitize: Whether to apply rdkit sanitization when input is a SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: the molecule if some conversion have been made. If the conversion fails</span>
<span class="sd">        None is returned so make sure that you handle this case on your own.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input should be a Mol or a string instead of &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sanitize</span> <span class="ow">and</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="c1"># Add hydrogens</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">add_hs</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">AddHs</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">explicitOnly</span><span class="o">=</span><span class="n">explicit_only</span><span class="p">,</span> <span class="n">addCoords</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Reorder atoms</span>
    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ordered</span><span class="p">:</span>
        <span class="n">_mol</span> <span class="o">=</span> <span class="n">reorder_atoms</span><span class="p">(</span><span class="n">_mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">kekulize</span><span class="p">:</span>
        <span class="n">Kekulize</span><span class="p">(</span><span class="n">_mol</span><span class="p">,</span> <span class="n">clearAromaticFlags</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.to_neutral" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.to_neutral" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Neutralize the charge of a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_neutral</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Neutralize the charge of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">a</span><span class="o">.</span><span class="n">GetExplicitValence</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PERIODIC_TABLE</span><span class="o">.</span><span class="n">GetDefaultValence</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">())</span>
            <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">):</span>
            <span class="n">a</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.to_scaffold_murcko" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_scaffold_murcko</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">make_generic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.mol.to_scaffold_murcko" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Extract the Murcko scaffold from a molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>make_generic</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to make the scaffold generic.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_scaffold_murcko</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span> <span class="n">make_generic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract the Murcko scaffold from a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        make_generic: Whether to make the scaffold generic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scf</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="c1"># NOTE(hadim): this is already done in `GetScaffoldForMol`</span>
    <span class="c1"># Note sure we need it here.</span>
    <span class="n">scf</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
    <span class="n">Chem</span><span class="o">.</span><span class="n">GetSymmSSSR</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">make_generic</span><span class="p">:</span>
        <span class="n">scf</span> <span class="o">=</span> <span class="n">make_scaffold_generic</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>
        <span class="n">scf</span> <span class="o">=</span> <span class="n">to_mol</span><span class="p">(</span><span class="n">scf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scf</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.mol.unique_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unique_id</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.mol.unique_id" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>A datamol unique molecule ID.</p>
<p>The ID is an MD5 hash of the non-standard InChiKey provided
by <code>dm.to_inchikey_non_standard()</code>. It guarantees uniqueness for
different tautomeric forms of the same molecule.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/mol.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unique_id</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;A datamol unique molecule ID.</span>

<span class="sd">    The ID is an MD5 hash of the non-standard InChiKey provided</span>
<span class="sd">    by `dm.to_inchikey_non_standard()`. It guarantees uniqueness for</span>
<span class="sd">    different tautomeric forms of the same molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ik</span> <span class="o">=</span> <span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ik</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">ik</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-io">Module <code>io</code><a class="headerlink" href="#module-io" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.io" class="doc doc-heading">
          <code>io</code>


<a href="#datamol.io" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.io.read_csv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_csv</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#datamol.io.read_csv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Read a CSV file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>, <span title="typing.IO">IO</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Use this column to build a mol column.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name to give to the mol column. If not None a mol column will be build.
Avoid when loading a very large file.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Arguments to pass to <code>pd.read_csv()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df</code></td>          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>a <code>pandas.DataFrame</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_csv</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">IO</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Read a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        smiles_column: Use this column to build a mol column.</span>
<span class="sd">        mol_column: Name to give to the mol column. If not None a mol column will be build.</span>
<span class="sd">            Avoid when loading a very large file.</span>
<span class="sd">        **kwargs: Arguments to pass to `pd.read_csv()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df: a `pandas.DataFrame`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.read_excel" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_excel</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#datamol.io.read_excel" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Read an excel file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>, <span title="typing.IO">IO</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sheet_name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, int, list]]</code>
          </td>
          <td><p>see <code>pandas.read_excel()</code> doc.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Name to give to the mol column. If not None a mol column will be build.
Avoid when loading a very large file.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>name to give to the mol column.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Arguments to pass to <code>pd.read_excel()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df</code></td>          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>a <code>pandas.DataFrame</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_excel</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">IO</span><span class="p">],</span>
    <span class="n">sheet_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Read an excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        sheet_name: see `pandas.read_excel()` doc.</span>
<span class="sd">        mol_column: Name to give to the mol column. If not None a mol column will be build.</span>
<span class="sd">            Avoid when loading a very large file.</span>
<span class="sd">        mol_column: name to give to the mol column.</span>
<span class="sd">        **kwargs: Arguments to pass to `pd.read_excel()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        df: a `pandas.DataFrame`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.read_molblock" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_molblock</span><span class="p">(</span><span class="n">molblock</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strict_parsing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fail_if_invalid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.io.read_molblock" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Read a Mol block.</p>
<p>Note that potential molecule properties are <strong>not</strong> read.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>molblock</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>String containing the Mol block.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to sanitize the molecules.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>strict_parsing</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to false, the parser is more lax about correctness of the contents.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to remove the existing hydrogens in the SDF files.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fail_if_invalid</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to true, the parser will raise an exception if the molecule is invalid
instead of returning None.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_molblock</span><span class="p">(</span>
    <span class="n">molblock</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">strict_parsing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fail_if_invalid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read a Mol block.</span>

<span class="sd">    Note that potential molecule properties are **not** read.</span>

<span class="sd">    Args:</span>
<span class="sd">        molblock: String containing the Mol block.</span>
<span class="sd">        sanitize: Whether to sanitize the molecules.</span>
<span class="sd">        strict_parsing: If set to false, the parser is more lax about correctness of the contents.</span>
<span class="sd">        remove_hs: Whether to remove the existing hydrogens in the SDF files.</span>
<span class="sd">        fail_if_invalid: If set to true, the parser will raise an exception if the molecule is invalid</span>
<span class="sd">            instead of returning None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mol</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span>
        <span class="n">molblock</span><span class="p">,</span>
        <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span>
        <span class="n">removeHs</span><span class="o">=</span><span class="n">remove_hs</span><span class="p">,</span>
        <span class="n">strictParsing</span><span class="o">=</span><span class="n">strict_parsing</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">fail_if_invalid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid molecule: </span><span class="si">{</span><span class="n">molblock</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.read_sdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_sdf</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict_parsing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.io.read_sdf" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Read an SDF file.</p>
<p>Note: This function is meant to be used with dataset that fit <em>in-memory</em>.
For a more advanced usage we suggest you to use directly <code>Chem.ForwardSDMolSupplier</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>, <span title="typing.IO">IO</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to sanitize the molecules.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>as_df</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a list mol or a pandas DataFrame.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Name of the SMILES column. Only relevant if <code>as_df</code> is True.</p></td>
          <td>
                <code>&#39;smiles&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Name of the mol column. Only relevant if <code>as_df</code> is True.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include private properties in the columns.  Only relevant if
<code>as_df</code> is True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include computed properties in the columns.  Only relevant if
<code>as_df</code> is True.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>strict_parsing</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If set to false, the parser is more lax about correctness of the contents.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to remove the existing hydrogens in the SDF files.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_sdf</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">IO</span><span class="p">],</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">as_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strict_parsing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read an SDF file.</span>

<span class="sd">    Note: This function is meant to be used with dataset that fit _in-memory_.</span>
<span class="sd">    For a more advanced usage we suggest you to use directly `Chem.ForwardSDMolSupplier`.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        sanitize: Whether to sanitize the molecules.</span>
<span class="sd">        as_df: Whether to return a list mol or a pandas DataFrame.</span>
<span class="sd">        smiles_column: Name of the SMILES column. Only relevant if `as_df` is True.</span>
<span class="sd">        mol_column: Name of the mol column. Only relevant if `as_df` is True.</span>
<span class="sd">        include_private: Include private properties in the columns.  Only relevant if</span>
<span class="sd">            `as_df` is True.</span>
<span class="sd">        include_computed: Include computed properties in the columns.  Only relevant if</span>
<span class="sd">            `as_df` is True.</span>
<span class="sd">        strict_parsing: If set to false, the parser is more lax about correctness of the contents.</span>
<span class="sd">        remove_hs: Whether to remove the existing hydrogens in the SDF files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">supplier</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">ForwardSDMolSupplier</span><span class="p">(</span>
            <span class="n">urlpath</span><span class="p">,</span>
            <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span>
            <span class="n">strictParsing</span><span class="o">=</span><span class="n">strict_parsing</span><span class="p">,</span>
            <span class="n">removeHs</span><span class="o">=</span><span class="n">remove_hs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">supplier</span><span class="p">)</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

            <span class="c1"># Handle gzip file if needed</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gz&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.gzip&quot;</span><span class="p">):</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="n">supplier</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">ForwardSDMolSupplier</span><span class="p">(</span>
                <span class="n">f</span><span class="p">,</span>
                <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span>
                <span class="n">strictParsing</span><span class="o">=</span><span class="n">strict_parsing</span><span class="p">,</span>
                <span class="n">removeHs</span><span class="o">=</span><span class="n">remove_hs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">mols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">supplier</span><span class="p">)</span>

    <span class="c1"># Discard None values</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Convert to dataframe</span>
    <span class="k">if</span> <span class="n">as_df</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
            <span class="n">mols</span><span class="p">,</span>
            <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span>
            <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">,</span>
            <span class="n">include_private</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span>
            <span class="n">include_computed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">return</span> <span class="n">mols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.read_smi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_smi</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span></code>

<a href="#datamol.io.read_smi" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Read a list of smiles from am <code>.smi</code> file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, pathlib.<span title="pathlib.Path">Path</span>, io.<span title="io.IOBase">IOBase</span>, <span title="fsspec.utils">fsspec</span>.<span title="fsspec.utils.core">core</span>.<span title="fsspec.core.OpenFile">OpenFile</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.
Note: file-like object are not supported yet.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_smi</span><span class="p">(</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">,</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">OpenFile</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read a list of smiles from am `.smi` file.</span>

<span class="sd">    Args:</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">            Note: file-like object are not supported yet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">active_path</span> <span class="o">=</span> <span class="n">urlpath</span>

    <span class="c1"># NOTE(hadim): the temporary local file copy</span>
    <span class="c1"># is because `SmilesMolSupplier` does not support</span>
    <span class="c1"># using file-like object, only path.</span>

    <span class="c1"># Copy to a local temporary path if the path is a remote one.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">can_be_local</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)):</span>
        <span class="n">active_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">dm</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">copy_file</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">active_path</span><span class="p">)</span>

    <span class="c1"># Read the molecules</span>
    <span class="n">supplier</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SmilesMolSupplier</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">active_path</span><span class="p">),</span> <span class="n">titleLine</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">supplier</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># Delete the local temporary path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">can_be_local</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)):</span>
        <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">active_path</span><span class="p">))</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">mols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.to_molblock" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_molblock</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">include_stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">conf_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kekulize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_V3000</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.io.to_molblock" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a molecule to a mol block string.</p>
<p>Note that any molecule properties are lost.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_stereo</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Toggles inclusion of stereochemical information in the output.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>conf_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Selects which conformation to output.</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>kekulize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Triggers kekulization of the molecule before it's written,
as suggested by the MDL spec.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>force_V3000</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Force generation a V3000 mol block (happens automatically
with more than 999 atoms or bonds).</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_molblock</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">include_stereo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">conf_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">kekulize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">force_V3000</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a molecule to a mol block string.</span>

<span class="sd">    Note that any molecule properties are lost.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: A molecule.</span>
<span class="sd">        include_stereo: Toggles inclusion of stereochemical information in the output.</span>
<span class="sd">        conf_id: Selects which conformation to output.</span>
<span class="sd">        kekulize: Triggers kekulization of the molecule before it&#39;s written,</span>
<span class="sd">            as suggested by the MDL spec.</span>
<span class="sd">        force_V3000: Force generation a V3000 mol block (happens automatically</span>
<span class="sd">            with more than 999 atoms or bonds).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">molblock</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">MolToMolBlock</span><span class="p">(</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">includeStereo</span><span class="o">=</span><span class="n">include_stereo</span><span class="p">,</span>
        <span class="n">confId</span><span class="o">=</span><span class="n">conf_id</span><span class="p">,</span>
        <span class="n">kekulize</span><span class="o">=</span><span class="n">kekulize</span><span class="p">,</span>
        <span class="n">forceV3000</span><span class="o">=</span><span class="n">force_V3000</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">molblock</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.to_sdf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_sdf</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.io.to_sdf" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Write molecules to a file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="datamol.types.Mol">Mol</span>, <span title="typing.Sequence">Sequence</span>[<span title="datamol.types.Mol">Mol</span>], <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td><p>a dataframe, a molecule or a list of molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>, <span title="typing.IO">IO</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Column name to extract the molecule.</p></td>
          <td>
                <code>&#39;smiles&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Column name to extract the molecule. It takes
precedence over <code>smiles_column</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_sdf</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mol</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">IO</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write molecules to a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a dataframe, a molecule or a list of molecule.</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        smiles_column: Column name to extract the molecule.</span>
<span class="sd">        mol_column: Column name to extract the molecule. It takes</span>
<span class="sd">            precedence over `smiles_column`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">]</span>

    <span class="c1"># Filter out None values</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SDWriter</span><span class="p">(</span><span class="n">urlpath</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SDWriter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.to_smi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_smi</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">error_if_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.io.to_smi" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Save a list of molecules in an <code>.smi</code> file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>, <span title="typing.IO">IO</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>error_if_empty</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to raise and error if the input list is empty.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_smi</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="n">IO</span><span class="p">],</span>
    <span class="n">error_if_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a list of molecules in an `.smi` file.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        error_if_empty: whether to raise and error if the input list is empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">error_if_empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The list of mols/smiles provided is empty.&quot;</span><span class="p">)</span>

    <span class="c1"># Filter out None values</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="c1"># File-like object</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SmilesWriter</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">includeHeader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nameHeader</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Regular local or remote paths</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">SmilesWriter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">includeHeader</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nameHeader</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">:</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.io.to_xlsx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_xlsx</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">urlpath</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">,</span> <span class="n">mol_size</span><span class="o">=</span><span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span></code>

<a href="#datamol.io.to_xlsx" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Write molecules to an Excel file with a molecule column as an RDKit rendered
image.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="datamol.types.Mol">Mol</span>, <span title="typing.Sequence">Sequence</span>[<span title="datamol.types.Mol">Mol</span>], <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td><p>a dataframe, a molecule or a list of molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>urlpath</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]</code>
          </td>
          <td><p>Path to a file or a file-like object. Path can be remote or local.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Column name to extract the molecule.</p></td>
          <td>
                <code>&#39;smiles&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Column name to extract the molecule. It takes
precedence over <code>smiles_column</code>.
Column name to write the RDKit rendered image. If none,
the molecule images are not written.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/io.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_xlsx</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Mol</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
    <span class="n">urlpath</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">,</span>
    <span class="n">mol_size</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write molecules to an Excel file with a molecule column as an RDKit rendered</span>
<span class="sd">    image.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a dataframe, a molecule or a list of molecule.</span>
<span class="sd">        urlpath: Path to a file or a file-like object. Path can be remote or local.</span>
<span class="sd">        smiles_column: Column name to extract the molecule.</span>
<span class="sd">        mol_column: Column name to extract the molecule. It takes</span>
<span class="sd">            precedence over `smiles_column`.</span>
<span class="sd">            Column name to write the RDKit rendered image. If none,</span>
<span class="sd">            the molecule images are not written.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span> <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">mols</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="n">smiles_column</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mols</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mols</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No molecules to write&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">urlpath</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">PandasTools</span><span class="o">.</span><span class="n">SaveXlsxFromFrame</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">molCol</span><span class="o">=</span><span class="n">mol_column</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">mol_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-convert">Module <code>convert</code><a class="headerlink" href="#module-convert" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.convert" class="doc doc-heading">
          <code>convert</code>


<a href="#datamol.convert" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.convert.from_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conserve_smiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.convert.from_df" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a dataframe to a list of mols.</p>
<p>For the reverse operation, you might to check <code>dm.to_df()</code>.</p>

<details class="note">
  <summary>Note</summary>
  <p>If <code>smiles_column</code> is used to build the molecules, this property
is removed from the molecules' properties. You can decide to conserve
the SMILES column by setting <code>conserve_smiles</code> to True.</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>a dataframe.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Column name to extract the molecule.</p></td>
          <td>
                <code>&#39;smiles&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Column name to extract the molecule. It takes
precedence over <code>smiles_column</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_smiles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to conserve the SMILES in the mols' props.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to sanitize if <code>smiles_column</code> is not None.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">conserve_smiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a dataframe to a list of mols.</span>

<span class="sd">    For the reverse operation, you might to check `dm.to_df()`.</span>

<span class="sd">    Note:</span>
<span class="sd">        If `smiles_column` is used to build the molecules, this property</span>
<span class="sd">        is removed from the molecules&#39; properties. You can decide to conserve</span>
<span class="sd">        the SMILES column by setting `conserve_smiles` to True.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: a dataframe.</span>
<span class="sd">        smiles_column: Column name to extract the molecule.</span>
<span class="sd">        mol_column: Column name to extract the molecule. It takes</span>
<span class="sd">            precedence over `smiles_column`.</span>
<span class="sd">        conserve_smiles: Whether to conserve the SMILES in the mols&#39; props.</span>
<span class="sd">        sanitize: Whether to sanitize if `smiles_column` is not None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either `smiles_column` or `mol_column` must be not None.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># Try to detect the mol column if `mol_column` is None.</span>
    <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Mol</span><span class="p">):</span>
                <span class="n">mol_column</span> <span class="o">=</span> <span class="n">col</span>

    <span class="k">def</span> <span class="nf">_row_to_mol</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">mol_column</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">conserve_smiles</span><span class="p">:</span>
                <span class="n">smiles</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If a SMILES column is used to create the molecule then it is removed from the</span>
                <span class="c1"># properties.</span>
                <span class="n">smiles</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">smiles_column</span><span class="p">)</span>

            <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">dm</span><span class="o">.</span><span class="n">set_mol_props</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_row_to_mol</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.from_inchi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_inchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.convert.from_inchi" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert an InChi to a mol.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inchi</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>an inchi string.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sanitize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>do sanitize.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>do remove hs.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>mol</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_inchi</span><span class="p">(</span>
    <span class="n">inchi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert an InChi to a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        inchi: an inchi string.</span>
<span class="sd">        sanitize: do sanitize.</span>
<span class="sd">        remove_hs: do remove hs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">inchi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromInchi</span><span class="p">(</span><span class="n">inchi</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span> <span class="n">removeHs</span><span class="o">=</span><span class="n">remove_hs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.from_selfies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_selfies</span><span class="p">(</span><span class="n">selfies</span><span class="p">,</span> <span class="n">as_mol</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.convert.from_selfies" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a SEFLIES to a smiles or a mol.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>selfies</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a selfies.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>as_mol</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>whether to return a mol or a smiles.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]]</code>
          </td>
          <td><p>smiles or mol.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_selfies</span><span class="p">(</span><span class="n">selfies</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">as_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a SEFLIES to a smiles or a mol.</span>

<span class="sd">    Args:</span>
<span class="sd">        selfies: a selfies.</span>
<span class="sd">        as_mol (str, optional): whether to return a mol or a smiles.</span>

<span class="sd">    Returns:</span>
<span class="sd">        smiles or mol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">selfies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">selfies</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">as_mol</span> <span class="ow">and</span> <span class="n">smiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.from_smarts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_smarts</span><span class="p">(</span><span class="n">smarts</span><span class="p">)</span></code>

<a href="#datamol.convert.from_smarts" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a SMARTS string to a molecule</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>smarts</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>a smarts string</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">from_smarts</span><span class="p">(</span><span class="n">smarts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a SMARTS string to a molecule</span>

<span class="sd">    Args:</span>
<span class="sd">        smarts: a smarts string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">smarts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">smarts</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.render_mol_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">render_mol_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

<a href="#datamol.convert.render_mol_df" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Render the molecules column in a dataframe. The rendering is performed
in-place only. So nothing is returned.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>a dataframe.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">render_mol_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Render the molecules column in a dataframe. The rendering is performed</span>
<span class="sd">    in-place only. So nothing is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: a dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE(hadim): replace by `PandaTools.ChangeMoleculeRendering` once</span>
    <span class="c1"># https://github.com/rdkit/rdkit/issues/3563 is fixed.</span>
    <span class="n">_ChangeMoleculeRendering</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.smiles_as_smarts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">smiles_as_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">keep_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.convert.smiles_as_smarts" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a smiles to a smarts if possible</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>keep_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to keep hydrogen. This will increase the count of H atoms
for atoms with attached hydrogens to create a valid smarts without further substitution allowed
e.g. [H]-[CH]-[<em>] -&gt; [H]-[CH2]-[</em>]</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>smarts of the molecule</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">smiles_as_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">],</span> <span class="n">keep_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a smiles to a smarts if possible</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        keep_hs: Whether to keep hydrogen. This will increase the count of H atoms</span>
<span class="sd">            for atoms with attached hydrogens to create a valid smarts without further substitution allowed</span>
<span class="sd">            e.g. [H]-[CH]-[*] -&gt; [H]-[CH2]-[*]</span>

<span class="sd">    Returns:</span>
<span class="sd">        smarts of the molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Change the isotope to 99</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">keep_hs</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">na</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">na</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetNeighbors</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">SetNumExplicitHs</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">SetIsotope</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>

    <span class="c1"># Print out the smiles, all the atom attributes will be fully specified</span>
    <span class="n">smarts</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">explicit_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smarts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Remove the 99 isotope labels</span>
    <span class="n">smarts</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[99&quot;</span><span class="p">,</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="n">smarts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">smarts</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_df</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="s1">&#39;smiles&#39;</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_computed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">render_df_mol</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">render_all_df_mol</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.convert.to_df" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a list of mols to a dataframe using each mol properties
as a column.</p>
<p>For the reverse operation, you might to check <code>dm.from_df()</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>name of the SMILES column.</p></td>
          <td>
                <code>&#39;smiles&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Name of the column. If not None, rdkit.Chem.PandaTools
is used to add a molecule column.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>include_private</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include private properties in the columns.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>include_computed</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Include computed properties in the columns.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>render_df_mol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to render the molecule in the dataframe to images.
If called once, it will be applied for the newly created dataframe with
mol in it.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>render_all_df_mol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to render all pandas dataframe mol column as images.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">smiles_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
    <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_private</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">include_computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">render_df_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">render_all_df_mol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a list of mols to a dataframe using each mol properties</span>
<span class="sd">    as a column.</span>

<span class="sd">    For the reverse operation, you might to check `dm.from_df()`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a molecule.</span>
<span class="sd">        smiles_column: name of the SMILES column.</span>
<span class="sd">        mol_column: Name of the column. If not None, rdkit.Chem.PandaTools</span>
<span class="sd">            is used to add a molecule column.</span>
<span class="sd">        include_private: Include private properties in the columns.</span>
<span class="sd">        include_computed: Include computed properties in the columns.</span>
<span class="sd">        render_df_mol: whether to render the molecule in the dataframe to images.</span>
<span class="sd">            If called once, it will be applied for the newly created dataframe with</span>
<span class="sd">            mol in it.</span>
<span class="sd">        render_all_df_mol: Whether to render all pandas dataframe mol column as images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Init a dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Feed it with smiles</span>
    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="n">smiles_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">smiles</span>

    <span class="c1"># Add a mol column</span>
    <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">mol_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">mols</span>

    <span class="c1"># Add any other properties present in the molecule</span>
    <span class="n">props</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span>
            <span class="n">includePrivate</span><span class="o">=</span><span class="n">include_private</span><span class="p">,</span>
            <span class="n">includeComputed</span><span class="o">=</span><span class="n">include_computed</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">mols</span>
    <span class="p">]</span>
    <span class="n">props_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">smiles_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">smiles_column</span> <span class="ow">in</span> <span class="n">props_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The SMILES column name provided (&#39;</span><span class="si">{</span><span class="n">smiles_column</span><span class="si">}</span><span class="s2">&#39;) is already present in the properties&quot;</span>
            <span class="s2">&quot; of the molecules. THe returned dataframe will two columns with the same name.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Concat the df with the properties df</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">props_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Render mol column to images</span>
    <span class="k">if</span> <span class="n">render_df_mol</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">render_mol_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">render_all_df_mol</span><span class="p">:</span>
            <span class="n">PandasTools</span><span class="o">.</span><span class="n">RenderImagesInAllDataFrames</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_inchi" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_inchi</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.convert.to_inchi" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to a standard Inchi.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchi</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a standard Inchi.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">inchi_val</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchi</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inchi_val</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">inchi_val</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_inchi_non_standard" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_inchi_non_standard</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">fixed_hydrogen_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">undefined_stereocenter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reconnected_metal_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tautomerism_keto_enol</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tautomerism_15</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.convert.to_inchi_non_standard" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to a non-standard Inchi.</p>
<p>Note that turning all the flags to <code>False</code> will result in the standard Inchi.</p>
<p><strong>Warning</strong>: this function will return a <strong>non-standard</strong> Inchi. See
<a href="https://www.inchi-trust.org/technical-faq-2">https://www.inchi-trust.org/technical-faq-2</a> for details.</p>
<p>It's important to not mix standard and non-standard InChi. If you don't know
much about non-standard InChi, we highly recommend you to use the
standard InChi with <code>dm.to_inchi()</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fixed_hydrogen_layer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include a fixed hydrogen layer (<code>/FixedH</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>undefined_stereocenter</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include an undefined stereocenter layer (<code>/SUU</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>reconnected_metal_layer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include reconnected metals (<code>/RecMet</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>tautomerism_keto_enol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to account tautomerism keto-enol (<code>/KET</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>tautomerism_15</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to account 1,5-tautomerism (<code>/15T</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>options</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td><p>More InchI options in a form of a list of string. Example:
<code>["/SRel", "/AuxNone"]</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchi_non_standard</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">],</span>
    <span class="n">fixed_hydrogen_layer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">undefined_stereocenter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reconnected_metal_layer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">tautomerism_keto_enol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">tautomerism_15</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a non-standard Inchi.</span>

<span class="sd">    Note that turning all the flags to `False` will result in the standard Inchi.</span>

<span class="sd">    **Warning**: this function will return a **non-standard** Inchi. See</span>
<span class="sd">    https://www.inchi-trust.org/technical-faq-2 for details.</span>

<span class="sd">    It&#39;s important to not mix standard and non-standard InChi. If you don&#39;t know</span>
<span class="sd">    much about non-standard InChi, we highly recommend you to use the</span>
<span class="sd">    standard InChi with `dm.to_inchi()`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        fixed_hydrogen_layer: whether to include a fixed hydrogen layer (`/FixedH`).</span>
<span class="sd">        undefined_stereocenter: whether to include an undefined stereocenter layer (`/SUU`).</span>
<span class="sd">        reconnected_metal_layer: whether to include reconnected metals (`/RecMet`).</span>
<span class="sd">        tautomerism_keto_enol: whether to account tautomerism keto-enol (`/KET`).</span>
<span class="sd">        tautomerism_15: whether to account 1,5-tautomerism (`/15T`).</span>
<span class="sd">        options: More InchI options in a form of a list of string. Example:</span>
<span class="sd">            `[&quot;/SRel&quot;, &quot;/AuxNone&quot;]`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">inchi_options</span> <span class="o">=</span> <span class="n">_process_inchi_options</span><span class="p">(</span>
        <span class="n">fixed_hydrogen_layer</span><span class="o">=</span><span class="n">fixed_hydrogen_layer</span><span class="p">,</span>
        <span class="n">undefined_stereocenter</span><span class="o">=</span><span class="n">undefined_stereocenter</span><span class="p">,</span>
        <span class="n">reconnected_metal_layer</span><span class="o">=</span><span class="n">reconnected_metal_layer</span><span class="p">,</span>
        <span class="n">tautomerism_keto_enol</span><span class="o">=</span><span class="n">tautomerism_keto_enol</span><span class="p">,</span>
        <span class="n">tautomerism_15</span><span class="o">=</span><span class="n">tautomerism_15</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">inchi_val</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchi</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">inchi_options</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inchi_val</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">inchi_val</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_inchikey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_inchikey</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.convert.to_inchikey" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to a standard InchiKey.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchikey</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a standard InchiKey.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">inchikey</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchiKey</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inchikey</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">inchikey</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_inchikey_non_standard" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_inchikey_non_standard</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">fixed_hydrogen_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">undefined_stereocenter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reconnected_metal_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tautomerism_keto_enol</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tautomerism_15</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.convert.to_inchikey_non_standard" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to a non-standard InchiKey.</p>
<p>Note that turning all the flags to <code>False</code> will result in the standard InchiKey.</p>
<p><strong>Warning</strong>: this function will return a <strong>non-standard</strong> InchiKey. See
<a href="https://www.inchi-trust.org/technical-faq-2">https://www.inchi-trust.org/technical-faq-2</a> for details.</p>
<p>It's important to not mix standard and non-standard InChiKey. If you don't know
much about non-standard InchiKey, we highly recommend you to use the
standard InchiKey with <code>dm.to_inchikey()</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fixed_hydrogen_layer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include a fixed hydrogen layer (<code>/FixedH</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>undefined_stereocenter</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include an undefined stereocenter layer (<code>/SUU</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>reconnected_metal_layer</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include reconnected metals (<code>/RecMet</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>tautomerism_keto_enol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to account tautomerism keto-enol (<code>/KET</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>tautomerism_15</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to account 1,5-tautomerism (<code>/15T</code>).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>options</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td><p>More InchI options in a form of a list of string. Example:
<code>["/SRel", "/AuxNone"]</code>.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_inchikey_non_standard</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">],</span>
    <span class="n">fixed_hydrogen_layer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">undefined_stereocenter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">reconnected_metal_layer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">tautomerism_keto_enol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">tautomerism_15</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a non-standard InchiKey.</span>

<span class="sd">    Note that turning all the flags to `False` will result in the standard InchiKey.</span>

<span class="sd">    **Warning**: this function will return a **non-standard** InchiKey. See</span>
<span class="sd">    https://www.inchi-trust.org/technical-faq-2 for details.</span>

<span class="sd">    It&#39;s important to not mix standard and non-standard InChiKey. If you don&#39;t know</span>
<span class="sd">    much about non-standard InchiKey, we highly recommend you to use the</span>
<span class="sd">    standard InchiKey with `dm.to_inchikey()`.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule</span>
<span class="sd">        fixed_hydrogen_layer: whether to include a fixed hydrogen layer (`/FixedH`).</span>
<span class="sd">        undefined_stereocenter: whether to include an undefined stereocenter layer (`/SUU`).</span>
<span class="sd">        reconnected_metal_layer: whether to include reconnected metals (`/RecMet`).</span>
<span class="sd">        tautomerism_keto_enol: whether to account tautomerism keto-enol (`/KET`).</span>
<span class="sd">        tautomerism_15: whether to account 1,5-tautomerism (`/15T`).</span>
<span class="sd">        options: More InchI options in a form of a list of string. Example:</span>
<span class="sd">            `[&quot;/SRel&quot;, &quot;/AuxNone&quot;]`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">inchi_options</span> <span class="o">=</span> <span class="n">_process_inchi_options</span><span class="p">(</span>
        <span class="n">fixed_hydrogen_layer</span><span class="o">=</span><span class="n">fixed_hydrogen_layer</span><span class="p">,</span>
        <span class="n">undefined_stereocenter</span><span class="o">=</span><span class="n">undefined_stereocenter</span><span class="p">,</span>
        <span class="n">reconnected_metal_layer</span><span class="o">=</span><span class="n">reconnected_metal_layer</span><span class="p">,</span>
        <span class="n">tautomerism_keto_enol</span><span class="o">=</span><span class="n">tautomerism_keto_enol</span><span class="p">,</span>
        <span class="n">tautomerism_15</span><span class="o">=</span><span class="n">tautomerism_15</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">inchikey</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToInchiKey</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">inchi_options</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inchikey</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">inchikey</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_selfies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_selfies</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.convert.to_selfies" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to SELFIES.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule or a SMILES.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>selfies</code></td>          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>SELFIES string.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_selfies</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Mol</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to SELFIES.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule or a SMILES.</span>

<span class="sd">    Returns:</span>
<span class="sd">        selfies: SELFIES string.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">selfies</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">selfies</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">selfies</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_smarts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.convert.to_smarts" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to SMARTS format</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_smarts</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to SMARTS format</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmarts</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.convert.to_smiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kekulize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_bonds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explicit_hs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cxsmiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_to_fail</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.convert.to_smiles" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a mol to a SMILES.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol.types.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>canonical</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if false no attempt will be made to canonicalize the molecule.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>isomeric</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to include information about stereochemistry in the SMILES.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kekulize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to return the kekule version of the SMILES.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to force reordering of the atoms first.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>explicit_bonds</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if true, all bond orders will be explicitly indicated in the output SMILES.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>explicit_hs</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if true, all H counts will be explicitly indicated in the output SMILES.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>randomize</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to randomize the generated smiles. Override <code>canonical</code>.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>cxsmiles</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a CXSMILES instead of a SMILES.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>allow_to_fail</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Raise an error if the conversion to SMILES fails. Return None otherwise.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/convert.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_smiles</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Mol</span><span class="p">,</span>
    <span class="n">canonical</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">isomeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kekulize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_bonds</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">explicit_hs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">randomize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cxsmiles</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">allow_to_fail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert a mol to a SMILES.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        canonical: if false no attempt will be made to canonicalize the molecule.</span>
<span class="sd">        isomeric: whether to include information about stereochemistry in the SMILES.</span>
<span class="sd">        kekulize: whether to return the kekule version of the SMILES.</span>
<span class="sd">        ordered: whether to force reordering of the atoms first.</span>
<span class="sd">        explicit_bonds: if true, all bond orders will be explicitly indicated in the output SMILES.</span>
<span class="sd">        explicit_hs: if true, all H counts will be explicitly indicated in the output SMILES.</span>
<span class="sd">        randomize: whether to randomize the generated smiles. Override `canonical`.</span>
<span class="sd">        cxsmiles: Whether to return a CXSMILES instead of a SMILES.</span>
<span class="sd">        allow_to_fail: Raise an error if the conversion to SMILES fails. Return None otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ordered</span> <span class="ow">and</span> <span class="n">canonical</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">reorder_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">randomize</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">randomize_atoms</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">canonical</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">cxsmiles</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">MolToCXSmiles</span><span class="p">(</span>
                <span class="n">mol</span><span class="p">,</span>
                <span class="n">isomericSmiles</span><span class="o">=</span><span class="n">isomeric</span><span class="p">,</span>
                <span class="n">canonical</span><span class="o">=</span><span class="n">canonical</span><span class="p">,</span>
                <span class="n">allBondsExplicit</span><span class="o">=</span><span class="n">explicit_bonds</span><span class="p">,</span>
                <span class="n">allHsExplicit</span><span class="o">=</span><span class="n">explicit_hs</span><span class="p">,</span>
                <span class="n">kekuleSmiles</span><span class="o">=</span><span class="n">kekulize</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">smiles</span> <span class="o">=</span> <span class="n">rdmolfiles</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span>
                <span class="n">mol</span><span class="p">,</span>
                <span class="n">isomericSmiles</span><span class="o">=</span><span class="n">isomeric</span><span class="p">,</span>
                <span class="n">canonical</span><span class="o">=</span><span class="n">canonical</span><span class="p">,</span>
                <span class="n">allBondsExplicit</span><span class="o">=</span><span class="n">explicit_bonds</span><span class="p">,</span>
                <span class="n">allHsExplicit</span><span class="o">=</span><span class="n">explicit_hs</span><span class="p">,</span>
                <span class="n">kekuleSmiles</span><span class="o">=</span><span class="n">kekulize</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">allow_to_fail</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">smiles</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-cluster">Module <code>cluster</code><a class="headerlink" href="#module-cluster" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.cluster" class="doc doc-heading">
          <code>cluster</code>


<a href="#datamol.cluster" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.cluster.assign_to_centroids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">assign_to_centroids</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#datamol.cluster.assign_to_centroids" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Assign molecules to centroids. Each molecule will be assigned to the closest centroid.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules to assign to centroids</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>centroids</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>list of molecules to use as centroid</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>feature_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A feature function that takes a Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dist_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>clusters_map</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>dict of index mapping each centroid index to the molecule index in the cluster</p></td>
        </tr>
        <tr>
<td><code>clusters_list</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>list of all molecules in each cluster. The cluster index follows the index of the centroid.
Note that the centroid molecule is not added to the cluster.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/cluster.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assign_to_centroids</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">centroids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Assign molecules to centroids. Each molecule will be assigned to the closest centroid.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules to assign to centroids</span>
<span class="sd">        centroids: list of molecules to use as centroid</span>
<span class="sd">        feature_fn: A feature function that takes a Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        clusters_map: dict of index mapping each centroid index to the molecule index in the cluster</span>
<span class="sd">        clusters_list: list of all molecules in each cluster. The cluster index follows the index of the centroid.</span>
<span class="sd">            Note that the centroid molecule is not added to the cluster.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">all_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mols</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">]</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">all_mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">cDataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span> <span class="n">features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">clusters_map</span> <span class="o">=</span> <span class="n">ddict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">clusters_list</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">]</span>
    <span class="n">query_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">centroid_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centroids</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">query_inds</span><span class="p">,</span> <span class="n">centroid_inds</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">distij</span><span class="p">)</span>
    <span class="n">closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">cluster_ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">closest</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
        <span class="n">clusters_map</span><span class="p">[</span><span class="n">cluster_ind</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">clusters_list</span><span class="p">[</span><span class="n">cluster_ind</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">clusters_map</span><span class="p">,</span> <span class="n">clusters_list</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.cluster.cluster_mols" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cluster_mols</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#datamol.cluster.cluster_mols" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Cluster a set of molecules using the butina clustering algorithm and a given threshold.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Sequence">Sequence</span>[<span title="datamol.types.Mol">Mol</span>], <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Cuttoff for the clustering. Default to 0.2.</p></td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>feature_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A feature function that takes a Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/cluster.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cluster_mols</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span>
    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cluster a set of molecules using the butina clustering algorithm and a given threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        cutoff: Cuttoff for the clustering. Default to 0.2.</span>
<span class="sd">        feature_fn: A feature function that takes a Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="n">dists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_mols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">cDataStructs</span><span class="o">.</span><span class="n">BulkTanimotoSimilarity</span><span class="p">(</span>
            <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">returnDistance</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">dists</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">])</span>

    <span class="c1"># now cluster the data</span>
    <span class="n">cluster_indices</span> <span class="o">=</span> <span class="n">Butina</span><span class="o">.</span><span class="n">ClusterData</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">isDistData</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cluster_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">cluster</span><span class="p">)(</span><span class="n">mols</span><span class="p">)</span> <span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="n">cluster_indices</span><span class="p">]</span>

    <span class="c1"># Make single mol cluster a list</span>
    <span class="n">cluster_mols</span> <span class="o">=</span> <span class="p">[[</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Mol</span><span class="p">)</span> <span class="k">else</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_mols</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cluster_indices</span><span class="p">,</span> <span class="n">cluster_mols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.cluster.pick_centroids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pick_centroids</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">npick</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">initial_picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;sphere&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#datamol.cluster.pick_centroids" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Pick a set of <code>npick</code> centroids from a list of molecules.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>npick</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of element to pick from mols, including the preselection.</p></td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Minimum distance between centroids for <code>maxmin</code> and sphere exclusion (<code>sphere</code>) methods.</p></td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>initial_picks</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td><p>Starting list of index for molecules that should be in the
set of picked molecules. Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>feature_fn</code></td>
          <td>
                <code>callable</code>
          </td>
          <td><p>A feature function that takes a Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dist_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>seed for reproducibility</p></td>
          <td>
                <code>42</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Picking method to use. One of  <code>sphere</code>, <code>maxmin</code> or any
supported rdkit hierarchical clustering method such as <code>centroid</code>, <code>clink</code>, <code>upgma</code></p></td>
          <td>
                <code>&#39;sphere&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>picked_inds</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>index of the molecule that have been selected as centroids</p></td>
        </tr>
        <tr>
<td><code>mols</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>molecules that have been picked</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/cluster.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pick_centroids</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">npick</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">initial_picks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Pick a set of `npick` centroids from a list of molecules.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        npick: Number of element to pick from mols, including the preselection.</span>
<span class="sd">        threshold: Minimum distance between centroids for `maxmin` and sphere exclusion (`sphere`) methods.</span>
<span class="sd">        initial_picks: Starting list of index for molecules that should be in the</span>
<span class="sd">            set of picked molecules. Default to None.</span>
<span class="sd">        feature_fn (callable, optional): A feature function that takes a Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        seed: seed for reproducibility</span>
<span class="sd">        method: Picking method to use. One of  `sphere`, `maxmin` or any</span>
<span class="sd">            supported rdkit hierarchical clustering method such as `centroid`, `clink`, `upgma`</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        picked_inds: index of the molecule that have been selected as centroids</span>
<span class="sd">        mols: molecules that have been picked</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_mols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">cDataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">initial_picks</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">initial_picks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">initial_picks</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;maxmin&quot;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">MaxMinPicker</span><span class="p">()</span>
        <span class="n">picked_inds</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPickWithThreshold</span><span class="p">(</span>
            <span class="n">dist_fn</span><span class="p">,</span>
            <span class="n">n_mols</span><span class="p">,</span>
            <span class="n">pickSize</span><span class="o">=</span><span class="n">npick</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;sphere&quot;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">LeaderPicker</span><span class="p">()</span>
        <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPick</span><span class="p">(</span>
            <span class="n">dist_fn</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">pickSize</span><span class="o">=</span><span class="n">npick</span><span class="p">,</span> <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ClusterMethod</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">npick</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">initial_picks</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Initial picks is not supported by hierarchical clustering. You pick has been discarded.&quot;</span>
            <span class="p">)</span>

        <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
            <span class="n">distij</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">))),</span> <span class="n">arg_type</span><span class="o">=</span><span class="s2">&quot;args&quot;</span>
        <span class="p">)</span>
        <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">)</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">HierarchicalClusterPicker</span><span class="p">(</span><span class="n">ClusterMethod</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
        <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">n_mols</span><span class="p">,</span> <span class="n">npick</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Picking method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">npick</span><span class="si">}</span><span class="s2"> elements to pick is not supported.&quot;</span><span class="p">)</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picked_inds</span><span class="p">)</span>
    <span class="n">picked_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">picked_inds</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">picked_inds</span><span class="p">,</span> <span class="n">picked_mols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.cluster.pick_diverse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pick_diverse</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">npick</span><span class="p">,</span> <span class="n">initial_picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feature_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#datamol.cluster.pick_diverse" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Pick a set of diverse molecules based on they fingerprint.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="datamol.types.Mol">Mol</span>]</code>
          </td>
          <td><p>a list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>npick</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of element to pick from mols, including the preselection.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_picks</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td><p>Starting list of index for molecules that should be in the
set of picked molecules. Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>feature_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A feature function that takes a Mol object
and return molecular features. By default, the <code>dm.to_fp()</code> is used.
Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dist_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>A function that takes two indexes (i,j) and return the
distance between them. You might use partial to set the fingerprints as input.
By default, the Tanimoto similarity will be used. Default to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>seed for reproducibility</p></td>
          <td>
                <code>42</code>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>picked_inds</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>index of the molecule that have been picked</p></td>
        </tr>
        <tr>
<td><code>mols</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>molecules that have been picked</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/cluster.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pick_diverse</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">npick</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">initial_picks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">feature_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dist_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Pick a set of diverse molecules based on they fingerprint.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: a list of molecules.</span>
<span class="sd">        npick: Number of element to pick from mols, including the preselection.</span>
<span class="sd">        initial_picks: Starting list of index for molecules that should be in the</span>
<span class="sd">            set of picked molecules. Default to None.</span>
<span class="sd">        feature_fn: A feature function that takes a Mol object</span>
<span class="sd">            and return molecular features. By default, the `dm.to_fp()` is used.</span>
<span class="sd">            Default to None.</span>
<span class="sd">        dist_fn: A function that takes two indexes (i,j) and return the</span>
<span class="sd">            distance between them. You might use partial to set the fingerprints as input.</span>
<span class="sd">            By default, the Tanimoto similarity will be used. Default to None.</span>
<span class="sd">        seed: seed for reproducibility</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>

<span class="sd">    Returns:</span>
<span class="sd">        picked_inds: index of the molecule that have been picked</span>
<span class="sd">        mols: molecules that have been picked</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">feature_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_fn</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span><span class="n">feature_fn</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">distij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">cDataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">features</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">dist_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dist_fn</span> <span class="o">=</span> <span class="n">distij</span>

    <span class="n">picker</span> <span class="o">=</span> <span class="n">MaxMinPicker</span><span class="p">()</span>
    <span class="n">initial_picks</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">initial_picks</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">initial_picks</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">LazyPick</span><span class="p">(</span><span class="n">dist_fn</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mols</span><span class="p">),</span> <span class="n">npick</span><span class="p">,</span> <span class="n">firstPicks</span><span class="o">=</span><span class="n">initial_picks</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">picked_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picked_inds</span><span class="p">)</span>
    <span class="n">picked_mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">mols</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">picked_inds</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">picked_inds</span><span class="p">,</span> <span class="n">picked_mols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-fp">Module <code>fp</code><a class="headerlink" href="#module-fp" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.fp" class="doc doc-heading">
          <code>fp</code>


<a href="#datamol.fp" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.fp.fold_count_fp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fold_count_fp</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.fp.fold_count_fp" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Fast folding of a count fingerprint to the specified dimension.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fp</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="rdkit.DataStructs.cDataStructs.SparseBitVect">SparseBitVect</span>, <span title="rdkit.DataStructs.cDataStructs.ExplicitBitVect">ExplicitBitVect</span>]</code>
          </td>
          <td><p>A fingerprint.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The dimension of the folded array.</p></td>
          <td>
                <code>1024</code>
          </td>
        </tr>
        <tr>
          <td><code>binary</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to fold into a binary array or take use a count vector.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>folded</code></td>          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>returns folded array to the provided dimension.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/fp.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fold_count_fp</span><span class="p">(</span>
    <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">SparseBitVect</span><span class="p">,</span> <span class="n">ExplicitBitVect</span><span class="p">],</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">binary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fast folding of a count fingerprint to the specified dimension.</span>

<span class="sd">    Args:</span>
<span class="sd">        fp: A fingerprint.</span>
<span class="sd">        dim: The dimension of the folded array.</span>
<span class="sd">        binary: Whether to fold into a binary array or take use a count vector.</span>

<span class="sd">    Returns:</span>
<span class="sd">        folded: returns folded array to the provided dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">fp</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="n">UIntSparseIntVect</span><span class="p">,</span>
            <span class="n">IntSparseIntVect</span><span class="p">,</span>
            <span class="n">LongSparseIntVect</span><span class="p">,</span>
            <span class="n">ULongSparseIntVect</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">GetNonzeroElements</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">SparseBitVect</span><span class="p">):</span>
        <span class="n">on_bits</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">GetOnBits</span><span class="p">()</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">on_bits</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">on_bits</span><span class="p">))))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The fingerprint is of wrong type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># ON bits dict to (i, v)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">%</span> <span class="n">dim</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># Fold indices</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">dim</span>

    <span class="c1"># Create the folded fp</span>
    <span class="n">folded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">folded</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
        <span class="n">folded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">folded</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">folded</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.fp.fp_to_array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fp_to_array</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span></code>

<a href="#datamol.fp.fp_to_array" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert rdkit fingerprint to numpy array.</p>

<details class="note">
  <summary>Note</summary>
  <p>This implementation has shown to be faster than using <code>DataStructs.ConvertToNumpyArray</code>
by a factor of ~4. See <a href="https://github.com/rdkit/rdkit/discussions/3863">https://github.com/rdkit/rdkit/discussions/3863</a>.</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fp</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="rdkit.DataStructs.cDataStructs.SparseBitVect">SparseBitVect</span>, <span title="rdkit.DataStructs.cDataStructs.ExplicitBitVect">ExplicitBitVect</span>, <span title="rdkit.DataStructs.cDataStructs.UIntSparseIntVect">UIntSparseIntVect</span>]</code>
          </td>
          <td><p>The fingerprint.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/fp.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fp_to_array</span><span class="p">(</span>
    <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">SparseBitVect</span><span class="p">,</span> <span class="n">ExplicitBitVect</span><span class="p">,</span> <span class="n">UIntSparseIntVect</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert rdkit fingerprint to numpy array.</span>

<span class="sd">    Note:</span>
<span class="sd">        This implementation has shown to be faster than using `DataStructs.ConvertToNumpyArray`</span>
<span class="sd">        by a factor of ~4. See https://github.com/rdkit/rdkit/discussions/3863.</span>

<span class="sd">    Args:</span>
<span class="sd">        fp: The fingerprint.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">fp_out</span> <span class="o">=</span> <span class="n">fp</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">SparseBitVect</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">GetNumBits</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">on_bits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">GetOnBits</span><span class="p">())</span>
        <span class="n">tmp</span><span class="p">[</span><span class="n">on_bits</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">fp_out</span> <span class="o">=</span> <span class="n">tmp</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">ExplicitBitVect</span><span class="p">):</span>
        <span class="n">fp_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">ToBitString</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="s2">&quot;u1&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">fp</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="n">UIntSparseIntVect</span><span class="p">,</span>
            <span class="n">IntSparseIntVect</span><span class="p">,</span>
            <span class="n">LongSparseIntVect</span><span class="p">,</span>
            <span class="n">ULongSparseIntVect</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">GetLength</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">bit_idx</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">GetNonzeroElements</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span>
        <span class="n">tmp</span><span class="p">[</span><span class="n">bit_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="n">fp_out</span> <span class="o">=</span> <span class="n">tmp</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The fingerprint of type &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; is not supported. &quot;</span>
            <span class="s2">&quot;Please open a ticket at https://github.com/datamol-org/datamol/issues.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">fp_out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.fp.list_supported_fingerprints" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_supported_fingerprints</span><span class="p">()</span></code>

<a href="#datamol.fp.list_supported_fingerprints" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the supported fingerprints in datamol.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/fp.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_supported_fingerprints</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the supported fingerprints in datamol.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_FP_FUNCS</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.fp.to_fp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_fp</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fp_type</span><span class="o">=</span><span class="s1">&#39;ecfp&#39;</span><span class="p">,</span> <span class="n">fold_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span></code>

<a href="#datamol.fp.to_fp" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the molecular fingerprint given a molecule or a SMILES.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="rdkit.Chem">Chem</span>.<span title="rdkit.Chem.rdchem">rdchem</span>.<span title="Chem.rdchem.Mol">Mol</span>]</code>
          </td>
          <td><p>a molecule or a SMILES.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>as_array</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a numpy array of an RDKit vec. Default to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fp_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The type of the fingerprint. See <code>dm.list_supported_fingerprints()</code> for a
complete list.</p></td>
          <td>
                <code>&#39;ecfp&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>fold_size</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>If set, fold the fingerprint to the <code>fold_size</code>. If set, returned array is
always a numpy array.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**fp_args</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Arguments to build the fingerprint. Refer to the official RDKit documentation.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="rdkit.DataStructs.cDataStructs.SparseBitVect">SparseBitVect</span>, <span title="rdkit.DataStructs.cDataStructs.ExplicitBitVect">ExplicitBitVect</span>]]</code>
          </td>
          <td><p>A fingerprint vector or None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/fp.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_fp</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">],</span>
    <span class="n">as_array</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fp_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ecfp&quot;</span><span class="p">,</span>
    <span class="n">fold_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fp_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">SparseBitVect</span><span class="p">,</span> <span class="n">ExplicitBitVect</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Compute the molecular fingerprint given a molecule or a SMILES.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule or a SMILES.</span>
<span class="sd">        as_array: Whether to return a numpy array of an RDKit vec. Default to True.</span>
<span class="sd">        fp_type: The type of the fingerprint. See `dm.list_supported_fingerprints()` for a</span>
<span class="sd">            complete list.</span>
<span class="sd">        fold_size: If set, fold the fingerprint to the `fold_size`. If set, returned array is</span>
<span class="sd">            always a numpy array.</span>
<span class="sd">        **fp_args: Arguments to build the fingerprint. Refer to the official RDKit documentation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A fingerprint vector or None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get fp function</span>
    <span class="n">fp_func</span> <span class="o">=</span> <span class="n">_FP_FUNCS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fp_type</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fp_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The fingerprint &#39;</span><span class="si">{</span><span class="n">fp_type</span><span class="si">}</span><span class="s2">&#39; is not available. Use `dm.list_supported_fingerprints()` to &quot;</span>
            <span class="s2">&quot;get a complete list of the available fingerprints.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Convert input to mol if needed</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">mol_obj</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mol_obj</span> <span class="o">=</span> <span class="n">mol</span>

    <span class="k">if</span> <span class="n">mol_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;It seems like the input molecule &#39;</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">&#39; is invalid.&quot;</span><span class="p">)</span>

    <span class="n">mol</span> <span class="o">=</span> <span class="n">mol_obj</span>

    <span class="c1"># Insert default values.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">_FP_DEFAULT_ARGS</span><span class="p">[</span><span class="n">fp_type</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">fp_args</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Compute the fingerprint</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="n">fp_func</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span>

    <span class="c1"># Fold the fp if needed.</span>
    <span class="k">if</span> <span class="n">fold_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">fold_count_fp</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">fold_size</span><span class="p">)</span>

    <span class="c1"># Convert to a numpy array</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fold_size</span> <span class="ow">and</span> <span class="n">as_array</span><span class="p">:</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="n">fp_to_array</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fp</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-similarity">Module <code>similarity</code><a class="headerlink" href="#module-similarity" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.similarity" class="doc doc-heading">
          <code>similarity</code>


<a href="#datamol.similarity" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.similarity.cdist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cdist</span><span class="p">(</span><span class="n">mols1</span><span class="p">,</span> <span class="n">mols2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">distances_chunk</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distances_chunk_memory</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">distances_n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span></code>

<a href="#datamol.similarity.cdist" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the tanimoto distance between the fingerprints of each pair of
molecules of the two collections of inputs.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols1</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]]</code>
          </td>
          <td><p>list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mols2</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]]</code>
          </td>
          <td><p>list of molecules.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for fingerprint computation. Let to 1 for no
parallelization. Set to None or -1 to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>distances_chunk</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to use chunked computation.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>distances_chunk_memory</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Memory size in MB to use for chunked computation.</p></td>
          <td>
                <code>1024</code>
          </td>
        </tr>
        <tr>
          <td><code>distances_n_jobs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of jobs for parallelization.</p></td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>**fp_args</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>list of args to pass to <code>to_fp()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>distmat</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/similarity.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cdist</span><span class="p">(</span>
    <span class="n">mols1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]],</span>
    <span class="n">mols2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]],</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">distances_chunk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">distances_chunk_memory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">distances_n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fp_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute the tanimoto distance between the fingerprints of each pair of</span>
<span class="sd">    molecules of the two collections of inputs.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols1: list of molecules.</span>
<span class="sd">        mols2: list of molecules.</span>
<span class="sd">        n_jobs: Number of jobs for fingerprint computation. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None or -1 to use all available cores.</span>
<span class="sd">        distances_chunk: Whether to use chunked computation.</span>
<span class="sd">        distances_chunk_memory: Memory size in MB to use for chunked computation.</span>
<span class="sd">        distances_n_jobs: Number of jobs for parallelization.</span>
<span class="sd">        **fp_args: list of args to pass to `to_fp()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        distmat</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fps1</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols1</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fps2</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols2</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fps1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fps1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">fps2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fps2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">distances_chunk</span><span class="p">:</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">pairwise_distances_chunked</span><span class="p">(</span>
            <span class="n">fps1</span><span class="p">,</span>
            <span class="n">fps2</span><span class="p">,</span>
            <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;jaccard&quot;</span><span class="p">,</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="n">distances_n_jobs</span><span class="p">,</span>
            <span class="n">working_memory</span><span class="o">=</span><span class="n">distances_chunk_memory</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">]</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">fps1</span><span class="p">,</span> <span class="n">fps2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;jaccard&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">distances</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.similarity.pdist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pdist</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">squareform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">)</span></code>

<a href="#datamol.similarity.pdist" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute the pairwise tanimoto distance between the fingerprints of all the
molecules in the input set.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mols</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[str, <span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]]</code>
          </td>
          <td><p>list of molecules</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td><p>Number of jobs for parallelization. Let to 1 for no
parallelization. Set to None to use all available cores.</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>squareform</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return in square form (matrix) or in a condensed
form (1D vector).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>**fp_args</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>list of args to pass to <code>to_fp()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>dist_mat</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/similarity.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pdist</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]],</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">squareform</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">fp_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute the pairwise tanimoto distance between the fingerprints of all the</span>
<span class="sd">    molecules in the input set.</span>

<span class="sd">    Args:</span>
<span class="sd">        mols: list of molecules</span>
<span class="sd">        n_jobs: Number of jobs for parallelization. Let to 1 for no</span>
<span class="sd">            parallelization. Set to None to use all available cores.</span>
<span class="sd">        squareform: Whether to return in square form (matrix) or in a condensed</span>
<span class="sd">            form (1D vector).</span>
<span class="sd">        **fp_args: list of args to pass to `to_fp()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dist_mat</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">parallelized</span><span class="p">(</span>
        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_fp</span><span class="p">,</span> <span class="n">as_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fp_args</span><span class="p">),</span>
        <span class="n">mols</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>

    <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">pdist</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;jaccard&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">squareform</span><span class="p">:</span>
        <span class="n">dist_mat</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">squareform</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="s2">&quot;tomatrix&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist_mat</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-isomers">Module <code>isomers</code><a class="headerlink" href="#module-isomers" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.isomers" class="doc doc-heading">
          <code>isomers</code>


<a href="#datamol.isomers" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h2 id="module-data">Module <code>data</code><a class="headerlink" href="#module-data" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.data" class="doc doc-heading">
          <code>data</code>


<a href="#datamol.data" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.data.cdk2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cdk2</span><span class="p">(</span><span class="n">as_df</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">)</span></code>

<a href="#datamol.data.cdk2" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the RDKit CDK2 dataset from <code>RDConfig.RDDocsDir, 'Book/data/cdk2.sdf'</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>as_df</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a list mol or a pandas DataFrame.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Name of the mol column. Only relevant if <code>as_df</code> is True.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/data.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cdk2</span><span class="p">(</span><span class="n">as_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the RDKit CDK2 dataset from `RDConfig.RDDocsDir, &#39;Book/data/cdk2.sdf&#39;`.</span>

<span class="sd">    Args:</span>
<span class="sd">        as_df: Whether to return a list mol or a pandas DataFrame.</span>
<span class="sd">        mol_column: Name of the mol column. Only relevant if `as_df` is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;datamol&quot;</span><span class="p">,</span> <span class="s2">&quot;data/cdk2.sdf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">read_sdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="n">as_df</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.data.freesolv" class="doc doc-heading">
<code class="highlight language-python"><span class="n">freesolv</span><span class="p">()</span></code>

<a href="#datamol.data.freesolv" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the FreeSolv dataset as a dataframe.</p>
<p>The dataset contains 642 molecules and the following columns:
<code>['iupac', 'smiles', 'expt', 'calc']</code>.</p>

<details class="warning">
  <summary>Warning</summary>
  <p>This dataset is only meant to be used as a toy dataset for pedagogic and
testing purposes. <strong>It is not</strong> a dataset for benchmarking, analysis or
model training.</p>
</details>
      <details class="quote">
        <summary>Source code in <code>datamol/data.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">freesolv</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the FreeSolv dataset as a dataframe.</span>

<span class="sd">    The dataset contains 642 molecules and the following columns:</span>
<span class="sd">    `[&#39;iupac&#39;, &#39;smiles&#39;, &#39;expt&#39;, &#39;calc&#39;]`.</span>

<span class="sd">    Warning:</span>
<span class="sd">        This dataset is only meant to be used as a toy dataset for pedagogic and</span>
<span class="sd">        testing purposes. **It is not** a dataset for benchmarking, analysis or</span>
<span class="sd">        model training.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;datamol&quot;</span><span class="p">,</span> <span class="s2">&quot;data/freesolv.csv&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.data.solubility" class="doc doc-heading">
<code class="highlight language-python"><span class="n">solubility</span><span class="p">(</span><span class="n">as_df</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s1">&#39;mol&#39;</span><span class="p">)</span></code>

<a href="#datamol.data.solubility" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the RDKit solubility dataset from <code>RDConfig.RDDocsDir, 'Book/data/solubility.{train|test}.sdf'</code>.</p>
<p>The dataframe or the list of molecules with contain a <code>split</code> column, either <code>train</code> or <code>test</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>as_df</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to return a list mol or a pandas DataFrame.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_column</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>Name of the mol column. Only relevant if <code>as_df</code> is True.</p></td>
          <td>
                <code>&#39;mol&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/data.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">solubility</span><span class="p">(</span><span class="n">as_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mol&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the RDKit solubility dataset from `RDConfig.RDDocsDir, &#39;Book/data/solubility.{train|test}.sdf&#39;`.</span>

<span class="sd">    The dataframe or the list of molecules with contain a `split` column, either `train` or `test`.</span>

<span class="sd">    Args:</span>
<span class="sd">        as_df: Whether to return a list mol or a pandas DataFrame.</span>
<span class="sd">        mol_column: Name of the mol column. Only relevant if `as_df` is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;datamol&quot;</span><span class="p">,</span> <span class="s2">&quot;data/solubility.train.sdf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">read_sdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s2">&quot;mol&quot;</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;datamol&quot;</span><span class="p">,</span> <span class="s2">&quot;data/solubility.test.sdf&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">read_sdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">as_df</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="s2">&quot;mol&quot;</span><span class="p">,</span> <span class="n">smiles_column</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">train</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>

    <span class="n">train</span><span class="p">[</span><span class="s2">&quot;split&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
    <span class="n">test</span><span class="p">[</span><span class="s2">&quot;split&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>

    <span class="c1"># NOTE(hadim): LMAO RDkit consistency xD</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;SMILES&quot;</span><span class="p">:</span> <span class="s2">&quot;smiles&quot;</span><span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">as_df</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">mol_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mol&quot;</span><span class="p">])</span>

        <span class="n">render_mol_df</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">return</span> <span class="n">from_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mol_column</span><span class="o">=</span><span class="n">mol_column</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-log">Module <code>log</code><a class="headerlink" href="#module-log" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.log" class="doc doc-heading">
          <code>log</code>


<a href="#datamol.log" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="datamol.log.without_rdkit_log" class="doc doc-heading">
        <code>without_rdkit_log</code>


<a href="#datamol.log.without_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">

  
      <p>Context manager to disable RDKit logs. By default all logs are disabled.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datamol</span> <span class="k">as</span> <span class="nn">dm</span>

<span class="k">with</span> <span class="n">dm</span><span class="o">.</span><span class="n">without_rdkit_log</span><span class="p">():</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="s2">&quot;CCCCO&quot;</span><span class="p">)</span>  <span class="c1"># potential RDKit logs won&#39;t show</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>datamol/log.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">without_rdkit_log</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Context manager to disable RDKit logs. By default all logs are disabled.</span>

<span class="sd">    Example:</span>

<span class="sd">    ```python</span>
<span class="sd">    import datamol as dm</span>

<span class="sd">    with dm.without_rdkit_log():</span>
<span class="sd">        mol = dm.to_mol(&quot;CCCCO&quot;)  # potential RDKit logs won&#39;t show</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mute_errors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mute_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mute_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">enable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">enable</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">mute_errors</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">mute_warning</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">mute_info</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">mute_debug</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Get current log state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">previous_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_log_status</span><span class="p">()</span>

        <span class="c1"># Init the desired log state to apply during in the context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span><span class="p">[</span><span class="s2">&quot;rdApp.error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">mute_errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span><span class="p">[</span><span class="s2">&quot;rdApp.warning&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">mute_warning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span><span class="p">[</span><span class="s2">&quot;rdApp.debug&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">mute_debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span><span class="p">[</span><span class="s2">&quot;rdApp.info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">mute_info</span>

    <span class="k">def</span> <span class="nf">_get_log_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the current log status of RDKit logs.&quot;&quot;&quot;</span>
        <span class="n">log_status</span> <span class="o">=</span> <span class="n">rdBase</span><span class="o">.</span><span class="n">LogStatus</span><span class="p">()</span>
        <span class="n">log_status</span> <span class="o">=</span> <span class="p">{</span><span class="n">st</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">st</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">log_status</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)}</span>
        <span class="n">log_status</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;enabled&quot;</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">log_status</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="n">log_status</span>

    <span class="k">def</span> <span class="nf">_apply_log_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_status</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply an RDKit log status.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">log_status</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">rdBase</span><span class="o">.</span><span class="n">EnableLog</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rdBase</span><span class="o">.</span><span class="n">DisableLog</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_log_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desired_status</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_log_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_status</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="datamol.log.disable_rdkit_log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">disable_rdkit_log</span><span class="p">()</span></code>

<a href="#datamol.log.disable_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Disable all rdkit logs.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/log.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">disable_rdkit_log</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Disable all rdkit logs.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">log_level</span> <span class="ow">in</span> <span class="n">RDLogger</span><span class="o">.</span><span class="n">_levels</span><span class="p">:</span>
        <span class="n">rdBase</span><span class="o">.</span><span class="n">DisableLog</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.log.enable_rdkit_log" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enable_rdkit_log</span><span class="p">()</span></code>

<a href="#datamol.log.enable_rdkit_log" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Enable all rdkit logs.</p>

      <details class="quote">
        <summary>Source code in <code>datamol/log.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">enable_rdkit_log</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Enable all rdkit logs.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">log_level</span> <span class="ow">in</span> <span class="n">RDLogger</span><span class="o">.</span><span class="n">_levels</span><span class="p">:</span>
        <span class="n">rdBase</span><span class="o">.</span><span class="n">EnableLog</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-graph">Module <code>graph</code><a class="headerlink" href="#module-graph" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h3 id="datamol.graph" class="doc doc-heading">
          <code>graph</code>


<a href="#datamol.graph" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h4 id="datamol.graph.get_all_path_between" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_all_path_between</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">atom_idx_1</span><span class="p">,</span> <span class="n">atom_idx_2</span><span class="p">,</span> <span class="n">ignore_cycle_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.graph.get_all_path_between" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get all simple path between two atoms of a molecule</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>a molecule</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom_idx_1</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Atom index 1.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>atom_idx_2</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Atom index 2.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ignore_cycle_basis</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to ignore cycle basis.
Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td><p>list of path between two atoms.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/graph.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_path_between</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">atom_idx_1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">atom_idx_2</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_cycle_basis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get all simple path between two atoms of a molecule</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (dm.Mol): a molecule</span>
<span class="sd">        atom_idx_1 (int): Atom index 1.</span>
<span class="sd">        atom_idx_2 (int): Atom index 2.</span>
<span class="sd">        ignore_cycle_basis: Whether to ignore cycle basis.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of path between two atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">_get_networkx</span><span class="p">()</span>

    <span class="n">adj</span> <span class="o">=</span> <span class="n">GetAdjacencyMatrix</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">atom_idx_1</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">atom_idx_2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ignore_cycle_basis</span><span class="p">:</span>
        <span class="n">rings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">()]</span>
        <span class="n">final_path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">reject_path</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rings</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
                    <span class="n">reject_path</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">reject_path</span><span class="p">:</span>
                <span class="n">final_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">final_path</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.graph.match_molecular_graphs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">match_molecular_graphs</span><span class="p">(</span><span class="n">mol1</span><span class="p">,</span> <span class="n">mol2</span><span class="p">,</span> <span class="n">match_atoms_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atomic_num&#39;</span><span class="p">],</span> <span class="n">match_bonds_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bond_type&#39;</span><span class="p">])</span></code>

<a href="#datamol.graph.match_molecular_graphs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Match the node indices of 2 molecular graphs,
with optional usage of atomic number and edge type.</p>

<details class="note">
  <summary>Note</summary>
  <p>The matching fails if the hydrogens are implicit in one molecule,
but explicit in the other.</p>
</details>
<details class="note">
  <summary>Note</summary>
  <p>Explicit hydrogens might lead to too many matches, since for an atom with 2
hydrogens, they can be re-ordered in any way.</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol1</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mol2</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>A molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>match_atoms_on</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>Properties on which to match the atom types.
By default, it matches on the <code>'atomic_num'</code> property.
Empty list means that it does not consider atom features during matching.</p>
<p>Other properties are defined by the <code>datamol.graph.to_graph</code> function and include:
- atomic_num
- formal_charge
- chiral_tag
- hybridization
- num_explicit_hs
- implicit_valence
- degree
- symbol
- ring_atom
- is_aromatic</p></td>
          <td>
                <code>[&#39;atomic_num&#39;]</code>
          </td>
        </tr>
        <tr>
          <td><code>match_bonds_on</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>Properties on which to match the bond types.
Empty list means that it does not consider bond features during matching.
By default, it matches on the <code>'bond_type'</code> property.
No other properties are defined by the <code>datamol.graph.to_graph</code> function.</p></td>
          <td>
                <code>[&#39;bond_type&#39;]</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[int, int]]</code>
          </td>
          <td><p>A list of all matches dictionaries. In case of a single match, the list has len==1.</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[int, int]]</code>
          </td>
          <td><p>Each dictionary contains as key the indices of <code>mol1</code> and as value the corresponding</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[int, int]]</code>
          </td>
          <td><p>indices of <code>mol2</code>.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/graph.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">match_molecular_graphs</span><span class="p">(</span>
    <span class="n">mol1</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">mol2</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">match_atoms_on</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;atomic_num&quot;</span><span class="p">],</span>
    <span class="n">match_bonds_on</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bond_type&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Match the node indices of 2 molecular graphs,</span>
<span class="sd">    with optional usage of atomic number and edge type.</span>

<span class="sd">    Note:</span>
<span class="sd">        The matching fails if the hydrogens are implicit in one molecule,</span>
<span class="sd">        but explicit in the other.</span>

<span class="sd">    Note:</span>
<span class="sd">        Explicit hydrogens might lead to too many matches, since for an atom with 2</span>
<span class="sd">        hydrogens, they can be re-ordered in any way.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol1: A molecule.</span>
<span class="sd">        mol2: A molecule.</span>
<span class="sd">        match_atoms_on: Properties on which to match the atom types.</span>
<span class="sd">            By default, it matches on the `&#39;atomic_num&#39;` property.</span>
<span class="sd">            Empty list means that it does not consider atom features during matching.</span>

<span class="sd">            Other properties are defined by the `datamol.graph.to_graph` function and include:</span>
<span class="sd">            - atomic_num</span>
<span class="sd">            - formal_charge</span>
<span class="sd">            - chiral_tag</span>
<span class="sd">            - hybridization</span>
<span class="sd">            - num_explicit_hs</span>
<span class="sd">            - implicit_valence</span>
<span class="sd">            - degree</span>
<span class="sd">            - symbol</span>
<span class="sd">            - ring_atom</span>
<span class="sd">            - is_aromatic</span>

<span class="sd">        match_bonds_on: Properties on which to match the bond types.</span>
<span class="sd">            Empty list means that it does not consider bond features during matching.</span>
<span class="sd">            By default, it matches on the `&#39;bond_type&#39;` property.</span>
<span class="sd">            No other properties are defined by the `datamol.graph.to_graph` function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of all matches dictionaries. In case of a single match, the list has len==1.</span>
<span class="sd">        Each dictionary contains as key the indices of `mol1` and as value the corresponding</span>
<span class="sd">        indices of `mol2`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">_get_networkx</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">match_atoms_on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">match_atoms_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">match_atoms_on</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">match_bonds_on</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">match_bonds_on</span> <span class="o">=</span> <span class="p">[</span><span class="n">match_bonds_on</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">node_match_fn</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that matches the atomic number&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">node1</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">==</span> <span class="n">node2</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">match_atoms_on</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">edge_match_fn</span><span class="p">(</span><span class="n">edge1</span><span class="p">,</span> <span class="n">edge2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that matches the bond type&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">edge1</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">==</span> <span class="n">edge2</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">match_bonds_on</span><span class="p">])</span>

    <span class="c1"># Convert to networkx graph</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">to_graph</span><span class="p">(</span><span class="n">mol1</span><span class="p">)</span>
    <span class="n">g2</span> <span class="o">=</span> <span class="n">to_graph</span><span class="p">(</span><span class="n">mol2</span><span class="p">)</span>

    <span class="c1"># Use the `match` function to find the matching indices</span>
    <span class="n">node_match</span> <span class="o">=</span> <span class="n">node_match_fn</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match_atoms_on</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">edge_match</span> <span class="o">=</span> <span class="n">edge_match_fn</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match_bonds_on</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">graph_matcher</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">isomorphism</span><span class="o">.</span><span class="n">vf2userfunc</span><span class="o">.</span><span class="n">GraphMatcher</span><span class="p">(</span>
        <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">node_match</span><span class="o">=</span><span class="n">node_match</span><span class="p">,</span> <span class="n">edge_match</span><span class="o">=</span><span class="n">edge_match</span>
    <span class="p">)</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">graph_matcher</span><span class="o">.</span><span class="n">match</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">matches</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.graph.reorder_mol_from_template" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reorder_mol_from_template</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mol_template</span><span class="p">,</span> <span class="n">enforce_atomic_num</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enforce_bond_type</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ambiguous_match_mode</span><span class="o">=</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.graph.reorder_mol_from_template" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Re-order the nodes of a molecular graph from the nodes of a template molecule.
Molecular graphs and atom types need to be identical, but edge types and charges
are not enforced.</p>
<p>This is particularily useful when dealing with XYZ files containing node ordering,
but with missing information regarding charges and edge types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>If you only need to match bond orders, you can check the function
<code>rdkit.Chem.AllChem.AssignBondOrdersFromTemplate</code>.</li>
<li>The matching fails if the hydrogens are implicit in one molecule,
but explicit in the other.</li>
<li>Explicit hydrogens might lead to too many matches, since for an atom with 2
hydrogens, they can be re-ordered in any way.</li>
</ul>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>The molecule to re-order</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mol_template</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>The molecule containing the right node order.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>enforce_atomic_num</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to enforce atomic number. Atomic numbers are always enforced
for a first try. If no match are found and this parameter is <code>False</code>,
the matching is tried again.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>enforce_bond_type</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to enforce bond types. Bond types are always enforced
for a first try. If no match are found and this parameter is <code>False</code>,
the matching is tried again.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ambiguous_match_mode</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Whether to allow ambiguous matching. This means that,
if there are many matches to the molecule, it will still re-order
the molecule according to specific rules. Options are:
- "no": Does not allow ambiguous matching.
- "hs-only": Allow matching of ambiguous hydrogens. Does not work if trying
  to match implicit with explicit hydrogens.
- "first": Return the first match.
- "best": Return the match with the least errors on atom type, edges type, and edge stereo.
  Errors on the atoms are counted with 1 point, on the charge with 0.25 points,
  on the edges with 0.25 points, and on the Stereo with 0.05 points.
  If the option <code>enforce_atomic_num</code> is used, then no errors on the atoms are allowed.
  If the option <code>enforce_bond_type</code> is used, then no errors on the edges are allowed.
- "best-first": "best", followed by "first".</p></td>
          <td>
                <code>&#39;No&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to warn when the matching does not work or is ambiguous.
Different warnings are raised depending on the value of <code>ambiguous_match_mode</code>.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]</code>
          </td>
          <td><ul>
<li><code>None</code> if the molecular graphs do not match (both the graph and atom types).
Pring a warning.</li>
</ul></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]</code>
          </td>
          <td><ul>
<li><code>None</code> if multiple matche are found, which can happen for symmetric molecules such as benzene
Pring a warning.</li>
</ul></td>
        </tr>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span>]</code>
          </td>
          <td><ul>
<li><code>Mol</code> The re-ordered molecule when a single match is found.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/graph.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reorder_mol_from_template</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">mol_template</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">enforce_atomic_num</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enforce_bond_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ambiguous_match_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Re-order the nodes of a molecular graph from the nodes of a template molecule.</span>
<span class="sd">    Molecular graphs and atom types need to be identical, but edge types and charges</span>
<span class="sd">    are not enforced.</span>

<span class="sd">    This is particularily useful when dealing with XYZ files containing node ordering,</span>
<span class="sd">    but with missing information regarding charges and edge types.</span>

<span class="sd">    !!! note</span>

<span class="sd">        * If you only need to match bond orders, you can check the function</span>
<span class="sd">        `rdkit.Chem.AllChem.AssignBondOrdersFromTemplate`.</span>
<span class="sd">        * The matching fails if the hydrogens are implicit in one molecule,</span>
<span class="sd">        but explicit in the other.</span>
<span class="sd">        * Explicit hydrogens might lead to too many matches, since for an atom with 2</span>
<span class="sd">        hydrogens, they can be re-ordered in any way.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: The molecule to re-order</span>
<span class="sd">        mol_template: The molecule containing the right node order.</span>
<span class="sd">        enforce_atomic_num: Whether to enforce atomic number. Atomic numbers are always enforced</span>
<span class="sd">            for a first try. If no match are found and this parameter is `False`,</span>
<span class="sd">            the matching is tried again.</span>
<span class="sd">        enforce_bond_type: Whether to enforce bond types. Bond types are always enforced</span>
<span class="sd">            for a first try. If no match are found and this parameter is `False`,</span>
<span class="sd">            the matching is tried again.</span>
<span class="sd">        ambiguous_match_mode: Whether to allow ambiguous matching. This means that,</span>
<span class="sd">            if there are many matches to the molecule, it will still re-order</span>
<span class="sd">            the molecule according to specific rules. Options are:</span>
<span class="sd">            - &quot;no&quot;: Does not allow ambiguous matching.</span>
<span class="sd">            - &quot;hs-only&quot;: Allow matching of ambiguous hydrogens. Does not work if trying</span>
<span class="sd">              to match implicit with explicit hydrogens.</span>
<span class="sd">            - &quot;first&quot;: Return the first match.</span>
<span class="sd">            - &quot;best&quot;: Return the match with the least errors on atom type, edges type, and edge stereo.</span>
<span class="sd">              Errors on the atoms are counted with 1 point, on the charge with 0.25 points,</span>
<span class="sd">              on the edges with 0.25 points, and on the Stereo with 0.05 points.</span>
<span class="sd">              If the option `enforce_atomic_num` is used, then no errors on the atoms are allowed.</span>
<span class="sd">              If the option `enforce_bond_type` is used, then no errors on the edges are allowed.</span>
<span class="sd">            - &quot;best-first&quot;: &quot;best&quot;, followed by &quot;first&quot;.</span>
<span class="sd">        verbose: Whether to warn when the matching does not work or is ambiguous.</span>
<span class="sd">            Different warnings are raised depending on the value of `ambiguous_match_mode`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        - `None` if the molecular graphs do not match (both the graph and atom types).</span>
<span class="sd">            Pring a warning.</span>
<span class="sd">        - `None` if multiple matche are found, which can happen for symmetric molecules such as benzene</span>
<span class="sd">            Pring a warning.</span>
<span class="sd">        - `Mol` The re-ordered molecule when a single match is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ambiguous_match_mode</span> <span class="o">=</span> <span class="n">ambiguous_match_mode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Match the ordering of the graphs</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">match_molecular_graphs</span><span class="p">(</span>
        <span class="n">mol_template</span><span class="p">,</span>
        <span class="n">mol</span><span class="p">,</span>
        <span class="n">match_atoms_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;atomic_num&quot;</span><span class="p">],</span>
        <span class="n">match_bonds_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bond_type&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># If no matches were found, retry without bond types</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">enforce_bond_type</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">match_molecular_graphs</span><span class="p">(</span>
            <span class="n">mol_template</span><span class="p">,</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">match_atoms_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;atomic_num&quot;</span><span class="p">],</span>
            <span class="n">match_bonds_on</span><span class="o">=</span><span class="p">[],</span>
        <span class="p">)</span>

    <span class="c1"># If no matches were found, retry without atom types</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">enforce_atomic_num</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">match_molecular_graphs</span><span class="p">(</span>
            <span class="n">mol_template</span><span class="p">,</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">match_atoms_on</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">match_bonds_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bond_type&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># If no matches were found, retry without bond and atom types</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">enforce_bond_type</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">enforce_atomic_num</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">match_molecular_graphs</span><span class="p">(</span><span class="n">mol_template</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">match_atoms_on</span><span class="o">=</span><span class="p">[],</span> <span class="n">match_bonds_on</span><span class="o">=</span><span class="p">[])</span>

    <span class="c1"># If no match were found, exit the function and return None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No match was found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># In case we want to allow ambiguous match of hydrogens</span>
        <span class="k">if</span> <span class="n">ambiguous_match_mode</span> <span class="o">==</span> <span class="s2">&quot;hs-only&quot;</span><span class="p">:</span>
            <span class="n">first_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">all_hs_mismatch</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">this_match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">this_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">this_match</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">keys_mismatch</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">ii</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">this_keys</span><span class="p">))</span> <span class="k">if</span> <span class="p">(</span><span class="n">first_keys</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">!=</span> <span class="n">this_keys</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="p">]</span>
                <span class="n">atoms_mismatch</span> <span class="o">=</span> <span class="p">[</span><span class="n">mol</span><span class="o">.</span><span class="n">GetAtomWithIdx</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_mismatch</span><span class="p">]</span>
                <span class="n">all_hs</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="n">atom</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms_mismatch</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">all_hs</span><span class="p">:</span>
                    <span class="n">all_hs_mismatch</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">all_hs_mismatch</span><span class="p">:</span>
                <span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s2"> matches were found, ordering is ambiguous, even when ignoring hydrogens&quot;</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Compute the number of atoms and bonds mismatch, and select the one with the least mismatch</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ambiguous_match_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="s2">&quot;best-first&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">enforce_atomic_num</span> <span class="ow">and</span> <span class="n">enforce_bond_type</span>
        <span class="p">):</span>
            <span class="n">num_mismatches</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">this_match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">num_atoms_mismatch</span><span class="p">,</span> <span class="n">num_charge_mismatch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

                <span class="c1"># Get the number of atomic mismatch</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">this_match</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">atom1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtomWithIdx</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="n">atom2</span> <span class="o">=</span> <span class="n">mol_template</span><span class="o">.</span><span class="n">GetAtomWithIdx</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">num_atoms_mismatch</span> <span class="o">+=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">!=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span>
                    <span class="n">num_charge_mismatch</span> <span class="o">+=</span> <span class="n">atom1</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="o">!=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span>

                <span class="c1"># Get the number of bond mismatch</span>
                <span class="n">num_bonds_type_mismatch</span><span class="p">,</span> <span class="n">num_bonds_stereo_mismatch</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">bond1</span> <span class="ow">in</span> <span class="n">mol_template</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
                    <span class="n">begin_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">=</span> <span class="n">bond1</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span> <span class="n">bond1</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">()</span>
                    <span class="n">bond2</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBondBetweenAtoms</span><span class="p">(</span><span class="n">this_match</span><span class="p">[</span><span class="n">begin_idx</span><span class="p">],</span> <span class="n">this_match</span><span class="p">[</span><span class="n">end_idx</span><span class="p">])</span>
                    <span class="n">num_bonds_type_mismatch</span> <span class="o">+=</span> <span class="n">bond1</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bond2</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span>
                    <span class="n">num_bonds_stereo_mismatch</span> <span class="o">+=</span> <span class="p">(</span><span class="n">bond1</span><span class="o">.</span><span class="n">GetStereo</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bond2</span><span class="o">.</span><span class="n">GetStereo</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="n">bond1</span><span class="o">.</span><span class="n">GetBondDir</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bond2</span><span class="o">.</span><span class="n">GetBondDir</span><span class="p">()</span>
                    <span class="p">)</span>

                <span class="n">num_mismatches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">num_atoms_mismatch</span><span class="p">)</span>
                    <span class="o">+</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">num_charge_mismatch</span><span class="p">)</span>
                    <span class="o">+</span> <span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">num_bonds_type_mismatch</span><span class="p">)</span>
                    <span class="o">+</span> <span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">num_bonds_stereo_mismatch</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">min_mismatch_idx</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ii</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_mismatches</span><span class="p">))</span> <span class="k">if</span> <span class="n">num_mismatches</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">num_mismatches</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">matches</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">min_mismatch_idx</span><span class="p">]</span>

        <span class="c1"># Select the first matching element</span>
        <span class="k">if</span> <span class="n">ambiguous_match_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;best-first&quot;</span><span class="p">]:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># If many matches were found, exit the function and return None</span>
        <span class="k">if</span> <span class="n">ambiguous_match_mode</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s2"> matches were found, ordering is ambiguous&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Re-order the molecule from the matching indices of the template</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">match</span> <span class="o">=</span> <span class="p">[</span><span class="n">match</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">())]</span>
    <span class="n">reordered_mol</span> <span class="o">=</span> <span class="n">RenumberAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">match</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reordered_mol</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="datamol.graph.to_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_graph</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span></code>

<a href="#datamol.graph.to_graph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert a molecule to a network x graph. A list of properties are added
to every nodes and edges.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mol</code></td>
          <td>
                <code><span title="datamol">dm</span>.<span title="datamol.Mol">Mol</span></code>
          </td>
          <td><p>a molecule.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mol_graph</code></td>          <td>
                <code>networkx.<span title="networkx.Graph">Graph</span></code>
          </td>
          <td><p>a graph representing the molecule.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>datamol/graph.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_graph</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a molecule to a network x graph. A list of properties are added</span>
<span class="sd">    to every nodes and edges.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol (dm.Mol): a molecule.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mol_graph (networkx.Graph): a graph representing the molecule.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">_get_networkx</span><span class="p">()</span>

    <span class="n">mol_graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="n">mol_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">GetIdx</span><span class="p">(),</span>
            <span class="n">atomic_num</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">(),</span>
            <span class="n">formal_charge</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">(),</span>
            <span class="n">chiral_tag</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetChiralTag</span><span class="p">(),</span>
            <span class="n">hybridization</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetHybridization</span><span class="p">(),</span>
            <span class="n">num_explicit_hs</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetNumExplicitHs</span><span class="p">(),</span>
            <span class="n">implicit_valence</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetImplicitValence</span><span class="p">(),</span>
            <span class="n">degree</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetDegree</span><span class="p">(),</span>
            <span class="n">symbol</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">(),</span>
            <span class="n">ring_atom</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">(),</span>
            <span class="n">is_aromatic</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIsAromatic</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
        <span class="n">mol_graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtomIdx</span><span class="p">(),</span>
            <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtomIdx</span><span class="p">(),</span>
            <span class="n">bond_type</span><span class="o">=</span><span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">mol_graph</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../tutorials/Filesystem.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Datamol Filesystem Module" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Datamol Filesystem Module
            </div>
          </div>
        </a>
      
      
        
        <a href="datamol.descriptors.html" class="md-footer__link md-footer__link--next" aria-label="Next: datamol.descriptors" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              datamol.descriptors
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2022 Valence
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.2ab50757.min.js"></script>
      
        <script src="../assets/js/google-analytics.js"></script>
      
    
  </body>
</html>