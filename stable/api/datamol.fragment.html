
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A python library to work with molecules. Built on top of RDKit.">
      
      
      
      
        <link rel="prev" href="datamol.fp.html">
      
      
        <link rel="next" href="datamol.graph.html">
      
      
      <link rel="icon" href="../images/logo-black.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.20">
    
    
      
        <title>datamol.fragment - datamol</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
      <link rel="stylesheet" href="../assets/css/custom-datamol.css">
    
      <link rel="stylesheet" href="../assets/css/tweak-width.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datamolfragment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="datamol" class="md-header__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            datamol
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datamol.fragment
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-io/datamol
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage.html" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/The_Basics.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="datamol.align.html" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contribute.html" class="md-tabs__link">
        
  
    
  
  Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../license.html" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="datamol" class="md-nav__button md-logo" aria-label="datamol" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    datamol
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/datamol" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    datamol-io/datamol
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/The_Basics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Preprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-Processing Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Descriptors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descriptors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Reactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chemical Reactions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Scaffolds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Scaffold
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Aligning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aligning Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fuzzy_Scaffolds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fuzzy Scaffolds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Clustering.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Fragment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fragmenting Compounds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Conformers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generating Conformers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Visualization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Filesystem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datamol Filesystem Module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.align.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.align
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.cluster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.conformers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.conformers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.convert.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.convert
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.descriptors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.descriptors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.fp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.fp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    datamol.fragment
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="datamol.fragment.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    datamol.fragment
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment" class="md-nav__link">
    <span class="md-ellipsis">
      _fragment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.anybreak" class="md-nav__link">
    <span class="md-ellipsis">
      anybreak
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.brics" class="md-nav__link">
    <span class="md-ellipsis">
      brics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.frag" class="md-nav__link">
    <span class="md-ellipsis">
      frag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.mmpa_cut" class="md-nav__link">
    <span class="md-ellipsis">
      mmpa_cut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.mmpa_frag" class="md-nav__link">
    <span class="md-ellipsis">
      mmpa_frag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.recap" class="md-nav__link">
    <span class="md-ellipsis">
      recap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble" class="md-nav__link">
    <span class="md-ellipsis">
      _assemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.assemble_fragment_order" class="md-nav__link">
    <span class="md-ellipsis">
      assemble_fragment_order
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.break_mol" class="md-nav__link">
    <span class="md-ellipsis">
      break_mol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.graph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.io.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.isomers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.isomers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.log.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.molar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.molar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.mol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.mol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.reactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.reactions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.scaffold.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.scaffold
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.similarity.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.similarity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.utils.fs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.utils.fs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datamol.viz.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamol.viz
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment" class="md-nav__link">
    <span class="md-ellipsis">
      _fragment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.anybreak" class="md-nav__link">
    <span class="md-ellipsis">
      anybreak
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.brics" class="md-nav__link">
    <span class="md-ellipsis">
      brics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.frag" class="md-nav__link">
    <span class="md-ellipsis">
      frag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.mmpa_cut" class="md-nav__link">
    <span class="md-ellipsis">
      mmpa_cut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.mmpa_frag" class="md-nav__link">
    <span class="md-ellipsis">
      mmpa_frag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._fragment.recap" class="md-nav__link">
    <span class="md-ellipsis">
      recap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble" class="md-nav__link">
    <span class="md-ellipsis">
      _assemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.assemble_fragment_order" class="md-nav__link">
    <span class="md-ellipsis">
      assemble_fragment_order
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.break_mol" class="md-nav__link">
    <span class="md-ellipsis">
      break_mol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datamol.fragment._assemble.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="datamolfragment"><code>datamol.fragment</code><a class="headerlink" href="#datamolfragment" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="datamol.fragment._fragment"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.anybreak" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">anybreak</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.anybreak" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Fragment molecule by applying brics first, then fall back to frag.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="rdkit.Chem.rdchem.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a molecule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>remove_parent</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove parent from the fragments.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sanitize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to sanitize the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fix</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to fix the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">anybreak</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">remove_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fragment molecule by applying brics first, then fall back to frag.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        remove_parent: Remove parent from the fragments.</span>
<span class="sd">        sanitize: Wether to sanitize the fragments.</span>
<span class="sd">        fix: Wether to fix the fragments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">brics</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="n">fix</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="n">remove_parent</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="n">remove_parent</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="n">sanitize</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="n">fix</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">frags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.brics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">brics</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlepass</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.brics" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Run BRICS on the molecules and potentially fix dummy atoms.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="rdkit.Chem.rdchem.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a molecule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>singlepass</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single pass for <code>BRICSDecompose</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>remove_parent</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove parent from the fragments.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sanitize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to sanitize the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fix</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to fix the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">brics</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">singlepass</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">remove_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run BRICS on the molecules and potentially fix dummy atoms.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        singlepass: Single pass for `BRICSDecompose`.</span>
<span class="sd">        remove_parent: Remove parent from the fragments.</span>
<span class="sd">        sanitize: Wether to sanitize the fragments.</span>
<span class="sd">        fix: Wether to fix the fragments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="n">BRICS</span><span class="o">.</span><span class="n">BRICSDecompose</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">returnMols</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">singlePass</span><span class="o">=</span><span class="n">singlepass</span><span class="p">)</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fix</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">fix_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sanitize</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">remove_parent</span><span class="p">:</span>
        <span class="n">frags</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">frags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.frag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.frag" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Generate all possible fragmentation of a molecule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="rdkit.Chem.rdchem.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a molecule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>remove_parent</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove parent from the fragments.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sanitize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to sanitize the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fix</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to fix the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">frag</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">remove_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate all possible fragmentation of a molecule.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        remove_parent: Remove parent from the fragments.</span>
<span class="sd">        sanitize: Wether to sanitize the fragments.</span>
<span class="sd">        fix: Wether to fix the fragments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="n">FraggleSim</span><span class="o">.</span><span class="n">generate_fraggle_fragmentation</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">:</span>
        <span class="n">smiles</span> <span class="o">|=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">seq</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)}</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">fix</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">fix_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sanitize</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>

    <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remove_parent</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">frags</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">mol</span><span class="p">]</span> <span class="o">+</span> <span class="n">frags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.mmpa_cut" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmpa_cut</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">rdkit_pattern</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.mmpa_cut" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Cut molecules to perform mmpa analysis later</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="datamol.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Molecule to fragment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>rdkit_pattern</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to perform the fragmentation
using the default rdkit pattern: [#6+0;!$(<em>=, #[!#6])]!@!=!#[</em>]"</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of 'smiles,core,chains'</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mmpa_cut</span><span class="p">(</span><span class="n">mol</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span> <span class="n">rdkit_pattern</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cut molecules to perform mmpa analysis later</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: Molecule to fragment.</span>
<span class="sd">        rdkit_pattern: Whether to perform the fragmentation</span>
<span class="sd">            using the default rdkit pattern: [#6+0;!$(*=, #[!#6])]!@!=!#[*]&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of &#39;smiles,core,chains&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mol</span>

    <span class="n">outlines</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">smiles</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">rdkit_pattern</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">mmpa_frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_bond_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># heavy atoms</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">mmpa_frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;[!#1]!@!=!#[!#1]&quot;</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_bond_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">frags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mmpa_frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;[!#1]!@!=!#[!#1]&quot;</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_bond_cut</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>

    <span class="n">frags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">core</span><span class="p">,</span> <span class="n">chains</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">smiles</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">core</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">chains</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">outlines</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="c1"># hydrogen splitting</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">add_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">smiles</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumHeavyAtoms</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">mmpa_frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_bond_cut</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">h_split</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">core</span><span class="p">,</span> <span class="n">chains</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">smiles</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">core</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">chains</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">outlines</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">outlines</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.mmpa_frag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmpa_frag</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_cut</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_bond_cut</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">h_split</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.mmpa_frag" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Fragment molecule on specific bonds suitable for a MMPA analysis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="datamol.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Molecule to fragment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>pattern</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bond pattern to split on. Will use default rdkit pattern
'[#6+0;!$(<em>=,#[!#6])]!@!=!#[</em>]' if not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_cut</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cuts.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_bond_cut</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of bond to cut. Default to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>h_split</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to split at hydrogen position too.
This is equivalent to enabling the addition of new fragments.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>[<span title="datamol.Mol">Mol</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fragments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mmpa_frag</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_cut</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_bond_cut</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">h_split</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">Mol</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fragment molecule on specific bonds suitable for a MMPA analysis.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: Molecule to fragment.</span>
<span class="sd">        pattern: Bond pattern to split on. Will use default rdkit pattern</span>
<span class="sd">            &#39;[#6+0;!$(*=,#[!#6])]!@!=!#[*]&#39; if not provided.</span>
<span class="sd">        max_cut: Number of cuts.</span>
<span class="sd">        max_bond_cut: Maximum number of bond to cut. Default to 20.</span>
<span class="sd">        h_split:  Whether to split at hydrogen position too.</span>
<span class="sd">            This is equivalent to enabling the addition of new fragments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of fragments.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">frags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">rdMMPA</span><span class="o">.</span><span class="n">FragmentMol</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">maxCuts</span><span class="o">=</span><span class="n">max_cut</span><span class="p">,</span>
            <span class="n">resultsAsMols</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">maxCutBonds</span><span class="o">=</span><span class="n">max_bond_cut</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="n">rdMMPA</span><span class="o">.</span><span class="n">FragmentMol</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
            <span class="n">maxCuts</span><span class="o">=</span><span class="n">max_cut</span><span class="p">,</span>
            <span class="n">resultsAsMols</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">maxCutBonds</span><span class="o">=</span><span class="n">max_bond_cut</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">h_split</span><span class="p">:</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">add_hs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="n">frags</span> <span class="o">+=</span> <span class="n">rdMMPA</span><span class="o">.</span><span class="n">FragmentMol</span><span class="p">(</span>
            <span class="n">mol</span><span class="p">,</span>
            <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;[#1]!@!=!#[!#1]&quot;</span><span class="p">,</span>
            <span class="n">maxCuts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">resultsAsMols</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">maxCutBonds</span><span class="o">=</span><span class="n">max_bond_cut</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._fragment.recap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">recap</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">remove_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#datamol.fragment._fragment.recap" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Fragment the molecule using the recap algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mol</code></td>
            <td>
                  <code><span title="rdkit.Chem.rdchem.Mol">Mol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a molecule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>remove_parent</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove parent from the fragments.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sanitize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to sanitize the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fix</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Wether to fix the fragments.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_fragment.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">recap</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">remove_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sanitize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fix</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fragment the molecule using the recap algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        mol: a molecule.</span>
<span class="sd">        remove_parent: Remove parent from the fragments.</span>
<span class="sd">        sanitize: Wether to sanitize the fragments.</span>
<span class="sd">        fix: Wether to fix the fragments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">Recap</span><span class="o">.</span><span class="n">RecapDecompose</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">GetAllChildren</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

    <span class="k">if</span> <span class="n">fix</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">fix_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sanitize</span><span class="p">:</span>
        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">]</span>

    <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frags</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remove_parent</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">frags</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">mol</span><span class="p">]</span> <span class="o">+</span> <span class="n">frags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="datamol.fragment._assemble"></a>
    <div class="doc doc-contents first">

      <p>maclandrol: 22/07/19
This is an attempt to reverse engineer the BRICS (Breaking of Retrosynthetically Interesting Chemical Substructures)
approach for molecule fragmentation and use it as an heuristic for assembling molecules. The original paper on BRICS can be found here:
<a href="http://dacemirror.sci-hub.tw/journal-article/93060992e8d889318b77b562c0e5b75f/degen2008.pdf">http://dacemirror.sci-hub.tw/journal-article/93060992e8d889318b77b562c0e5b75f/degen2008.pdf</a>.
This makes senses from a methodological point of view, but I can't either guarantee that its is working as expected of if it's the best
way to tackle this problem. The goal here is to reconstruct a set of original molecules, which if they were to be fragmented using BRICS, should yield
the same fragment set in input. Thus, in theory fragments obtained using BRICS CAN be assembled into the original molecules with this method.
This differs from rdkit BRICSBuild implementation that requires the presence of dummy indicator atoms added by a prior BRICS fragmentation.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._assemble.assemble_fragment_order" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assemble_fragment_order</span><span class="p">(</span><span class="n">fragmentlist</span><span class="p">,</span> <span class="n">seen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_n_mols</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">RXNS</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#datamol.fragment._assemble.assemble_fragment_order" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Assemble a list of fragment into a set of possible molecules under rules defined by the brics algorithm</p>
<p>We are of course assuming:</p>
<pre><code>1. that the order in the fragmentlist matter :D !
2. that none of the fragment has explicitly defined hydrogen atoms.
3. only a list of unique molecule is internally maintained
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>fragmentlist</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of original fragments to grow</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seen</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datamol.types.Mol">Mol</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>original molecules used as base. If none, the first element of fragment list will be poped out</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>allow_incomplete</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to accept assembled molecules with missing fragment</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_assemble.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assemble_fragment_order</span><span class="p">(</span>
    <span class="n">fragmentlist</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">seen</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mol</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_incomplete</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_n_mols</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">RXNS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble a list of fragment into a set of possible molecules under rules defined by the brics algorithm</span>

<span class="sd">    We are of course assuming:</span>

<span class="sd">        1. that the order in the fragmentlist matter :D !</span>
<span class="sd">        2. that none of the fragment has explicitly defined hydrogen atoms.</span>
<span class="sd">        3. only a list of unique molecule is internally maintained</span>

<span class="sd">    Args:</span>
<span class="sd">        fragmentlist: list of original fragments to grow</span>
<span class="sd">        seen: original molecules used as base. If none, the first element of fragment list will be poped out</span>
<span class="sd">        allow_incomplete: Whether to accept assembled molecules with missing fragment</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">RXNS</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RXNS</span> <span class="o">=</span> <span class="n">ALL_BRICS_RETRO</span>

    <span class="n">fragmentlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fragmentlist</span><span class="p">)</span>
    <span class="n">yield_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">seen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="n">fragmentlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">seen</span><span class="p">)]</span>  <span class="c1"># only one molecule to assemble</span>
    <span class="k">while</span> <span class="n">yield_counter</span> <span class="o">&lt;</span> <span class="n">max_n_mols</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">fragmentlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># find all the way to add this fragment to seen</span>
        <span class="n">frag</span> <span class="o">=</span> <span class="n">fragmentlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">level_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">]</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sm</span> <span class="ow">in</span> <span class="n">level_set</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># there is no point in even trying something on molecules that cannot be kekulized</span>
                <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">RXNS</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">mSmi</span> <span class="ow">in</span> <span class="n">_run_at_all_rct</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span> <span class="n">frag</span><span class="p">,</span> <span class="n">sm</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">allow_incomplete</span> <span class="ow">and</span> <span class="n">mSmi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                            <span class="k">yield</span> <span class="n">m</span>
                            <span class="n">yield_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mSmi</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">pass</span>

    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">yield_counter</span> <span class="o">&lt;</span> <span class="n">max_n_mols</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">yield_counter</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._assemble.break_mol" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">break_mol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">minFragmentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">onlyUseReactions</span><span class="o">=</span><span class="p">[],</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;brics&#39;</span><span class="p">,</span> <span class="n">returnTree</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#datamol.fragment._assemble.break_mol" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Breaks a molecules into a list of fragment.</p>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_assemble.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">break_mol</span><span class="p">(</span>
    <span class="n">mol</span><span class="p">:</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span><span class="p">,</span>
    <span class="n">minFragmentSize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">onlyUseReactions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">randomize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;brics&quot;</span><span class="p">,</span>
    <span class="n">returnTree</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Breaks a molecules into a list of fragment.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">mode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;brics&quot;</span><span class="p">:</span>
        <span class="n">all_reactions</span> <span class="o">=</span> <span class="n">ALL_BRICS</span>
        <span class="n">all_reactions_type</span> <span class="o">=</span> <span class="n">ALL_BRICS_TYPE</span>
    <span class="k">elif</span> <span class="n">mode</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;rxn&quot;</span><span class="p">:</span>
        <span class="n">all_reactions</span> <span class="o">=</span> <span class="n">ALL_RXNS</span>
        <span class="n">all_reactions_type</span> <span class="o">=</span> <span class="n">ALL_RXNS_TYPE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_reactions</span> <span class="o">=</span> <span class="n">ALL_BRICS</span> <span class="o">+</span> <span class="n">ALL_RXNS</span>
        <span class="n">all_reactions_type</span> <span class="o">=</span> <span class="n">ALL_BRICS_TYPE</span> <span class="o">+</span> <span class="n">ALL_RXNS_TYPE</span>
    <span class="k">if</span> <span class="n">randomize</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_reactions</span><span class="p">))</span>
        <span class="n">all_reactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_reactions</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="n">all_reactions_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_reactions_type</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>

    <span class="n">nx</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">_get_networkx</span><span class="p">()</span>
    <span class="n">mSmi</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
    <span class="n">node_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">smiles</span><span class="o">=</span><span class="n">mSmi</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">allNodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">activePool</span> <span class="o">=</span> <span class="p">{</span><span class="n">mSmi</span><span class="p">:</span> <span class="n">node_num</span><span class="p">}</span>
    <span class="n">allNodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mSmi</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">activePool</span><span class="p">:</span>
        <span class="n">nSmi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">activePool</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">activePool</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">nSmi</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="s2">&quot;mol&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rxnIdx</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_reactions_type</span><span class="p">,</span> <span class="n">all_reactions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">onlyUseReactions</span> <span class="ow">and</span> <span class="n">rxnIdx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">onlyUseReactions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">RunReactants</span><span class="p">((</span><span class="n">mol</span><span class="p">,))</span>
            <span class="k">if</span> <span class="n">ps</span><span class="p">:</span>
                <span class="n">all_pass</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">all</span><span class="p">([</span><span class="n">prod</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(</span><span class="n">onlyExplicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">minFragmentSize</span> <span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">p_</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">p_</span> <span class="ow">in</span> <span class="n">ps</span>
                <span class="p">]</span>
                <span class="n">nz_i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">nz_i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_pass</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">all_pass</span><span class="p">[</span><span class="n">nz_i</span><span class="p">]:</span>
                    <span class="n">nz_i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">nSmi</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps</span><span class="p">),</span> <span class="s2">&quot;products and selected &quot;</span><span class="p">,</span> <span class="n">nz_i</span><span class="p">)</span>
                    <span class="c1"># display(MolsToGridImage(list(itertools.chain(*list(ps))), molsPerRow=2))</span>
                <span class="n">prodSeq</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="n">nz_i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_pass</span><span class="p">)]</span>
                <span class="n">seqOk</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># we want to disqualify small fragments, so sort the product sequence by size</span>
                <span class="n">prodSeq</span> <span class="o">=</span> <span class="p">[(</span><span class="n">prod</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">(</span><span class="n">onlyExplicit</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">prod</span><span class="p">)</span> <span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">prodSeq</span><span class="p">]</span>
                <span class="n">prodSeq</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">prodSeq</span><span class="p">:</span>
                    <span class="n">prod</span><span class="o">.</span><span class="n">sanitized</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">Chem</span><span class="o">.</span><span class="n">SanitizeMol</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">dm</span><span class="o">.</span><span class="n">sanitize_mol</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">seqOk</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                        <span class="k">continue</span>
                    <span class="n">pSmi</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">prod</span><span class="p">,</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">seqOk</span> <span class="o">=</span> <span class="n">seqOk</span> <span class="ow">and</span> <span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">to_mol</span><span class="p">(</span><span class="n">pSmi</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

                    <span class="n">notDummies</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">atm</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;*&quot;</span> <span class="k">for</span> <span class="n">atm</span> <span class="ow">in</span> <span class="n">prod</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()])</span>
                    <span class="c1"># nDummies = pSmi.count(&#39;*&#39;)</span>
                    <span class="c1"># if minFragmentSize &gt; 0 and (nats - nDummies &lt; minFragmentSize):</span>
                    <span class="k">if</span> <span class="n">minFragmentSize</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">notDummies</span> <span class="o">&lt;</span> <span class="n">minFragmentSize</span><span class="p">:</span>
                        <span class="n">seqOk</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                    <span class="n">prod</span><span class="o">.</span><span class="n">pSmi</span> <span class="o">=</span> <span class="n">pSmi</span>

                <span class="k">if</span> <span class="n">seqOk</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">prodSeq</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">prod</span><span class="o">.</span><span class="n">sanitized</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">pSmi</span> <span class="o">=</span> <span class="n">prod</span><span class="o">.</span><span class="n">pSmi</span>
                        <span class="n">node_num</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">usmi</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">fix_mol</span><span class="p">(</span><span class="n">prod</span><span class="p">),</span> <span class="n">isomeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">smiles</span><span class="o">=</span><span class="n">usmi</span><span class="p">,</span> <span class="n">mol</span><span class="o">=</span><span class="n">prod</span><span class="p">)</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">node_num</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">usmi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allNodes</span><span class="p">:</span>
                            <span class="n">activePool</span><span class="p">[</span><span class="n">pSmi</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_num</span>
                            <span class="n">allNodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">usmi</span><span class="p">)</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">parent</span><span class="p">][</span><span class="s2">&quot;rxn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rxnIdx</span>
                    <span class="k">break</span>  <span class="c1"># at least one reaction matches</span>

    <span class="n">leaves_smiles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;smiles&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span> <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">G</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">returnTree</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">leaves_smiles</span><span class="p">,</span> <span class="n">allNodes</span><span class="p">,</span> <span class="n">G</span>
    <span class="k">return</span> <span class="n">leaves_smiles</span><span class="p">,</span> <span class="n">allNodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="datamol.fragment._assemble.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">(</span><span class="n">ll_mols</span><span class="p">,</span> <span class="n">max_n_mols</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;brics&#39;</span><span class="p">,</span> <span class="n">frag_rxn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ADD_RNXS</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#datamol.fragment._assemble.build" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Build a super molecule from a list of fragments</p>

            <details class="quote">
              <summary>Source code in <code>datamol/fragment/_assemble.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">ll_mols</span><span class="p">,</span> <span class="n">max_n_mols</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;brics&quot;</span><span class="p">,</span> <span class="n">frag_rxn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ADD_RNXS</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a super molecule from a list of fragments&quot;&quot;&quot;</span>

    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">CUR_RXNS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">CUR_RXNS_TYPE</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;brics&quot;</span><span class="p">:</span>
        <span class="n">CUR_RXNS</span> <span class="o">=</span> <span class="n">ALL_BRICS_RETRO</span>
        <span class="n">CUR_RXNS_TYPE</span> <span class="o">=</span> <span class="n">ALL_BRICS_TYPE</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;rxn&quot;</span><span class="p">:</span>
        <span class="n">CUR_RXNS</span> <span class="o">=</span> <span class="n">ALL_RXNS_RETRO</span>
        <span class="n">CUR_RXNS_TYPE</span> <span class="o">=</span> <span class="n">ALL_RXNS_TYPE</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">CUR_RXNS</span> <span class="o">=</span> <span class="n">ALL_BRICS_RETRO</span> <span class="o">+</span> <span class="n">ALL_RXNS_RETRO</span>
        <span class="n">CUR_RXNS_TYPE</span> <span class="o">=</span> <span class="n">ALL_BRICS_TYPE</span> <span class="o">+</span> <span class="n">ALL_RXNS_TYPE</span>

    <span class="k">if</span> <span class="n">ADD_RNXS</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ADD_RNXS_TYPE</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;RXN-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ADD_RNXS</span><span class="p">))]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ADD_RNXS</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">ADD_RNXS_TYPE</span> <span class="o">=</span> <span class="n">ADD_RNXS</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">ADD_RNXS</span> <span class="o">=</span> <span class="n">ADD_RNXS</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">CUR_RXNS</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ADD_RNXS</span><span class="p">)</span>
        <span class="n">CUR_RXNS_TYPE</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ADD_RNXS_TYPE</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">CUR_RXNS_TYPE</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">frag_rxn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">frag_rxn</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">rxn_type</span><span class="p">):</span>
            <span class="n">CUR_RXNS</span> <span class="o">=</span> <span class="p">[</span><span class="n">CUR_RXNS</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">break</span>

    <span class="k">for</span> <span class="n">fraglist</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">ll_mols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">fraglist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fraglist</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">CUR_RXNS</span><span class="p">:</span>  <span class="c1"># should be size==1 if frag_rxn is provided</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ps</span> <span class="o">=</span> <span class="n">_run_at_all_rct</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span> <span class="n">fraglist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fraglist</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">mSmi</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seen</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_n_mols</span><span class="p">:</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">mSmi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                    <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mSmi</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">m</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="../assets/js/google-analytics.js"></script>
      
    
  </body>
</html>